{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/codemirror/lib/codemirror.js","webpack:///./node_modules/ext/global-this/index.js","webpack:///./node_modules/d/index.js","webpack:///./node_modules/es5-ext/object/is-value.js","webpack:///./node_modules/object-assign/index.js","webpack:///./node_modules/type/value/is.js","webpack:///./node_modules/es6-symbol/validate-symbol.js","webpack:///./node_modules/scheduler/index.js","webpack:///./node_modules/scheduler/cjs/scheduler.production.min.js","webpack:///./node_modules/es6-symbol/index.js","webpack:///./node_modules/es6-symbol/is-implemented.js","webpack:///./node_modules/ext/global-this/is-implemented.js","webpack:///./node_modules/ext/global-this/implementation.js","webpack:///./node_modules/es6-symbol/polyfill.js","webpack:///./node_modules/type/plain-function/is.js","webpack:///./node_modules/type/function/is.js","webpack:///./node_modules/type/prototype/is.js","webpack:///./node_modules/type/object/is.js","webpack:///./node_modules/es5-ext/object/assign/index.js","webpack:///./node_modules/es5-ext/object/assign/is-implemented.js","webpack:///./node_modules/es5-ext/object/assign/shim.js","webpack:///./node_modules/es5-ext/object/keys/index.js","webpack:///./node_modules/es5-ext/object/keys/is-implemented.js","webpack:///./node_modules/es5-ext/object/keys/shim.js","webpack:///./node_modules/es5-ext/function/noop.js","webpack:///./node_modules/es5-ext/object/valid-value.js","webpack:///./node_modules/es5-ext/object/normalize-options.js","webpack:///./node_modules/es5-ext/string/#/contains/index.js","webpack:///./node_modules/es5-ext/string/#/contains/is-implemented.js","webpack:///./node_modules/es5-ext/string/#/contains/shim.js","webpack:///./node_modules/es6-symbol/is-symbol.js","webpack:///./node_modules/es6-symbol/lib/private/generate-name.js","webpack:///./node_modules/es6-symbol/lib/private/setup/standard-symbols.js","webpack:///./node_modules/es6-symbol/lib/private/setup/symbol-registry.js","webpack:///./src/Toast/index.less?5748","webpack:///./node_modules/codemirror/mode/javascript/javascript.js","webpack:///./node_modules/codemirror/keymap/sublime.js","webpack:///./node_modules/codemirror/addon/search/searchcursor.js","webpack:///./node_modules/codemirror/addon/edit/matchbrackets.js","webpack:///./node_modules/codemirror/addon/comment/comment.js","webpack:///./src/Toast/index.tsx","webpack:///./src/Toast/hooks.ts","webpack:///./src/components/CodeField/index.tsx","webpack:///./src/components/Anchor/index.tsx","webpack:///./src/index.tsx"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","userAgent","navigator","platform","gecko","test","ie_upto10","ie_11up","exec","edge","ie","ie_version","document","documentMode","webkit","qtwebkit","chrome","presto","safari","vendor","mac_geMountainLion","phantom","ios","android","mobile","mac","chromeOS","windows","presto_version","match","Number","flipCtrlCmd","captureRightClick","classTest","cls","RegExp","range","rmClass","node","current","className","after","index","removeChildren","e","count","childNodes","removeChild","firstChild","removeChildrenAndAdd","parent","appendChild","elt","tag","content","style","createElement","cssText","createTextNode","eltP","setAttribute","contains","child","nodeType","parentNode","host","activeElt","activeElement","body","shadowRoot","addClass","joinClasses","a","b","as","split","createRange","start","end","endNode","setEnd","setStart","createTextRange","moveToElementText","collapse","moveEnd","moveStart","selectInput","select","f","args","Array","arguments","copyObj","obj","target","overwrite","prop","countColumn","string","tabSize","startIndex","startValue","search","nextTab","indexOf","selectionStart","selectionEnd","_e","Delayed","this","id","time","handler","onTimeout","array","self","Date","setTimeout","set","ms","clearTimeout","Pass","toString","sel_dontScroll","scroll","sel_mouse","origin","sel_move","findColumn","goal","pos","col","skipped","Math","min","spaceStrs","spaceStr","lst","arr","map","out","nothing","createObj","base","props","inst","nonASCIISingleCaseWordChar","isWordCharBasic","ch","toUpperCase","toLowerCase","isWordChar","helper","source","isEmpty","extendingChars","isExtendingChar","charCodeAt","skipExtendingChars","str","dir","charAt","findFirst","pred","from","to","midF","mid","ceil","floor","bidiOther","getBidiPartAt","order","sticky","found","cur","bidiOrdering","bidiRE","isNeutral","isStrong","countsAsLeft","countsAsNum","BidiSpan","level","direction","outerType","code","len","types","i$1","prev","type","i$2","type$1","i$3","prev$1","type$2","i$4","type$3","replace","i$5","cur$1","type$4","i$6","end$1","before","replace$1","j$1","i$7","at","isRTL","j$2","nstart","unshift","reverse","getOrder","line","text","noHandlers","on","emitter","addEventListener","attachEvent","_handlers","concat","getHandlers","off","removeEventListener","detachEvent","signal","handlers","signalDOMEvent","cm","override","preventDefault","defaultPrevented","e_defaultPrevented","codemirrorIgnore","signalCursorActivity","cursorActivity","curOp","cursorActivityHandlers","hasHandler","eventMixin","ctor","e_preventDefault","returnValue","e_stopPropagation","stopPropagation","cancelBubble","e_stop","e_target","srcElement","e_button","which","button","ctrlKey","zwspSupported","badBidiRects","dragAndDrop","div","zeroWidthElement","measure","offsetHeight","offsetWidth","hasBadBidiRects","txt","r0","getBoundingClientRect","r1","left","right","splitLinesAuto","nl","rt","hasSelection","getSelection","te","ownerDocument","selection","parentElement","compareEndPoints","hasCopyEvent","oncopy","badZoomedRects","modes","mimeModes","defineMode","dependencies","resolveMode","spec","getMode","options","mfactory","modeObj","modeExtensions","exts","helperType","modeProps","prop$1","extendMode","properties","copyState","state","nstate","val","innerMode","info","startState","a1","a2","StringStream","lineOracle","lastColumnPos","lastColumnValue","lineStart","getLine","doc","first","size","Error","chunk","lines","children","sz","chunkSize","getBetween","iter","getLines","updateLineHeight","height","diff","lineNo","no","lineAtHeight","h","outer","lh","isLine","lineNumberFor","String","lineNumberFormatter","firstLineNumber","Pos","cmp","equalCursorPos","copyPos","x","maxPos","minPos","clipLine","max","clipPos","last","linelen","clipToLen","clipPosArray","eol","sol","peek","undefined","next","eat","eatWhile","eatSpace","skipToEnd","skipTo","backUp","column","indentation","pattern","consume","caseInsensitive","cased","substr","hideFirstChars","inner","lookAhead","oracle","baseToken","SavedContext","Context","maxLookAhead","baseTokens","baseTokenPos","highlightLine","context","forceToEnd","st","modeGen","lineClasses","runMode","loop","overlay","overlays","i_end","opaque","styles","classes","bgClass","textClass","getLineStyles","updateFrontier","getContextBefore","resetState","maxHighlightLength","stateAfter","save","styleClasses","highlightFrontier","modeFrontier","precise","display","minindent","minline","lim","indented","findStartLine","saved","fromSaved","processLine","viewFrom","viewTo","nextLine","startAt","stream","callBlankLine","readToken","blankLine","token","copy","Token","takeToken","asArray","tokens","extractLineClasses","output","lineClass","flattenSpans","curStart","curStyle","addModeClass","mName","sawReadOnlySpans","sawCollapsedSpans","MarkedSpan","marker","getMarkedSpanFor","spans","span","removeMarkedSpan","stretchSpansOverChange","change","full","oldFirst","markedSpans","oldLast","startCh","endCh","isInsert","old","nw","inclusiveLeft","insertLeft","endsAfter","inclusiveRight","markedSpansBefore","startsBefore","markedSpansAfter","sameLine","offset","span$1","clearEmptySpans","newMarkers","gapMarkers","gap","clearWhenEmpty","detachMarkedSpans","detachLine","attachMarkedSpans","attachLine","extraLeft","extraRight","compareCollapsedMarkers","lenDiff","aPos","find","bPos","fromCmp","toCmp","collapsedSpanAtSide","sps","sp","collapsed","collapsedSpanAtStart","collapsedSpanAtEnd","collapsedSpanAround","conflictingCollapsedRange","visualLine","merged","visualLineNo","lineN","vis","visualLineEndNo","lastLine","lineIsHidden","widgetNode","lineIsHiddenInner","heightAtLine","lineObj","lineLength","found$1","findMaxLine","maxLine","maxLineLength","maxLineChanged","Line","estimateHeight","cleanUpLine","styleToClassCache","styleToClassCacheWithMode","interpretTokenStyle","cache","buildLineContent","lineView","builder","pre","trailingSpace","splitSpaces","getOption","rest","addToken","buildToken","buildTokenBadBidi","insertLineContent","externalMeasured","maps","caches","lastChild","querySelector","defaultSpecialCharPlaceholder","title","startStyle","endStyle","css","attributes","displayText","trailingBefore","spaceBefore","special","specialChars","mustWrap","createDocumentFragment","lastIndex","txt$1","tabWidth","specialCharPlaceholder","fullStyle","attr","part","buildCollapsedSpan","ignoreWidget","widget","input","needsContentAttribute","setUneditable","allText","spanStyle","spanEndStyle","spanStartStyle","nextChange","Infinity","foundBookmarks","endStyles","upto","tokenText","LineView","visualLineContinued","hidden","buildViewArray","nextPos","view","operationGroup","orphanDelayedCallbacks","signalLater","list","delayedCallbacks","fireOrphanDelayed","delayed","updateLineForChanges","dims","changes","updateLineText","updateLineGutter","updateLineClasses","updateLineWidgets","ensureLineWrapped","replaceChild","zIndex","getLineContent","ext","built","background","wrap","insertBefore","updateLineBackground","wrapClass","gutter","gutterBackground","gutterClass","fixedGutter","fixedPos","gutterTotalWidth","markers","gutterMarkers","lineNumbers","wrap$1","gutterWrap","lineNumber","gutterLeft","k","gutterSpecs","gutterWidth","alignable","isWidget","nextSibling","insertLineWidgets","buildLineElement","insertLineWidgetsFor","allowAbove","widgets","ws","handleMouseEvents","positionLineWidget","above","noHScroll","width","wrapperWidth","coverGutter","paddingLeft","position","marginLeft","widgetHeight","parentStyle","gutters","wrapper","clientWidth","eventInWidget","getAttribute","sizer","mover","paddingTop","lineSpace","offsetTop","paddingVert","paddingH","cachedPaddingH","getComputedStyle","currentStyle","parseInt","paddingRight","isNaN","scrollGap","nativeBarWidth","displayWidth","scroller","barWidth","displayHeight","clientHeight","barHeight","mapFromLineView","measureChar","bias","measureCharPrepared","prepareMeasureForLine","findViewForLine","findViewIndex","getDimensions","forceUpdate","lineMeasure","updateExternalMeasurement","rect","hasHeights","prepared","varHeight","wrapping","lineWrapping","curWidth","heights","rects","getClientRects","abs","bottom","top","ensureLineHeights","place","nodeAndOffsetInLineMap","coverStart","coverEnd","getUsefulRect","screen","logicalXDPI","deviceXDPI","normal","fromRange","hasBadZoomedRects","scaleX","scaleY","logicalYDPI","deviceYDPI","maybeUpdateRectForZooming","rSpan","charWidth","nullRect","rtop","rbot","bot","bogus","singleCursorHeightPerLine","rbottom","measureCharInner","measureText","mStart","mEnd","clearLineMeasurementCacheFor","clearLineMeasurementCache","externalMeasure","clearCaches","cachedCharWidth","cachedTextHeight","lineNumChars","pageScrollX","pageXOffset","documentElement","scrollLeft","pageScrollY","marginTop","pageYOffset","scrollTop","widgetTopHeight","intoCoordSystem","includeWidgets","yOff","viewOffset","lOff","xOff","fromCoordSystem","coords","localBox","lineSpaceBox","charCoords","cursorCoords","preparedMeasure","getBidi","partPos","invert","other","estimateCoords","PosWithInfo","outside","xRel","coordsChar","y","coordsCharInner","rangeEnd","wrappedLineExtent","begin","wrappedLineExtentChar","boxIsAfter","box","ltr","coordsBidiPartWrapped","coordsBidiPart","baseX","chAround","boxAround","atLeft","atStart","_lineNo","ref","closestDist","endX","dist","textHeight","anchor","clientLeft","offsetLeft","compensateForHScroll","th","perLine","widgetsHeight","estimateLineHeights","est","estHeight","posFromMouse","liberal","forRect","space","clientX","clientY","colDiff","round","regChange","lendiff","updateLineNumbers","viewChanged","resetView","cut","viewCuttingPoint","cut$1","cutTop","cutBot","regLineChange","oldN","newN","countDirtyView","dirty","updateSelection","showSelection","prepareSelection","primary","curFragment","cursors","selFragment","sel","ranges","primIndex","empty","showCursorWhenSelecting","drawSelectionCursor","head","drawSelectionRange","cursor","cursorHeight","otherCursor","cmpCoords","fragment","padding","leftSide","rightSide","sizerWidth","docLTR","add","drawForLine","fromArg","toArg","lineLen","wrapX","side","extent","iterateBidiSections","fromPos","toPos","openStart","openEnd","openRight","topLeft","topRight","botLeft","botRight","sFrom","sTo","fromLine","toLine","singleVLine","leftEnd","rightStart","restartBlink","focused","clearInterval","blinker","cursorDiv","visibility","cursorBlinkRate","setInterval","ensureFocus","focus","onFocus","delayBlurEvent","delayingBlurEvent","onBlur","readOnly","selForContextMenu","reset","receivedFocus","updateHeightsInViewport","prevBottom","lineDiv","updateWidgetHeight","chWidth","w","visibleLines","viewport","ensure","ensureFrom","ensureTo","calculateScrollPos","snapMargin","screentop","docBottom","atTop","atBottom","newTop","screenleft","screenw","tooWide","addToScrollTop","resolveScrollToPos","ensureCursorVisible","getCursor","scrollToPos","margin","cursorScrollMargin","scrollToCoords","scrollToCoordsRange","sPos","updateScrollTop","updateDisplaySimple","setScrollTop","startWorker","forceScroll","scrollHeight","scrollbars","setScrollLeft","isScroller","scrollWidth","alignHorizontally","measureForScrollbars","gutterW","docH","viewHeight","viewWidth","barLeft","docHeight","NativeScrollbars","vert","horiz","tabIndex","checkedZeroWidth","minHeight","minWidth","update","needsH","needsV","sWidth","totalHeight","totalWidth","zeroWidthHack","disableHoriz","enableZeroWidthBar","disableVert","pointerEvents","bar","delay","maybeDisable","elementFromPoint","clear","NullScrollbars","updateScrollbars","startWidth","startHeight","updateScrollbarsInner","sizes","paddingBottom","heightForcer","borderBottom","scrollbarFiller","coverGutterNextToScrollbar","gutterFiller","scrollbarModel","initScrollbars","scrollbarStyle","axis","nextOpId","startOperation","op","updateInput","typing","changeObjs","cursorActivityCalled","selectionChanged","updateMaxLine","ops","ownsGroup","endOperation","endCb","group","callbacks","fireCallbacksForOps","finishOperation","endOperation_R1","endOperation_W1","endOperation_R2","endOperation_W2","endOperation_finish","endOperations","scrollbarsClipped","marginBottom","borderRightWidth","maybeClipScrollbars","mustUpdate","DisplayUpdate","updatedDisplay","updateDisplayIfNeeded","barMeasure","adjustWidthTo","maxScrollLeft","preparedSelection","takeFocus","setDocumentHeight","postUpdateDisplay","wheelStartX","wheelStartY","doScroll","innerHeight","scrollNode","scrollIntoView","maybeScrollWindow","limit","changed","endCoords","scrollPos","startTop","startLeft","scrollPosIntoView","maybeHiddenMarkers","unhidden","maybeUnhiddenMarkers","finish","runInOp","operation","methodOp","docMethodOp","highlight","highlightWorker","workTime","changedLines","oldStyles","highlighted","oldCls","newCls","ischange","workDelay","force","visible","editorIsHidden","wrapperHeight","oldDisplayWidth","events","renderedView","maybeUpdateLineNumberWidth","viewportMargin","different","lastWrapHeight","lastWrapWidth","adjustView","toUpdate","selSnapshot","hasFocus","active","anchorNode","extend","anchorOffset","focusNode","focusOffset","selectionSnapshot","updateNumbersFrom","container","rm","currentWheelTarget","updateNumber","patchDisplay","snapshot","removeAllRanges","addRange","restoreSelection","selectionDiv","reportedViewFrom","reportedViewTo","updateGutterSpace","alignWidgets","comp","align","innerW","lineGutter","lineNumInnerWidth","lineNumWidth","getGutters","sawLineNumbers","renderGutters","specs","gElt","updateGutters","Display","draggable","wheelDX","wheelDY","activeTouch","init","wheelSamples","wheelPixelsPerUnit","wheelEventDelta","dx","wheelDeltaX","dy","wheelDeltaY","detail","HORIZONTAL_AXIS","VERTICAL_AXIS","wheelDelta","wheelEventPixels","delta","onScrollWheel","canScrollX","canScrollY","pixels","movedX","movedY","sample","Selection","equals","here","there","deepCopy","Range","somethingSelected","normalizeSelection","mayTouch","selectionsMayTouch","prim","sort","inv","simpleSelection","changeEnd","adjustForChange","computeSelAfterChange","offsetPos","loadMode","modeOption","resetModeState","isWholeLineUpdate","wholeLineUpdateBefore","updateDoc","spansFor","updateLine","linesFor","firstLine","lastText","lastSpans","nlines","insert","remove","added","added$1","added$2","linkedDocs","sharedHistOnly","propagate","skip","sharedHist","linked","rel","shared","attachDoc","setDirectionClass","History","startGen","done","undone","undoDepth","lastModTime","lastSelTime","lastOp","lastSelOp","lastOrigin","lastSelOrigin","generation","maxGeneration","historyChangeFromChange","histChange","attachLocalSpans","clearSelectionEvents","pop","addChangeToHistory","selAfter","opId","hist","history","historyEventDelay","lastChangeEvent","pushSelectionToHistory","addSelectionToHistory","selectionEventCanBeMerged","clearRedo","dest","existing","removeClearedSpans","explicitlyCleared","mergeOldSpans","getOldSpans","stretched","oldCur","stretchCur","copyHistoryArray","newGroup","instantiateSel","event","newChanges","extendRange","posBefore","extendSelection","setSelection","extendSelections","heads","replaceOneSelection","setSimpleSelection","setSelectionReplaceHistory","setSelectionNoUndo","NaN","filterSelectionChange","setSelectionInner","skipAtomicInSelection","reCheckSelection","mayClear","newAnchor","skipAtomic","newHead","skipAtomicInner","oldPos","preventCursorLeft","selectLeft","preventCursorRight","selectRight","atomic","near","movePos","far","cantEdit","selectAll","filterChange","canceled","cancel","makeChange","ignoreReadOnly","suppressEdits","mark","parts","mk","newParts","dfrom","dto","removeReadOnlyRanges","makeChangeInner","makeChangeSingleDoc","rebased","rebaseHist","makeChangeFromHistory","allowSelectionOnly","suppress","antiChanges","filter","returned","v","shiftDoc","distance","removed","recomputeMaxLength","checkWidthStart","retreatFrontier","changesHandler","changeHandler","makeChangeSingleDocInEditor","replaceRange","assign","splitLines","rebaseHistSelSingle","rebaseHistArray","sub","ok","copied","changeLine","handle","changeType","LeafChunk","BranchChunk","removeInner","insertInner","iterN","oldHeight","remaining","leaf","maybeSpill","me","sibling","myIndex","used","LineWidget","opt","adjustScrollWhenAboveVisible","this$1","oldH","nextMarkerId","TextMarker","markText","cloneNode","isParent","SharedTextMarker","markTextShared","replacedWith","addToHistory","curLine","addMarkedSpan","clearOnEnter","clearHistory","withOp","visual","dHeight","findSharedMarkers","findMarks","detachSharedMarkers","subMarker","nextDocId","Doc","lineSep","cleanGeneration","constructor","getValue","join","lineSeparator","setValue","getRange","getLineHandle","getLineNumber","getLineHandleVisualStart","lineCount","listSelections","setCursor","extendSelectionsBy","setSelections","addSelection","getSelections","replaceSelection","dup","replaceSelections","newSel","hint","oldPrev","newPrev","computeReplacedSel","undo","redo","undoSelection","redoSelection","setExtending","getExtending","historySize","markClean","changeGeneration","forceSplit","isClean","gen","getHistory","setHistory","histData","setGutterMarker","gutterID","clearGutter","lineInfo","addLineClass","where","removeLineClass","addLineWidget","insertAt","aboveVisible","removeLineWidget","setBookmark","realOpts","findMarksAt","getAllMarks","posFromIndex","sepSize","indexFromPos","copyHistory","linkedDoc","mFrom","mTo","subMark","copySharedMarkers","unlinkDoc","CodeMirror","splitIds","iterLinkedDocs","getEditor","setDirection","eachLine","lastDrop","onDrop","clearDragCursor","files","dataTransfer","isReadOnly","FileReader","File","read","markAsReadAndPasteIfAllFilesAreRead","readTextFromFile","file","allowDropFileTypes","reader","onerror","onload","readAsText","draggingText","text$1","getData","selected","dragCursor","forEachCodeMirror","getElementsByClassName","byClass","editors","globalsRegistered","ensureGlobalHandlers","resizeTimer","onResize","setSize","keyNames","3","8","9","13","16","17","18","19","20","27","32","33","34","35","36","37","38","39","40","44","45","46","59","61","91","92","93","106","107","109","110","111","145","173","186","187","188","189","190","191","192","219","220","221","222","63232","63233","63234","63235","63272","63273","63275","63276","63277","63302","fromCharCode","keyMap","normalizeKeyName","alt","ctrl","cmd","mod","normalizeKeyMap","keymap","keyname","keys","lookupKey","getKeyMap","fallthrough","isModifierKey","keyCode","addModifierNames","noShift","altKey","metaKey","shiftKey","keyName","altGraphKey","deleteNearSelection","compute","kill","toKill","replaced","moveCharLogically","moveLogically","endOfLine","visually","prep","targetTop","basic","pcDefault","emacsy","macDefault","commands","singleSelection","killLine","deleteLine","delLineLeft","delWrappedLineLeft","delWrappedLineRight","rightPos","goDocStart","goDocEnd","goLineStart","goLineStartSmart","lineStartSmart","goLineEnd","visualLineEnd","lineEnd","goLineRight","goLineLeft","goLineLeftSmart","goLineUp","moveV","goLineDown","goPageUp","goPageDown","goCharLeft","moveH","goCharRight","goColumnLeft","goColumnRight","goWordLeft","goGroupRight","goGroupLeft","goWordRight","delCharBefore","deleteH","delCharAfter","delWordBefore","delWordAfter","delGroupBefore","delGroupAfter","indentAuto","indentSelection","indentMore","indentLess","insertTab","insertSoftTab","spaces","defaultTab","execCommand","transposeChars","newlineAndIndent","sels","indentLine","openLine","toggleOverwrite","firstNonWS","inWS","doHandleBinding","bound","dropShift","ensurePolled","prevShift","stopSeq","dispatchKey","seq","keySeq","dispatchKeyInner","keyMaps","extraKeys","lookupKeyForEditor","handleKeyBinding","motion","lastStoppedKey","onKeyDown","handled","up","showCrossHair","onKeyUp","onKeyPress","charCode","handleCharBinding","lastClick","lastDoubleClick","PastClick","onMouseDown","supportsTouch","clickInGutter","repeat","now","compare","clickRepeat","selectingText","handleMappedButton","contained","behavior","option","unit","addNew","moveOnDrag","configureMouse","dragDrop","moved","dragEnd","mouseMove","dragStart","e2","leftButtonStartDrag","ourRange","ourIndex","startSel","rangeForUnit","lastPos","extendTo","startCol","posCol","leftPos","oldRange","ranges$1","anchorLine","boundary","headIndex","usePart","bidiSimplify","editorSize","counter","move","buttons","curCount","leftButtonSelect","leftButtonDown","onContextMenu","findWordAt","gutterEvent","prevent","mX","mY","touches","lineBox","g","contextMenuInGutter","themeChanged","theme","Init","defaults","optionHandlers","dragDropChanged","funcs","dragFunctions","toggle","enter","over","leave","drop","wrappingChanged","inputStyles","inputStyle","pasteIncoming","cutIncoming","autofocus","word","getField","touchFinished","prevTouch","finishTouch","farAway","touch","radiusX","radiusY","isMouseLikeTouchEvent","pageX","pageY","frag","onDragOver","setData","effectAllowed","setDragImage","img","src","_top","onDragStart","inp","registerEventHandlers","finishInit","initHooks","textRendering","how","aggressive","indent","curSpace","curSpaceString","indentUnit","indentString","indentWithTabs","pos$1","defineInitHook","lastCopied","setLastCopied","newLastCopied","applyTextInput","inserted","deleted","recent","paste","textLines","multiPaste","pasteLinesPerSelection","lineWise","changeEvent","triggerElectric","handlePaste","pasted","clipboardData","disableInput","electricChars","smartIndent","getModeAt","electricInput","copyableRanges","lineRange","disableBrowserMagic","field","spellcheck","autocorrect","autocapitalize","hiddenTextarea","border","findPosH","origDir","lineDir","moveOnce","boundToLine","bidi","mv","getWrappedLineExtent","moveInStorageOrder","searchInVisualLine","getRes","res","nextCh","moveVisually","sawType","getHelper","hitSide","findPosV","pageSize","moveAmount","ContentEditableInput","lastAnchorNode","lastAnchorOffset","lastFocusNode","lastFocusOffset","polling","composing","gracePeriod","readDOMTimeout","posToDOM","badPos","bad","domToPos","lineNode","locateNodeInLineView","textNode","topNode","nodeValue","curNode","textContent","previousSibling","dist$1","onCopyCut","lineWiseCopyCut","clearData","kludge","hadFocus","showPrimarySelection","updateFromDOM","readFromDOMSoon","forceCompositionEnd","showMultipleSelections","curAnchor","curFocus","rng","rangeCount","getRangeAt","startGracePeriod","rememberSelection","selectionInEditor","commonAncestorContainer","blur","pollSelection","pollInterval","poll","scan","isInGutter","triggerOnKeyDown","pollContent","fromIndex","fromNode","toNode","toIndex","newText","closing","extraLinebreak","close","addText","walk","cmText","markerID","isBlock","nodeName","domTextBetween","oldText","cutFront","cutEnd","oldTop","maxCutFront","newBot","oldBot","maxCutEnd","chFrom","chTo","contentEditable","readOnlyChanged","resetPosition","TextareaInput","prevInput","pollingFast","createField","textarea","prepareCopyCut","fastPoll","dispatchEvent","Event","_display","moveInputWithCursor","headPos","wrapOff","lineOff","teTop","teLeft","drawn","contextMenuPending","slowPoll","missed","same","resetSelectionOnContextMenu","oldScrollY","oldCSS","oldWrapperCSS","wrapperBox","offsetParent","scrollY","scrollTo","rehide","detectingSelectAll","prepareSelectAllHack","mouseup","extval","disabled","deflt","notOnInit","defineOption","newBreaks","refresh","getInputField","detach","attach","integer","defineOptions","helpers","setOption","getDoc","addKeyMap","removeKeyMap","addOverlay","score","priority","insertSorted","modeSpec","removeOverlay","newRanges","getTokenAt","getLineTokens","getTokenTypeAt","getHelpers","help","_global","getStateAfter","defaultTextHeight","defaultCharWidth","getViewport","addWidget","vspace","hspace","triggerOnKeyPress","triggerOnKeyUp","triggerOnMouseDown","amount","rtlMoveVisually","goalColumn","goals","startChar","check","getScrollInfo","scrollToRange","interpret","swapDoc","phrase","phraseText","phrases","getWrapperElement","getScrollerElement","getGutterElement","registerHelper","registerGlobalHelper","predicate","addEditorMethods","dontDelegate","method","defineMIME","mime","defineExtension","func","defineDocExtension","fromTextArea","tabindex","placeholder","realSubmit","form","leaveSubmitMethodAlone","submit","wrappedSubmit","getTextArea","toTextArea","cmpPos","addLegacyProps","version","factory","globalThis","isValue","isPlainFunction","normalizeOpts","dscr","desc","configurable","writable","gs","_undefined","getOwnPropertySymbols","propIsEnumerable","propertyIsEnumerable","toObject","TypeError","test1","getOwnPropertyNames","test2","test3","forEach","letter","err","shouldUseNative","symbols","isSymbol","MessageChannel","q","unstable_now","u","unstable_forceFrameRate","performance","z","console","A","cancelAnimationFrame","requestAnimationFrame","error","B","C","D","E","F","G","H","I","port2","port1","onmessage","postMessage","J","K","L","M","sortIndex","N","O","P","Q","R","S","T","U","V","callback","startTime","expirationTime","W","X","priorityLevel","Y","Z","unstable_IdlePriority","unstable_ImmediatePriority","unstable_LowPriority","unstable_NormalPriority","unstable_Profiling","unstable_UserBlockingPriority","unstable_cancelCallback","unstable_continueExecution","unstable_getCurrentPriorityLevel","unstable_getFirstCallbackNode","unstable_next","unstable_pauseExecution","unstable_requestPaint","unstable_runWithPriority","unstable_scheduleCallback","timeout","unstable_shouldYield","unstable_wrapCallback","global","validTypes","symbol","iterator","toPrimitive","naiveFallback","__global__","SymbolPolyfill","HiddenSymbol","isNativeSafe","validateSymbol","NativeSymbol","generateName","setupStandardSymbols","setupSymbolRegistry","defineProperties","ignore","description","__description__","__name__","valueOf","isFunction","classRe","functionToString","Function","isPrototype","isObject","possibleTypes","foo","trzy","process","opts1","searchString","objPrototype","created","ie11BugWorkaround","postfix","hasInstance","isConcatSpreadable","species","unscopables","registry","for","keyFor","config","parserConfig","statementIndent","jsonldMode","jsonld","jsonMode","json","isTS","typescript","wordRE","wordCharacters","keywords","kw","operator","atom","isOperatorChar","isJsonldKeyword","ret","tp","cont","tokenBase","quote","tokenize","escaped","tokenComment","expressionAllowed","inSet","readRegexp","tokenQuasi","lexical","lastType","maybeEnd","findFatArrow","fatArrowAt","arrow","depth","sawSomething","bracket","atomicTypes","JSLexical","inScope","varname","localVars","cx","vars","marked","cc","pass","inList","register","block","newContext","registerVarScoped","Var","globalVars","isModifier","defaultVars","pushcontext","pushblockcontext","popcontext","pushlex","lex","poplex","expect","wanted","exp","statement","vardef","parenExpr","maybeexpression","maybeelse","functiondef","forspec","enumdef","typename","typeexpr","expression","maybelabel","maybeCatchBinding","afterExport","afterImport","funarg","expressionInner","expressionNoComma","noComma","arrowBodyNoComma","arrowBody","commasep","maybeop","maybeoperatorNoComma","maybeoperatorComma","classExpression","arrayLiteral","contCommasep","objprop","quasi","targetNoComma","maybeTypeArgs","maybeTarget","expr","continueQuasi","_","getterSetter","afterprop","maybetype","what","sep","proceed","maybetypeOrIn","mayberettype","isKW","afterType","typeprop","typearg","maybeReturnType","functiondecl","typeparam","maybeTypeDefault","maybeAssign","vardefCont","eltpattern","proppattern","_type","forspec1","forspec2","classNameAfter","classBody","classfield","maybeFrom","exportField","importSpec","maybeMoreImports","maybeAs","enummember","basecolumn","parseJS","textAfter","firstChar","isContinuedStatement","doubleIndentSwitch","blockCommentStart","blockCommentEnd","blockCommentContinue","lineComment","fold","closeBrackets","skipExpression","cmds","moveSubword","startPos","cat","findPosSubword","insertLine","newSelection","wordAt","addCursorToSelection","newRange","selectBetweenBrackets","opening","scanForBracket","puncType","sortLines","caseSensitive","toSort","au","bu","modifyWordOrSelection","indices","replacements","getTarget","query","findAndGoTo","forward","getSearchCursor","findNext","findPrevious","goSubwordLeft","goSubwordRight","scrollLineUp","visibleBottomLine","scrollLineDown","visibleTopLine","splitSelectionByLine","lineRanges","singleSelectionTop","selectLine","extended","insertLineAfter","insertLineBefore","selectNextOccurrence","fullWord","sublimeFindFullWord","isSelectedRange","skipAndSelectNextOccurrence","prevAnchor","prevHead","addCursorToPrevLine","addCursorToNextLine","selectScope","goToBracket","swapLineUp","linesToMove","newSels","swapLineDown","toggleCommentIndented","toggleComment","joinLines","joined","actual","duplicateLine","sortLinesInsensitive","nextBookmark","marks","sublimeBookmarks","prevBookmark","toggleBookmark","sublimeBookmark","clearBookmarks","selectBookmarks","smartBackspace","toStartOfLine","deletePos","prevIndent","delLineRight","upcaseAtCursor","downcaseAtCursor","setSublimeMark","sublimeMark","selectToSublimeMark","deleteToSublimeMark","tmp","sublimeKilled","swapWithSublimeMark","sublimeYank","showInCenter","findUnder","findUnderPrevious","findAllUnder","matches","primaryIndex","macSublime","pcSublime","default","sublime","doFold","noFold","ensureFlags","regexp","flags","ignoreCase","multiline","regexpFlags","maybeMultiline","searchRegexpForward","searchRegexpForwardMultiline","inside","startLine","lastMatchIn","endMargin","newMatch","searchRegexpBackward","searchRegexpBackwardMultiline","adjustPos","orig","folded","foldFunc","searchStringForward","caseFold","cutFrom","endString","searchStringBackward","lastIndexOf","topString","SearchCursor","atOccurrence","normalize","ie_lt8","matching","bracketRegex","findMatchingBracket","afterCursor","re","strict","maxScanLen","maxScanLineLength","maxScanLines","stack","matchBrackets","autoclear","maxHighlightLen","maxHighlightLineLength","doMatchBrackets","currentlyHighlighted","oldConfig","noOptions","nonWS","useInnerComments","minLine","uncomment","commentString","pad","blankLines","commentBlankLines","baseString","whitespace","fullLines","blockComment","startString","lastLineHasText","lead","blockCommentLead","didSomething","lineString","endPos","open","endLine","insideStart","insideEnd","lastStart","firstEnd","almostLastStart","foundEnd","defaultOption","message","duration","cssClass","sustain","animeDuration","control","attachment","Toast","initial","setType","setMessage","setDuration","setCssClass","timerRef","rootRef","referRef","Promise","resolve","sustainRef","animeDurRef","timestampRef","getTime","initProgress","curprogress","useReactiveRef","goto","progress","then","currenttime","linebreak","nextElementSibling","grand","ancestor","transit","millisecond","payload","setSingle","saveAnimateValue","evt","styleSheets","stylesheet","rulelist","cssRules","animationName","framerule","keyText","animationDuration","onAnimationStart","onAnimationEnd","createParam","ToastWrapper","HTMLElement","el","append","render","CodeField","textareaRef","presentZoneRef","runBtnRef","editor","setEditor","run","execStr","sandboxId","readonly","onChange","runBtn","onClick","Anchor","domRef","toclass","fromclass","href","els","querySelectorAll","classList","currentTarget","hoverAdd","hoverRemove","clickAdd","passive","capture","instance","TYPE_ENUM","MESSAGE_ENUM","getElementById"],"mappings":"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","file":"entry.44b89bb8e226626b30ce.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([52,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// This is CodeMirror (https://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.CodeMirror = factory());\n}(this, (function () { 'use strict';\n\n  // Kludges for bugs and behavior differences that can't be feature\n  // detected are enabled based on userAgent etc sniffing.\n  var userAgent = navigator.userAgent;\n  var platform = navigator.platform;\n\n  var gecko = /gecko\\/\\d/i.test(userAgent);\n  var ie_upto10 = /MSIE \\d/.test(userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\n  var edge = /Edge\\/(\\d+)/.exec(userAgent);\n  var ie = ie_upto10 || ie_11up || edge;\n  var ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\n  var webkit = !edge && /WebKit\\//.test(userAgent);\n  var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\n  var chrome = !edge && /Chrome\\//.test(userAgent);\n  var presto = /Opera\\//.test(userAgent);\n  var safari = /Apple Computer/.test(navigator.vendor);\n  var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\n  var phantom = /PhantomJS/.test(userAgent);\n\n  var ios = !edge && /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent);\n  var android = /Android/.test(userAgent);\n  // This is woefully incomplete. Suggestions for alternative methods welcome.\n  var mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\n  var mac = ios || /Mac/.test(platform);\n  var chromeOS = /\\bCrOS\\b/.test(userAgent);\n  var windows = /win/i.test(platform);\n\n  var presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\n  if (presto_version) { presto_version = Number(presto_version[1]); }\n  if (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n  // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\n  var flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\n  var captureRightClick = gecko || (ie && ie_version >= 9);\n\n  function classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\n\n  var rmClass = function(node, cls) {\n    var current = node.className;\n    var match = classTest(cls).exec(current);\n    if (match) {\n      var after = current.slice(match.index + match[0].length);\n      node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n    }\n  };\n\n  function removeChildren(e) {\n    for (var count = e.childNodes.length; count > 0; --count)\n      { e.removeChild(e.firstChild); }\n    return e\n  }\n\n  function removeChildrenAndAdd(parent, e) {\n    return removeChildren(parent).appendChild(e)\n  }\n\n  function elt(tag, content, className, style) {\n    var e = document.createElement(tag);\n    if (className) { e.className = className; }\n    if (style) { e.style.cssText = style; }\n    if (typeof content == \"string\") { e.appendChild(document.createTextNode(content)); }\n    else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]); } }\n    return e\n  }\n  // wrapper for elt, which removes the elt from the accessibility tree\n  function eltP(tag, content, className, style) {\n    var e = elt(tag, content, className, style);\n    e.setAttribute(\"role\", \"presentation\");\n    return e\n  }\n\n  var range;\n  if (document.createRange) { range = function(node, start, end, endNode) {\n    var r = document.createRange();\n    r.setEnd(endNode || node, end);\n    r.setStart(node, start);\n    return r\n  }; }\n  else { range = function(node, start, end) {\n    var r = document.body.createTextRange();\n    try { r.moveToElementText(node.parentNode); }\n    catch(e) { return r }\n    r.collapse(true);\n    r.moveEnd(\"character\", end);\n    r.moveStart(\"character\", start);\n    return r\n  }; }\n\n  function contains(parent, child) {\n    if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n      { child = child.parentNode; }\n    if (parent.contains)\n      { return parent.contains(child) }\n    do {\n      if (child.nodeType == 11) { child = child.host; }\n      if (child == parent) { return true }\n    } while (child = child.parentNode)\n  }\n\n  function activeElt() {\n    // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n    // IE < 10 will throw when accessed while the page is loading or in an iframe.\n    // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n    var activeElement;\n    try {\n      activeElement = document.activeElement;\n    } catch(e) {\n      activeElement = document.body || null;\n    }\n    while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\n      { activeElement = activeElement.shadowRoot.activeElement; }\n    return activeElement\n  }\n\n  function addClass(node, cls) {\n    var current = node.className;\n    if (!classTest(cls).test(current)) { node.className += (current ? \" \" : \"\") + cls; }\n  }\n  function joinClasses(a, b) {\n    var as = a.split(\" \");\n    for (var i = 0; i < as.length; i++)\n      { if (as[i] && !classTest(as[i]).test(b)) { b += \" \" + as[i]; } }\n    return b\n  }\n\n  var selectInput = function(node) { node.select(); };\n  if (ios) // Mobile Safari apparently has a bug where select() is broken.\n    { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; }; }\n  else if (ie) // Suppress mysterious IE10 errors\n    { selectInput = function(node) { try { node.select(); } catch(_e) {} }; }\n\n  function bind(f) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    return function(){return f.apply(null, args)}\n  }\n\n  function copyObj(obj, target, overwrite) {\n    if (!target) { target = {}; }\n    for (var prop in obj)\n      { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n        { target[prop] = obj[prop]; } }\n    return target\n  }\n\n  // Counts the column offset in a string, taking tabs into account.\n  // Used mostly to find indentation.\n  function countColumn(string, end, tabSize, startIndex, startValue) {\n    if (end == null) {\n      end = string.search(/[^\\s\\u00a0]/);\n      if (end == -1) { end = string.length; }\n    }\n    for (var i = startIndex || 0, n = startValue || 0;;) {\n      var nextTab = string.indexOf(\"\\t\", i);\n      if (nextTab < 0 || nextTab >= end)\n        { return n + (end - i) }\n      n += nextTab - i;\n      n += tabSize - (n % tabSize);\n      i = nextTab + 1;\n    }\n  }\n\n  var Delayed = function() {\n    this.id = null;\n    this.f = null;\n    this.time = 0;\n    this.handler = bind(this.onTimeout, this);\n  };\n  Delayed.prototype.onTimeout = function (self) {\n    self.id = 0;\n    if (self.time <= +new Date) {\n      self.f();\n    } else {\n      setTimeout(self.handler, self.time - +new Date);\n    }\n  };\n  Delayed.prototype.set = function (ms, f) {\n    this.f = f;\n    var time = +new Date + ms;\n    if (!this.id || time < this.time) {\n      clearTimeout(this.id);\n      this.id = setTimeout(this.handler, ms);\n      this.time = time;\n    }\n  };\n\n  function indexOf(array, elt) {\n    for (var i = 0; i < array.length; ++i)\n      { if (array[i] == elt) { return i } }\n    return -1\n  }\n\n  // Number of pixels added to scroller and sizer to hide scrollbar\n  var scrollerGap = 30;\n\n  // Returned or thrown by various protocols to signal 'I'm not\n  // handling this'.\n  var Pass = {toString: function(){return \"CodeMirror.Pass\"}};\n\n  // Reused option objects for setSelection & friends\n  var sel_dontScroll = {scroll: false}, sel_mouse = {origin: \"*mouse\"}, sel_move = {origin: \"+move\"};\n\n  // The inverse of countColumn -- find the offset that corresponds to\n  // a particular column.\n  function findColumn(string, goal, tabSize) {\n    for (var pos = 0, col = 0;;) {\n      var nextTab = string.indexOf(\"\\t\", pos);\n      if (nextTab == -1) { nextTab = string.length; }\n      var skipped = nextTab - pos;\n      if (nextTab == string.length || col + skipped >= goal)\n        { return pos + Math.min(skipped, goal - col) }\n      col += nextTab - pos;\n      col += tabSize - (col % tabSize);\n      pos = nextTab + 1;\n      if (col >= goal) { return pos }\n    }\n  }\n\n  var spaceStrs = [\"\"];\n  function spaceStr(n) {\n    while (spaceStrs.length <= n)\n      { spaceStrs.push(lst(spaceStrs) + \" \"); }\n    return spaceStrs[n]\n  }\n\n  function lst(arr) { return arr[arr.length-1] }\n\n  function map(array, f) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i); }\n    return out\n  }\n\n  function insertSorted(array, value, score) {\n    var pos = 0, priority = score(value);\n    while (pos < array.length && score(array[pos]) <= priority) { pos++; }\n    array.splice(pos, 0, value);\n  }\n\n  function nothing() {}\n\n  function createObj(base, props) {\n    var inst;\n    if (Object.create) {\n      inst = Object.create(base);\n    } else {\n      nothing.prototype = base;\n      inst = new nothing();\n    }\n    if (props) { copyObj(props, inst); }\n    return inst\n  }\n\n  var nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\n  function isWordCharBasic(ch) {\n    return /\\w/.test(ch) || ch > \"\\x80\" &&\n      (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\n  }\n  function isWordChar(ch, helper) {\n    if (!helper) { return isWordCharBasic(ch) }\n    if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) { return true }\n    return helper.test(ch)\n  }\n\n  function isEmpty(obj) {\n    for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\n    return true\n  }\n\n  // Extending unicode characters. A series of a non-extending char +\n  // any number of extending chars is treated as a single unit as far\n  // as editing and measuring is concerned. This is not fully correct,\n  // since some scripts/fonts/browsers also treat other configurations\n  // of code points as a group.\n  var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\n  function isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\n\n  // Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\n  function skipExtendingChars(str, pos, dir) {\n    while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir; }\n    return pos\n  }\n\n  // Returns the value from the range [`from`; `to`] that satisfies\n  // `pred` and is closest to `from`. Assumes that at least `to`\n  // satisfies `pred`. Supports `from` being greater than `to`.\n  function findFirst(pred, from, to) {\n    // At any point we are certain `to` satisfies `pred`, don't know\n    // whether `from` does.\n    var dir = from > to ? -1 : 1;\n    for (;;) {\n      if (from == to) { return from }\n      var midF = (from + to) / 2, mid = dir < 0 ? Math.ceil(midF) : Math.floor(midF);\n      if (mid == from) { return pred(mid) ? from : to }\n      if (pred(mid)) { to = mid; }\n      else { from = mid + dir; }\n    }\n  }\n\n  // BIDI HELPERS\n\n  function iterateBidiSections(order, from, to, f) {\n    if (!order) { return f(from, to, \"ltr\", 0) }\n    var found = false;\n    for (var i = 0; i < order.length; ++i) {\n      var part = order[i];\n      if (part.from < to && part.to > from || from == to && part.to == from) {\n        f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\", i);\n        found = true;\n      }\n    }\n    if (!found) { f(from, to, \"ltr\"); }\n  }\n\n  var bidiOther = null;\n  function getBidiPartAt(order, ch, sticky) {\n    var found;\n    bidiOther = null;\n    for (var i = 0; i < order.length; ++i) {\n      var cur = order[i];\n      if (cur.from < ch && cur.to > ch) { return i }\n      if (cur.to == ch) {\n        if (cur.from != cur.to && sticky == \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n      if (cur.from == ch) {\n        if (cur.from != cur.to && sticky != \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n    }\n    return found != null ? found : bidiOther\n  }\n\n  // Bidirectional ordering algorithm\n  // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n  // that this (partially) implements.\n\n  // One-char codes used for character types:\n  // L (L):   Left-to-Right\n  // R (R):   Right-to-Left\n  // r (AL):  Right-to-Left Arabic\n  // 1 (EN):  European Number\n  // + (ES):  European Number Separator\n  // % (ET):  European Number Terminator\n  // n (AN):  Arabic Number\n  // , (CS):  Common Number Separator\n  // m (NSM): Non-Spacing Mark\n  // b (BN):  Boundary Neutral\n  // s (B):   Paragraph Separator\n  // t (S):   Segment Separator\n  // w (WS):  Whitespace\n  // N (ON):  Other Neutrals\n\n  // Returns null if characters are ordered as they appear\n  // (left-to-right), or an array of sections ({from, to, level}\n  // objects) in the order in which they occur visually.\n  var bidiOrdering = (function() {\n    // Character types for codepoints 0 to 0xff\n    var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n    // Character types for codepoints 0x600 to 0x6f9\n    var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n    function charType(code) {\n      if (code <= 0xf7) { return lowTypes.charAt(code) }\n      else if (0x590 <= code && code <= 0x5f4) { return \"R\" }\n      else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\n      else if (0x6ee <= code && code <= 0x8ac) { return \"r\" }\n      else if (0x2000 <= code && code <= 0x200b) { return \"w\" }\n      else if (code == 0x200c) { return \"b\" }\n      else { return \"L\" }\n    }\n\n    var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n    var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n\n    function BidiSpan(level, from, to) {\n      this.level = level;\n      this.from = from; this.to = to;\n    }\n\n    return function(str, direction) {\n      var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n      if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) { return false }\n      var len = str.length, types = [];\n      for (var i = 0; i < len; ++i)\n        { types.push(charType(str.charCodeAt(i))); }\n\n      // W1. Examine each non-spacing mark (NSM) in the level run, and\n      // change the type of the NSM to the type of the previous\n      // character. If the NSM is at the start of the level run, it will\n      // get the type of sor.\n      for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n        var type = types[i$1];\n        if (type == \"m\") { types[i$1] = prev; }\n        else { prev = type; }\n      }\n\n      // W2. Search backwards from each instance of a European number\n      // until the first strong type (R, L, AL, or sor) is found. If an\n      // AL is found, change the type of the European number to Arabic\n      // number.\n      // W3. Change all ALs to R.\n      for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n        var type$1 = types[i$2];\n        if (type$1 == \"1\" && cur == \"r\") { types[i$2] = \"n\"; }\n        else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == \"r\") { types[i$2] = \"R\"; } }\n      }\n\n      // W4. A single European separator between two European numbers\n      // changes to a European number. A single common separator between\n      // two numbers of the same type changes to that type.\n      for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n        var type$2 = types[i$3];\n        if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3+1] == \"1\") { types[i$3] = \"1\"; }\n        else if (type$2 == \",\" && prev$1 == types[i$3+1] &&\n                 (prev$1 == \"1\" || prev$1 == \"n\")) { types[i$3] = prev$1; }\n        prev$1 = type$2;\n      }\n\n      // W5. A sequence of European terminators adjacent to European\n      // numbers changes to all European numbers.\n      // W6. Otherwise, separators and terminators change to Other\n      // Neutral.\n      for (var i$4 = 0; i$4 < len; ++i$4) {\n        var type$3 = types[i$4];\n        if (type$3 == \",\") { types[i$4] = \"N\"; }\n        else if (type$3 == \"%\") {\n          var end = (void 0);\n          for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n          var replace = (i$4 && types[i$4-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n          for (var j = i$4; j < end; ++j) { types[j] = replace; }\n          i$4 = end - 1;\n        }\n      }\n\n      // W7. Search backwards from each instance of a European number\n      // until the first strong type (R, L, or sor) is found. If an L is\n      // found, then change the type of the European number to L.\n      for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n        var type$4 = types[i$5];\n        if (cur$1 == \"L\" && type$4 == \"1\") { types[i$5] = \"L\"; }\n        else if (isStrong.test(type$4)) { cur$1 = type$4; }\n      }\n\n      // N1. A sequence of neutrals takes the direction of the\n      // surrounding strong text if the text on both sides has the same\n      // direction. European and Arabic numbers act as if they were R in\n      // terms of their influence on neutrals. Start-of-level-run (sor)\n      // and end-of-level-run (eor) are used at level run boundaries.\n      // N2. Any remaining neutrals take the embedding direction.\n      for (var i$6 = 0; i$6 < len; ++i$6) {\n        if (isNeutral.test(types[i$6])) {\n          var end$1 = (void 0);\n          for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n          var before = (i$6 ? types[i$6-1] : outerType) == \"L\";\n          var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n          var replace$1 = before == after ? (before ? \"L\" : \"R\") : outerType;\n          for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1; }\n          i$6 = end$1 - 1;\n        }\n      }\n\n      // Here we depart from the documented algorithm, in order to avoid\n      // building up an actual levels array. Since there are only three\n      // levels (0, 1, 2) in an implementation that doesn't take\n      // explicit embedding into account, we can build up the order on\n      // the fly, without following the level-based algorithm.\n      var order = [], m;\n      for (var i$7 = 0; i$7 < len;) {\n        if (countsAsLeft.test(types[i$7])) {\n          var start = i$7;\n          for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n          order.push(new BidiSpan(0, start, i$7));\n        } else {\n          var pos = i$7, at = order.length, isRTL = direction == \"rtl\" ? 1 : 0;\n          for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n          for (var j$2 = pos; j$2 < i$7;) {\n            if (countsAsNum.test(types[j$2])) {\n              if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)); at += isRTL; }\n              var nstart = j$2;\n              for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n              order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n              at += isRTL;\n              pos = j$2;\n            } else { ++j$2; }\n          }\n          if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)); }\n        }\n      }\n      if (direction == \"ltr\") {\n        if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n          order[0].from = m[0].length;\n          order.unshift(new BidiSpan(0, 0, m[0].length));\n        }\n        if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n          lst(order).to -= m[0].length;\n          order.push(new BidiSpan(0, len - m[0].length, len));\n        }\n      }\n\n      return direction == \"rtl\" ? order.reverse() : order\n    }\n  })();\n\n  // Get the bidi ordering for the given line (and cache it). Returns\n  // false for lines that are fully left-to-right, and an array of\n  // BidiSpan objects otherwise.\n  function getOrder(line, direction) {\n    var order = line.order;\n    if (order == null) { order = line.order = bidiOrdering(line.text, direction); }\n    return order\n  }\n\n  // EVENT HANDLING\n\n  // Lightweight event framework. on/off also work on DOM nodes,\n  // registering native DOM handlers.\n\n  var noHandlers = [];\n\n  var on = function(emitter, type, f) {\n    if (emitter.addEventListener) {\n      emitter.addEventListener(type, f, false);\n    } else if (emitter.attachEvent) {\n      emitter.attachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers || (emitter._handlers = {});\n      map[type] = (map[type] || noHandlers).concat(f);\n    }\n  };\n\n  function getHandlers(emitter, type) {\n    return emitter._handlers && emitter._handlers[type] || noHandlers\n  }\n\n  function off(emitter, type, f) {\n    if (emitter.removeEventListener) {\n      emitter.removeEventListener(type, f, false);\n    } else if (emitter.detachEvent) {\n      emitter.detachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers, arr = map && map[type];\n      if (arr) {\n        var index = indexOf(arr, f);\n        if (index > -1)\n          { map[type] = arr.slice(0, index).concat(arr.slice(index + 1)); }\n      }\n    }\n  }\n\n  function signal(emitter, type /*, values...*/) {\n    var handlers = getHandlers(emitter, type);\n    if (!handlers.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2);\n    for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args); }\n  }\n\n  // The DOM events that CodeMirror handles can be overridden by\n  // registering a (non-DOM) handler on the editor for the event name,\n  // and preventDefault-ing the event in that handler.\n  function signalDOMEvent(cm, e, override) {\n    if (typeof e == \"string\")\n      { e = {type: e, preventDefault: function() { this.defaultPrevented = true; }}; }\n    signal(cm, override || e.type, cm, e);\n    return e_defaultPrevented(e) || e.codemirrorIgnore\n  }\n\n  function signalCursorActivity(cm) {\n    var arr = cm._handlers && cm._handlers.cursorActivity;\n    if (!arr) { return }\n    var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n    for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\n      { set.push(arr[i]); } }\n  }\n\n  function hasHandler(emitter, type) {\n    return getHandlers(emitter, type).length > 0\n  }\n\n  // Add on and off methods to a constructor's prototype, to make\n  // registering events on such objects more convenient.\n  function eventMixin(ctor) {\n    ctor.prototype.on = function(type, f) {on(this, type, f);};\n    ctor.prototype.off = function(type, f) {off(this, type, f);};\n  }\n\n  // Due to the fact that we still support jurassic IE versions, some\n  // compatibility wrappers are needed.\n\n  function e_preventDefault(e) {\n    if (e.preventDefault) { e.preventDefault(); }\n    else { e.returnValue = false; }\n  }\n  function e_stopPropagation(e) {\n    if (e.stopPropagation) { e.stopPropagation(); }\n    else { e.cancelBubble = true; }\n  }\n  function e_defaultPrevented(e) {\n    return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\n  }\n  function e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\n\n  function e_target(e) {return e.target || e.srcElement}\n  function e_button(e) {\n    var b = e.which;\n    if (b == null) {\n      if (e.button & 1) { b = 1; }\n      else if (e.button & 2) { b = 3; }\n      else if (e.button & 4) { b = 2; }\n    }\n    if (mac && e.ctrlKey && b == 1) { b = 3; }\n    return b\n  }\n\n  // Detect drag-and-drop\n  var dragAndDrop = function() {\n    // There is *some* kind of drag-and-drop support in IE6-8, but I\n    // couldn't get it to work yet.\n    if (ie && ie_version < 9) { return false }\n    var div = elt('div');\n    return \"draggable\" in div || \"dragDrop\" in div\n  }();\n\n  var zwspSupported;\n  function zeroWidthElement(measure) {\n    if (zwspSupported == null) {\n      var test = elt(\"span\", \"\\u200b\");\n      removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n      if (measure.firstChild.offsetHeight != 0)\n        { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8); }\n    }\n    var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\n      elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n    node.setAttribute(\"cm-text\", \"\");\n    return node\n  }\n\n  // Feature-detect IE's crummy client rect reporting for bidi text\n  var badBidiRects;\n  function hasBadBidiRects(measure) {\n    if (badBidiRects != null) { return badBidiRects }\n    var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n    var r0 = range(txt, 0, 1).getBoundingClientRect();\n    var r1 = range(txt, 1, 2).getBoundingClientRect();\n    removeChildren(measure);\n    if (!r0 || r0.left == r0.right) { return false } // Safari returns null in some cases (#2780)\n    return badBidiRects = (r1.right - r0.right < 3)\n  }\n\n  // See if \"\".split is the broken IE version, if so, provide an\n  // alternative way to split lines.\n  var splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n    var pos = 0, result = [], l = string.length;\n    while (pos <= l) {\n      var nl = string.indexOf(\"\\n\", pos);\n      if (nl == -1) { nl = string.length; }\n      var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n      var rt = line.indexOf(\"\\r\");\n      if (rt != -1) {\n        result.push(line.slice(0, rt));\n        pos += rt + 1;\n      } else {\n        result.push(line);\n        pos = nl + 1;\n      }\n    }\n    return result\n  } : function (string) { return string.split(/\\r\\n?|\\n/); };\n\n  var hasSelection = window.getSelection ? function (te) {\n    try { return te.selectionStart != te.selectionEnd }\n    catch(e) { return false }\n  } : function (te) {\n    var range;\n    try {range = te.ownerDocument.selection.createRange();}\n    catch(e) {}\n    if (!range || range.parentElement() != te) { return false }\n    return range.compareEndPoints(\"StartToEnd\", range) != 0\n  };\n\n  var hasCopyEvent = (function () {\n    var e = elt(\"div\");\n    if (\"oncopy\" in e) { return true }\n    e.setAttribute(\"oncopy\", \"return;\");\n    return typeof e.oncopy == \"function\"\n  })();\n\n  var badZoomedRects = null;\n  function hasBadZoomedRects(measure) {\n    if (badZoomedRects != null) { return badZoomedRects }\n    var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n    var normal = node.getBoundingClientRect();\n    var fromRange = range(node, 0, 1).getBoundingClientRect();\n    return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\n  }\n\n  // Known modes, by name and by MIME\n  var modes = {}, mimeModes = {};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  function defineMode(name, mode) {\n    if (arguments.length > 2)\n      { mode.dependencies = Array.prototype.slice.call(arguments, 2); }\n    modes[name] = mode;\n  }\n\n  function defineMIME(mime, spec) {\n    mimeModes[mime] = spec;\n  }\n\n  // Given a MIME type, a {name, ...options} config object, or a name\n  // string, return a mode config object.\n  function resolveMode(spec) {\n    if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n      spec = mimeModes[spec];\n    } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n      var found = mimeModes[spec.name];\n      if (typeof found == \"string\") { found = {name: found}; }\n      spec = createObj(found, spec);\n      spec.name = found.name;\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n      return resolveMode(\"application/xml\")\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n      return resolveMode(\"application/json\")\n    }\n    if (typeof spec == \"string\") { return {name: spec} }\n    else { return spec || {name: \"null\"} }\n  }\n\n  // Given a mode spec (anything that resolveMode accepts), find and\n  // initialize an actual mode object.\n  function getMode(options, spec) {\n    spec = resolveMode(spec);\n    var mfactory = modes[spec.name];\n    if (!mfactory) { return getMode(options, \"text/plain\") }\n    var modeObj = mfactory(options, spec);\n    if (modeExtensions.hasOwnProperty(spec.name)) {\n      var exts = modeExtensions[spec.name];\n      for (var prop in exts) {\n        if (!exts.hasOwnProperty(prop)) { continue }\n        if (modeObj.hasOwnProperty(prop)) { modeObj[\"_\" + prop] = modeObj[prop]; }\n        modeObj[prop] = exts[prop];\n      }\n    }\n    modeObj.name = spec.name;\n    if (spec.helperType) { modeObj.helperType = spec.helperType; }\n    if (spec.modeProps) { for (var prop$1 in spec.modeProps)\n      { modeObj[prop$1] = spec.modeProps[prop$1]; } }\n\n    return modeObj\n  }\n\n  // This can be used to attach properties to mode objects from\n  // outside the actual mode definition.\n  var modeExtensions = {};\n  function extendMode(mode, properties) {\n    var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n    copyObj(properties, exts);\n  }\n\n  function copyState(mode, state) {\n    if (state === true) { return state }\n    if (mode.copyState) { return mode.copyState(state) }\n    var nstate = {};\n    for (var n in state) {\n      var val = state[n];\n      if (val instanceof Array) { val = val.concat([]); }\n      nstate[n] = val;\n    }\n    return nstate\n  }\n\n  // Given a mode and a state (for that mode), find the inner mode and\n  // state at the position that the state refers to.\n  function innerMode(mode, state) {\n    var info;\n    while (mode.innerMode) {\n      info = mode.innerMode(state);\n      if (!info || info.mode == mode) { break }\n      state = info.state;\n      mode = info.mode;\n    }\n    return info || {mode: mode, state: state}\n  }\n\n  function startState(mode, a1, a2) {\n    return mode.startState ? mode.startState(a1, a2) : true\n  }\n\n  // STRING STREAM\n\n  // Fed to the mode parsers, provides helper functions to make\n  // parsers more succinct.\n\n  var StringStream = function(string, tabSize, lineOracle) {\n    this.pos = this.start = 0;\n    this.string = string;\n    this.tabSize = tabSize || 8;\n    this.lastColumnPos = this.lastColumnValue = 0;\n    this.lineStart = 0;\n    this.lineOracle = lineOracle;\n  };\n\n  StringStream.prototype.eol = function () {return this.pos >= this.string.length};\n  StringStream.prototype.sol = function () {return this.pos == this.lineStart};\n  StringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\n  StringStream.prototype.next = function () {\n    if (this.pos < this.string.length)\n      { return this.string.charAt(this.pos++) }\n  };\n  StringStream.prototype.eat = function (match) {\n    var ch = this.string.charAt(this.pos);\n    var ok;\n    if (typeof match == \"string\") { ok = ch == match; }\n    else { ok = ch && (match.test ? match.test(ch) : match(ch)); }\n    if (ok) {++this.pos; return ch}\n  };\n  StringStream.prototype.eatWhile = function (match) {\n    var start = this.pos;\n    while (this.eat(match)){}\n    return this.pos > start\n  };\n  StringStream.prototype.eatSpace = function () {\n    var start = this.pos;\n    while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this.pos; }\n    return this.pos > start\n  };\n  StringStream.prototype.skipToEnd = function () {this.pos = this.string.length;};\n  StringStream.prototype.skipTo = function (ch) {\n    var found = this.string.indexOf(ch, this.pos);\n    if (found > -1) {this.pos = found; return true}\n  };\n  StringStream.prototype.backUp = function (n) {this.pos -= n;};\n  StringStream.prototype.column = function () {\n    if (this.lastColumnPos < this.start) {\n      this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n      this.lastColumnPos = this.start;\n    }\n    return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.indentation = function () {\n    return countColumn(this.string, null, this.tabSize) -\n      (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n    if (typeof pattern == \"string\") {\n      var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; };\n      var substr = this.string.substr(this.pos, pattern.length);\n      if (cased(substr) == cased(pattern)) {\n        if (consume !== false) { this.pos += pattern.length; }\n        return true\n      }\n    } else {\n      var match = this.string.slice(this.pos).match(pattern);\n      if (match && match.index > 0) { return null }\n      if (match && consume !== false) { this.pos += match[0].length; }\n      return match\n    }\n  };\n  StringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\n  StringStream.prototype.hideFirstChars = function (n, inner) {\n    this.lineStart += n;\n    try { return inner() }\n    finally { this.lineStart -= n; }\n  };\n  StringStream.prototype.lookAhead = function (n) {\n    var oracle = this.lineOracle;\n    return oracle && oracle.lookAhead(n)\n  };\n  StringStream.prototype.baseToken = function () {\n    var oracle = this.lineOracle;\n    return oracle && oracle.baseToken(this.pos)\n  };\n\n  // Find the line object corresponding to the given line number.\n  function getLine(doc, n) {\n    n -= doc.first;\n    if (n < 0 || n >= doc.size) { throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\") }\n    var chunk = doc;\n    while (!chunk.lines) {\n      for (var i = 0;; ++i) {\n        var child = chunk.children[i], sz = child.chunkSize();\n        if (n < sz) { chunk = child; break }\n        n -= sz;\n      }\n    }\n    return chunk.lines[n]\n  }\n\n  // Get the part of a document between two positions, as an array of\n  // strings.\n  function getBetween(doc, start, end) {\n    var out = [], n = start.line;\n    doc.iter(start.line, end.line + 1, function (line) {\n      var text = line.text;\n      if (n == end.line) { text = text.slice(0, end.ch); }\n      if (n == start.line) { text = text.slice(start.ch); }\n      out.push(text);\n      ++n;\n    });\n    return out\n  }\n  // Get the lines between from and to, as array of strings.\n  function getLines(doc, from, to) {\n    var out = [];\n    doc.iter(from, to, function (line) { out.push(line.text); }); // iter aborts when callback returns truthy value\n    return out\n  }\n\n  // Update the height of a line, propagating the height change\n  // upwards to parent nodes.\n  function updateLineHeight(line, height) {\n    var diff = height - line.height;\n    if (diff) { for (var n = line; n; n = n.parent) { n.height += diff; } }\n  }\n\n  // Given a line object, find its line number by walking up through\n  // its parent links.\n  function lineNo(line) {\n    if (line.parent == null) { return null }\n    var cur = line.parent, no = indexOf(cur.lines, line);\n    for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n      for (var i = 0;; ++i) {\n        if (chunk.children[i] == cur) { break }\n        no += chunk.children[i].chunkSize();\n      }\n    }\n    return no + cur.first\n  }\n\n  // Find the line at the given vertical position, using the height\n  // information in the document tree.\n  function lineAtHeight(chunk, h) {\n    var n = chunk.first;\n    outer: do {\n      for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n        var child = chunk.children[i$1], ch = child.height;\n        if (h < ch) { chunk = child; continue outer }\n        h -= ch;\n        n += child.chunkSize();\n      }\n      return n\n    } while (!chunk.lines)\n    var i = 0;\n    for (; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i], lh = line.height;\n      if (h < lh) { break }\n      h -= lh;\n    }\n    return n + i\n  }\n\n  function isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\n\n  function lineNumberFor(options, i) {\n    return String(options.lineNumberFormatter(i + options.firstLineNumber))\n  }\n\n  // A Pos instance represents a position within the text.\n  function Pos(line, ch, sticky) {\n    if ( sticky === void 0 ) sticky = null;\n\n    if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\n    this.line = line;\n    this.ch = ch;\n    this.sticky = sticky;\n  }\n\n  // Compare two positions, return 0 if they are the same, a negative\n  // number when a is less, and a positive number otherwise.\n  function cmp(a, b) { return a.line - b.line || a.ch - b.ch }\n\n  function equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\n\n  function copyPos(x) {return Pos(x.line, x.ch)}\n  function maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\n  function minPos(a, b) { return cmp(a, b) < 0 ? a : b }\n\n  // Most of the external API clips given positions to make sure they\n  // actually exist within the document.\n  function clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\n  function clipPos(doc, pos) {\n    if (pos.line < doc.first) { return Pos(doc.first, 0) }\n    var last = doc.first + doc.size - 1;\n    if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\n    return clipToLen(pos, getLine(doc, pos.line).text.length)\n  }\n  function clipToLen(pos, linelen) {\n    var ch = pos.ch;\n    if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\n    else if (ch < 0) { return Pos(pos.line, 0) }\n    else { return pos }\n  }\n  function clipPosArray(doc, array) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]); }\n    return out\n  }\n\n  var SavedContext = function(state, lookAhead) {\n    this.state = state;\n    this.lookAhead = lookAhead;\n  };\n\n  var Context = function(doc, state, line, lookAhead) {\n    this.state = state;\n    this.doc = doc;\n    this.line = line;\n    this.maxLookAhead = lookAhead || 0;\n    this.baseTokens = null;\n    this.baseTokenPos = 1;\n  };\n\n  Context.prototype.lookAhead = function (n) {\n    var line = this.doc.getLine(this.line + n);\n    if (line != null && n > this.maxLookAhead) { this.maxLookAhead = n; }\n    return line\n  };\n\n  Context.prototype.baseToken = function (n) {\n    if (!this.baseTokens) { return null }\n    while (this.baseTokens[this.baseTokenPos] <= n)\n      { this.baseTokenPos += 2; }\n    var type = this.baseTokens[this.baseTokenPos + 1];\n    return {type: type && type.replace(/( |^)overlay .*/, \"\"),\n            size: this.baseTokens[this.baseTokenPos] - n}\n  };\n\n  Context.prototype.nextLine = function () {\n    this.line++;\n    if (this.maxLookAhead > 0) { this.maxLookAhead--; }\n  };\n\n  Context.fromSaved = function (doc, saved, line) {\n    if (saved instanceof SavedContext)\n      { return new Context(doc, copyState(doc.mode, saved.state), line, saved.lookAhead) }\n    else\n      { return new Context(doc, copyState(doc.mode, saved), line) }\n  };\n\n  Context.prototype.save = function (copy) {\n    var state = copy !== false ? copyState(this.doc.mode, this.state) : this.state;\n    return this.maxLookAhead > 0 ? new SavedContext(state, this.maxLookAhead) : state\n  };\n\n\n  // Compute a style array (an array starting with a mode generation\n  // -- for invalidation -- followed by pairs of end positions and\n  // style strings), which is used to highlight the tokens on the\n  // line.\n  function highlightLine(cm, line, context, forceToEnd) {\n    // A styles array always starts with a number identifying the\n    // mode/overlays that it is based on (for easy invalidation).\n    var st = [cm.state.modeGen], lineClasses = {};\n    // Compute the base array of styles\n    runMode(cm, line.text, cm.doc.mode, context, function (end, style) { return st.push(end, style); },\n            lineClasses, forceToEnd);\n    var state = context.state;\n\n    // Run overlays, adjust style array.\n    var loop = function ( o ) {\n      context.baseTokens = st;\n      var overlay = cm.state.overlays[o], i = 1, at = 0;\n      context.state = true;\n      runMode(cm, line.text, overlay.mode, context, function (end, style) {\n        var start = i;\n        // Ensure there's a token end at the current position, and that i points at it\n        while (at < end) {\n          var i_end = st[i];\n          if (i_end > end)\n            { st.splice(i, 1, end, st[i+1], i_end); }\n          i += 2;\n          at = Math.min(end, i_end);\n        }\n        if (!style) { return }\n        if (overlay.opaque) {\n          st.splice(start, i - start, end, \"overlay \" + style);\n          i = start + 2;\n        } else {\n          for (; start < i; start += 2) {\n            var cur = st[start+1];\n            st[start+1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n          }\n        }\n      }, lineClasses);\n      context.state = state;\n      context.baseTokens = null;\n      context.baseTokenPos = 1;\n    };\n\n    for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\n\n    return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\n  }\n\n  function getLineStyles(cm, line, updateFrontier) {\n    if (!line.styles || line.styles[0] != cm.state.modeGen) {\n      var context = getContextBefore(cm, lineNo(line));\n      var resetState = line.text.length > cm.options.maxHighlightLength && copyState(cm.doc.mode, context.state);\n      var result = highlightLine(cm, line, context);\n      if (resetState) { context.state = resetState; }\n      line.stateAfter = context.save(!resetState);\n      line.styles = result.styles;\n      if (result.classes) { line.styleClasses = result.classes; }\n      else if (line.styleClasses) { line.styleClasses = null; }\n      if (updateFrontier === cm.doc.highlightFrontier)\n        { cm.doc.modeFrontier = Math.max(cm.doc.modeFrontier, ++cm.doc.highlightFrontier); }\n    }\n    return line.styles\n  }\n\n  function getContextBefore(cm, n, precise) {\n    var doc = cm.doc, display = cm.display;\n    if (!doc.mode.startState) { return new Context(doc, true, n) }\n    var start = findStartLine(cm, n, precise);\n    var saved = start > doc.first && getLine(doc, start - 1).stateAfter;\n    var context = saved ? Context.fromSaved(doc, saved, start) : new Context(doc, startState(doc.mode), start);\n\n    doc.iter(start, n, function (line) {\n      processLine(cm, line.text, context);\n      var pos = context.line;\n      line.stateAfter = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo ? context.save() : null;\n      context.nextLine();\n    });\n    if (precise) { doc.modeFrontier = context.line; }\n    return context\n  }\n\n  // Lightweight form of highlight -- proceed over this line and\n  // update state, but don't save a style array. Used for lines that\n  // aren't currently visible.\n  function processLine(cm, text, context, startAt) {\n    var mode = cm.doc.mode;\n    var stream = new StringStream(text, cm.options.tabSize, context);\n    stream.start = stream.pos = startAt || 0;\n    if (text == \"\") { callBlankLine(mode, context.state); }\n    while (!stream.eol()) {\n      readToken(mode, stream, context.state);\n      stream.start = stream.pos;\n    }\n  }\n\n  function callBlankLine(mode, state) {\n    if (mode.blankLine) { return mode.blankLine(state) }\n    if (!mode.innerMode) { return }\n    var inner = innerMode(mode, state);\n    if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\n  }\n\n  function readToken(mode, stream, state, inner) {\n    for (var i = 0; i < 10; i++) {\n      if (inner) { inner[0] = innerMode(mode, state).mode; }\n      var style = mode.token(stream, state);\n      if (stream.pos > stream.start) { return style }\n    }\n    throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\")\n  }\n\n  var Token = function(stream, type, state) {\n    this.start = stream.start; this.end = stream.pos;\n    this.string = stream.current();\n    this.type = type || null;\n    this.state = state;\n  };\n\n  // Utility for getTokenAt and getLineTokens\n  function takeToken(cm, pos, precise, asArray) {\n    var doc = cm.doc, mode = doc.mode, style;\n    pos = clipPos(doc, pos);\n    var line = getLine(doc, pos.line), context = getContextBefore(cm, pos.line, precise);\n    var stream = new StringStream(line.text, cm.options.tabSize, context), tokens;\n    if (asArray) { tokens = []; }\n    while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n      stream.start = stream.pos;\n      style = readToken(mode, stream, context.state);\n      if (asArray) { tokens.push(new Token(stream, style, copyState(doc.mode, context.state))); }\n    }\n    return asArray ? tokens : new Token(stream, style, context.state)\n  }\n\n  function extractLineClasses(type, output) {\n    if (type) { for (;;) {\n      var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n      if (!lineClass) { break }\n      type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n      var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n      if (output[prop] == null)\n        { output[prop] = lineClass[2]; }\n      else if (!(new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\")).test(output[prop]))\n        { output[prop] += \" \" + lineClass[2]; }\n    } }\n    return type\n  }\n\n  // Run the given mode's parser over a line, calling f for each token.\n  function runMode(cm, text, mode, context, f, lineClasses, forceToEnd) {\n    var flattenSpans = mode.flattenSpans;\n    if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans; }\n    var curStart = 0, curStyle = null;\n    var stream = new StringStream(text, cm.options.tabSize, context), style;\n    var inner = cm.options.addModeClass && [null];\n    if (text == \"\") { extractLineClasses(callBlankLine(mode, context.state), lineClasses); }\n    while (!stream.eol()) {\n      if (stream.pos > cm.options.maxHighlightLength) {\n        flattenSpans = false;\n        if (forceToEnd) { processLine(cm, text, context, stream.pos); }\n        stream.pos = text.length;\n        style = null;\n      } else {\n        style = extractLineClasses(readToken(mode, stream, context.state, inner), lineClasses);\n      }\n      if (inner) {\n        var mName = inner[0].name;\n        if (mName) { style = \"m-\" + (style ? mName + \" \" + style : mName); }\n      }\n      if (!flattenSpans || curStyle != style) {\n        while (curStart < stream.start) {\n          curStart = Math.min(stream.start, curStart + 5000);\n          f(curStart, curStyle);\n        }\n        curStyle = style;\n      }\n      stream.start = stream.pos;\n    }\n    while (curStart < stream.pos) {\n      // Webkit seems to refuse to render text nodes longer than 57444\n      // characters, and returns inaccurate measurements in nodes\n      // starting around 5000 chars.\n      var pos = Math.min(stream.pos, curStart + 5000);\n      f(pos, curStyle);\n      curStart = pos;\n    }\n  }\n\n  // Finds the line to start with when starting a parse. Tries to\n  // find a line with a stateAfter, so that it can start with a\n  // valid state. If that fails, it returns the line with the\n  // smallest indentation, which tends to need the least context to\n  // parse correctly.\n  function findStartLine(cm, n, precise) {\n    var minindent, minline, doc = cm.doc;\n    var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n    for (var search = n; search > lim; --search) {\n      if (search <= doc.first) { return doc.first }\n      var line = getLine(doc, search - 1), after = line.stateAfter;\n      if (after && (!precise || search + (after instanceof SavedContext ? after.lookAhead : 0) <= doc.modeFrontier))\n        { return search }\n      var indented = countColumn(line.text, null, cm.options.tabSize);\n      if (minline == null || minindent > indented) {\n        minline = search - 1;\n        minindent = indented;\n      }\n    }\n    return minline\n  }\n\n  function retreatFrontier(doc, n) {\n    doc.modeFrontier = Math.min(doc.modeFrontier, n);\n    if (doc.highlightFrontier < n - 10) { return }\n    var start = doc.first;\n    for (var line = n - 1; line > start; line--) {\n      var saved = getLine(doc, line).stateAfter;\n      // change is on 3\n      // state on line 1 looked ahead 2 -- so saw 3\n      // test 1 + 2 < 3 should cover this\n      if (saved && (!(saved instanceof SavedContext) || line + saved.lookAhead < n)) {\n        start = line + 1;\n        break\n      }\n    }\n    doc.highlightFrontier = Math.min(doc.highlightFrontier, start);\n  }\n\n  // Optimize some code when these features are not used.\n  var sawReadOnlySpans = false, sawCollapsedSpans = false;\n\n  function seeReadOnlySpans() {\n    sawReadOnlySpans = true;\n  }\n\n  function seeCollapsedSpans() {\n    sawCollapsedSpans = true;\n  }\n\n  // TEXTMARKER SPANS\n\n  function MarkedSpan(marker, from, to) {\n    this.marker = marker;\n    this.from = from; this.to = to;\n  }\n\n  // Search an array of spans for a span matching the given marker.\n  function getMarkedSpanFor(spans, marker) {\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.marker == marker) { return span }\n    } }\n  }\n  // Remove a span from an array, returning undefined if no spans are\n  // left (we don't store arrays for lines without spans).\n  function removeMarkedSpan(spans, span) {\n    var r;\n    for (var i = 0; i < spans.length; ++i)\n      { if (spans[i] != span) { (r || (r = [])).push(spans[i]); } }\n    return r\n  }\n  // Add a span to a line.\n  function addMarkedSpan(line, span) {\n    line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n    span.marker.attachLine(line);\n  }\n\n  // Used for the algorithm that adjusts markers for a change in the\n  // document. These functions cut an array of spans at a given\n  // character position, returning an array of remaining chunks (or\n  // undefined if nothing remains).\n  function markedSpansBefore(old, startCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n      if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n        var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n      }\n    } }\n    return nw\n  }\n  function markedSpansAfter(old, endCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n      if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n        var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                              span.to == null ? null : span.to - endCh));\n      }\n    } }\n    return nw\n  }\n\n  // Given a change object, compute the new set of marker spans that\n  // cover the line in which the change took place. Removes spans\n  // entirely within the change, reconnects spans belonging to the\n  // same marker that appear on both sides of the change, and cuts off\n  // spans partially within the change. Returns an array of span\n  // arrays with one element for each line in (after) the change.\n  function stretchSpansOverChange(doc, change) {\n    if (change.full) { return null }\n    var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n    var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n    if (!oldFirst && !oldLast) { return null }\n\n    var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n    // Get the spans that 'stick out' on both sides\n    var first = markedSpansBefore(oldFirst, startCh, isInsert);\n    var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n    // Next, merge those two ends\n    var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n    if (first) {\n      // Fix up .to properties of first\n      for (var i = 0; i < first.length; ++i) {\n        var span = first[i];\n        if (span.to == null) {\n          var found = getMarkedSpanFor(last, span.marker);\n          if (!found) { span.to = startCh; }\n          else if (sameLine) { span.to = found.to == null ? null : found.to + offset; }\n        }\n      }\n    }\n    if (last) {\n      // Fix up .from in last (or move them into first in case of sameLine)\n      for (var i$1 = 0; i$1 < last.length; ++i$1) {\n        var span$1 = last[i$1];\n        if (span$1.to != null) { span$1.to += offset; }\n        if (span$1.from == null) {\n          var found$1 = getMarkedSpanFor(first, span$1.marker);\n          if (!found$1) {\n            span$1.from = offset;\n            if (sameLine) { (first || (first = [])).push(span$1); }\n          }\n        } else {\n          span$1.from += offset;\n          if (sameLine) { (first || (first = [])).push(span$1); }\n        }\n      }\n    }\n    // Make sure we didn't create any zero-length spans\n    if (first) { first = clearEmptySpans(first); }\n    if (last && last != first) { last = clearEmptySpans(last); }\n\n    var newMarkers = [first];\n    if (!sameLine) {\n      // Fill gap with whole-line-spans\n      var gap = change.text.length - 2, gapMarkers;\n      if (gap > 0 && first)\n        { for (var i$2 = 0; i$2 < first.length; ++i$2)\n          { if (first[i$2].to == null)\n            { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)); } } }\n      for (var i$3 = 0; i$3 < gap; ++i$3)\n        { newMarkers.push(gapMarkers); }\n      newMarkers.push(last);\n    }\n    return newMarkers\n  }\n\n  // Remove spans that are empty and don't have a clearWhenEmpty\n  // option of false.\n  function clearEmptySpans(spans) {\n    for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n        { spans.splice(i--, 1); }\n    }\n    if (!spans.length) { return null }\n    return spans\n  }\n\n  // Used to 'clip' out readOnly ranges when making a change.\n  function removeReadOnlyRanges(doc, from, to) {\n    var markers = null;\n    doc.iter(from.line, to.line + 1, function (line) {\n      if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n        var mark = line.markedSpans[i].marker;\n        if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n          { (markers || (markers = [])).push(mark); }\n      } }\n    });\n    if (!markers) { return null }\n    var parts = [{from: from, to: to}];\n    for (var i = 0; i < markers.length; ++i) {\n      var mk = markers[i], m = mk.find(0);\n      for (var j = 0; j < parts.length; ++j) {\n        var p = parts[j];\n        if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\n        var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n        if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n          { newParts.push({from: p.from, to: m.from}); }\n        if (dto > 0 || !mk.inclusiveRight && !dto)\n          { newParts.push({from: m.to, to: p.to}); }\n        parts.splice.apply(parts, newParts);\n        j += newParts.length - 3;\n      }\n    }\n    return parts\n  }\n\n  // Connect or disconnect spans from a line.\n  function detachMarkedSpans(line) {\n    var spans = line.markedSpans;\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.detachLine(line); }\n    line.markedSpans = null;\n  }\n  function attachMarkedSpans(line, spans) {\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.attachLine(line); }\n    line.markedSpans = spans;\n  }\n\n  // Helpers used when computing which overlapping collapsed span\n  // counts as the larger one.\n  function extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\n  function extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\n\n  // Returns a number indicating which of two overlapping collapsed\n  // spans is larger (and thus includes the other). Falls back to\n  // comparing ids when the spans cover exactly the same range.\n  function compareCollapsedMarkers(a, b) {\n    var lenDiff = a.lines.length - b.lines.length;\n    if (lenDiff != 0) { return lenDiff }\n    var aPos = a.find(), bPos = b.find();\n    var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n    if (fromCmp) { return -fromCmp }\n    var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n    if (toCmp) { return toCmp }\n    return b.id - a.id\n  }\n\n  // Find out whether a line ends or starts in a collapsed span. If\n  // so, return the marker for that span.\n  function collapsedSpanAtSide(line, start) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n        { found = sp.marker; }\n    } }\n    return found\n  }\n  function collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\n  function collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\n\n  function collapsedSpanAround(line, ch) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (sp.marker.collapsed && (sp.from == null || sp.from < ch) && (sp.to == null || sp.to > ch) &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0)) { found = sp.marker; }\n    } }\n    return found\n  }\n\n  // Test whether there exists a collapsed span that partially\n  // overlaps (covers the start or end, but not both) of a new span.\n  // Such overlap is not allowed.\n  function conflictingCollapsedRange(doc, lineNo, from, to, marker) {\n    var line = getLine(doc, lineNo);\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      var found = sp.marker.find(0);\n      var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n      var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n      if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\n      if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\n          fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\n        { return true }\n    } }\n  }\n\n  // A visual line is a line as drawn on the screen. Folding, for\n  // example, can cause multiple logical lines to appear on the same\n  // visual line. This finds the start of the visual line that the\n  // given line is part of (usually that is the line itself).\n  function visualLine(line) {\n    var merged;\n    while (merged = collapsedSpanAtStart(line))\n      { line = merged.find(-1, true).line; }\n    return line\n  }\n\n  function visualLineEnd(line) {\n    var merged;\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return line\n  }\n\n  // Returns an array of logical lines that continue the visual line\n  // started by the argument, or undefined if there are no such lines.\n  function visualLineContinued(line) {\n    var merged, lines;\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line\n      ;(lines || (lines = [])).push(line);\n    }\n    return lines\n  }\n\n  // Get the line number of the start of the visual line that the\n  // given line number is part of.\n  function visualLineNo(doc, lineN) {\n    var line = getLine(doc, lineN), vis = visualLine(line);\n    if (line == vis) { return lineN }\n    return lineNo(vis)\n  }\n\n  // Get the line number of the start of the next visual line after\n  // the given line.\n  function visualLineEndNo(doc, lineN) {\n    if (lineN > doc.lastLine()) { return lineN }\n    var line = getLine(doc, lineN), merged;\n    if (!lineIsHidden(doc, line)) { return lineN }\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return lineNo(line) + 1\n  }\n\n  // Compute whether a line is hidden. Lines count as hidden when they\n  // are part of a visual line that starts with another line, or when\n  // they are entirely covered by collapsed, non-widget span.\n  function lineIsHidden(doc, line) {\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      if (sp.from == null) { return true }\n      if (sp.marker.widgetNode) { continue }\n      if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n        { return true }\n    } }\n  }\n  function lineIsHiddenInner(doc, line, span) {\n    if (span.to == null) {\n      var end = span.marker.find(1, true);\n      return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\n    }\n    if (span.marker.inclusiveRight && span.to == line.text.length)\n      { return true }\n    for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\n      sp = line.markedSpans[i];\n      if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n          (sp.to == null || sp.to != span.from) &&\n          (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n          lineIsHiddenInner(doc, line, sp)) { return true }\n    }\n  }\n\n  // Find the height above the given line.\n  function heightAtLine(lineObj) {\n    lineObj = visualLine(lineObj);\n\n    var h = 0, chunk = lineObj.parent;\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i];\n      if (line == lineObj) { break }\n      else { h += line.height; }\n    }\n    for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n      for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n        var cur = p.children[i$1];\n        if (cur == chunk) { break }\n        else { h += cur.height; }\n      }\n    }\n    return h\n  }\n\n  // Compute the character length of a line, taking into account\n  // collapsed ranges (see markText) that might hide parts, and join\n  // other lines onto it.\n  function lineLength(line) {\n    if (line.height == 0) { return 0 }\n    var len = line.text.length, merged, cur = line;\n    while (merged = collapsedSpanAtStart(cur)) {\n      var found = merged.find(0, true);\n      cur = found.from.line;\n      len += found.from.ch - found.to.ch;\n    }\n    cur = line;\n    while (merged = collapsedSpanAtEnd(cur)) {\n      var found$1 = merged.find(0, true);\n      len -= cur.text.length - found$1.from.ch;\n      cur = found$1.to.line;\n      len += cur.text.length - found$1.to.ch;\n    }\n    return len\n  }\n\n  // Find the longest line in the document.\n  function findMaxLine(cm) {\n    var d = cm.display, doc = cm.doc;\n    d.maxLine = getLine(doc, doc.first);\n    d.maxLineLength = lineLength(d.maxLine);\n    d.maxLineChanged = true;\n    doc.iter(function (line) {\n      var len = lineLength(line);\n      if (len > d.maxLineLength) {\n        d.maxLineLength = len;\n        d.maxLine = line;\n      }\n    });\n  }\n\n  // LINE DATA STRUCTURE\n\n  // Line objects. These hold state related to a line, including\n  // highlighting info (the styles array).\n  var Line = function(text, markedSpans, estimateHeight) {\n    this.text = text;\n    attachMarkedSpans(this, markedSpans);\n    this.height = estimateHeight ? estimateHeight(this) : 1;\n  };\n\n  Line.prototype.lineNo = function () { return lineNo(this) };\n  eventMixin(Line);\n\n  // Change the content (text, markers) of a line. Automatically\n  // invalidates cached information and tries to re-estimate the\n  // line's height.\n  function updateLine(line, text, markedSpans, estimateHeight) {\n    line.text = text;\n    if (line.stateAfter) { line.stateAfter = null; }\n    if (line.styles) { line.styles = null; }\n    if (line.order != null) { line.order = null; }\n    detachMarkedSpans(line);\n    attachMarkedSpans(line, markedSpans);\n    var estHeight = estimateHeight ? estimateHeight(line) : 1;\n    if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n  }\n\n  // Detach a line from the document tree and its markers.\n  function cleanUpLine(line) {\n    line.parent = null;\n    detachMarkedSpans(line);\n  }\n\n  // Convert a style as returned by a mode (either null, or a string\n  // containing one or more styles) to a CSS style. This is cached,\n  // and also looks for line-wide styles.\n  var styleToClassCache = {}, styleToClassCacheWithMode = {};\n  function interpretTokenStyle(style, options) {\n    if (!style || /^\\s*$/.test(style)) { return null }\n    var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n    return cache[style] ||\n      (cache[style] = style.replace(/\\S+/g, \"cm-$&\"))\n  }\n\n  // Render the DOM representation of the text of a line. Also builds\n  // up a 'line map', which points at the DOM nodes that represent\n  // specific stretches of text, and is used by the measuring code.\n  // The returned object contains the DOM node, this map, and\n  // information about line-wide styles that were set by the mode.\n  function buildLineContent(cm, lineView) {\n    // The padding-right forces the element to have a 'border', which\n    // is needed on Webkit to be able to get line-level bounding\n    // rectangles for it (in measureChar).\n    var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n    var builder = {pre: eltP(\"pre\", [content], \"CodeMirror-line\"), content: content,\n                   col: 0, pos: 0, cm: cm,\n                   trailingSpace: false,\n                   splitSpaces: cm.getOption(\"lineWrapping\")};\n    lineView.measure = {};\n\n    // Iterate over the logical lines that make up this visual line.\n    for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n      var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0);\n      builder.pos = 0;\n      builder.addToken = buildToken;\n      // Optionally wire in some hacks into the token-rendering\n      // algorithm, to deal with browser quirks.\n      if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\n        { builder.addToken = buildTokenBadBidi(builder.addToken, order); }\n      builder.map = [];\n      var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n      insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n      if (line.styleClasses) {\n        if (line.styleClasses.bgClass)\n          { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\"); }\n        if (line.styleClasses.textClass)\n          { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\"); }\n      }\n\n      // Ensure at least a single node is present, for measuring.\n      if (builder.map.length == 0)\n        { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))); }\n\n      // Store the map and a cache object for the current logical line\n      if (i == 0) {\n        lineView.measure.map = builder.map;\n        lineView.measure.cache = {};\n      } else {\n  (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\n        ;(lineView.measure.caches || (lineView.measure.caches = [])).push({});\n      }\n    }\n\n    // See issue #2901\n    if (webkit) {\n      var last = builder.content.lastChild;\n      if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(\".cm-tab\")))\n        { builder.content.className = \"cm-tab-wrap-hack\"; }\n    }\n\n    signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n    if (builder.pre.className)\n      { builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\"); }\n\n    return builder\n  }\n\n  function defaultSpecialCharPlaceholder(ch) {\n    var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n    token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n    token.setAttribute(\"aria-label\", token.title);\n    return token\n  }\n\n  // Build up the DOM representation for a single token, and add it to\n  // the line map. Takes care to render special characters separately.\n  function buildToken(builder, text, style, startStyle, endStyle, css, attributes) {\n    if (!text) { return }\n    var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n    var special = builder.cm.state.specialChars, mustWrap = false;\n    var content;\n    if (!special.test(text)) {\n      builder.col += text.length;\n      content = document.createTextNode(displayText);\n      builder.map.push(builder.pos, builder.pos + text.length, content);\n      if (ie && ie_version < 9) { mustWrap = true; }\n      builder.pos += text.length;\n    } else {\n      content = document.createDocumentFragment();\n      var pos = 0;\n      while (true) {\n        special.lastIndex = pos;\n        var m = special.exec(text);\n        var skipped = m ? m.index - pos : text.length - pos;\n        if (skipped) {\n          var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt])); }\n          else { content.appendChild(txt); }\n          builder.map.push(builder.pos, builder.pos + skipped, txt);\n          builder.col += skipped;\n          builder.pos += skipped;\n        }\n        if (!m) { break }\n        pos += skipped + 1;\n        var txt$1 = (void 0);\n        if (m[0] == \"\\t\") {\n          var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n          txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n          txt$1.setAttribute(\"role\", \"presentation\");\n          txt$1.setAttribute(\"cm-text\", \"\\t\");\n          builder.col += tabWidth;\n        } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n          txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          builder.col += 1;\n        } else {\n          txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt$1])); }\n          else { content.appendChild(txt$1); }\n          builder.col += 1;\n        }\n        builder.map.push(builder.pos, builder.pos + 1, txt$1);\n        builder.pos++;\n      }\n    }\n    builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n    if (style || startStyle || endStyle || mustWrap || css) {\n      var fullStyle = style || \"\";\n      if (startStyle) { fullStyle += startStyle; }\n      if (endStyle) { fullStyle += endStyle; }\n      var token = elt(\"span\", [content], fullStyle, css);\n      if (attributes) {\n        for (var attr in attributes) { if (attributes.hasOwnProperty(attr) && attr != \"style\" && attr != \"class\")\n          { token.setAttribute(attr, attributes[attr]); } }\n      }\n      return builder.content.appendChild(token)\n    }\n    builder.content.appendChild(content);\n  }\n\n  // Change some spaces to NBSP to prevent the browser from collapsing\n  // trailing spaces at the end of a line when rendering text (issue #1362).\n  function splitSpaces(text, trailingBefore) {\n    if (text.length > 1 && !/  /.test(text)) { return text }\n    var spaceBefore = trailingBefore, result = \"\";\n    for (var i = 0; i < text.length; i++) {\n      var ch = text.charAt(i);\n      if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\n        { ch = \"\\u00a0\"; }\n      result += ch;\n      spaceBefore = ch == \" \";\n    }\n    return result\n  }\n\n  // Work around nonsense dimensions being reported for stretches of\n  // right-to-left text.\n  function buildTokenBadBidi(inner, order) {\n    return function (builder, text, style, startStyle, endStyle, css, attributes) {\n      style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n      var start = builder.pos, end = start + text.length;\n      for (;;) {\n        // Find the part that overlaps with the start of this text\n        var part = (void 0);\n        for (var i = 0; i < order.length; i++) {\n          part = order[i];\n          if (part.to > start && part.from <= start) { break }\n        }\n        if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, css, attributes) }\n        inner(builder, text.slice(0, part.to - start), style, startStyle, null, css, attributes);\n        startStyle = null;\n        text = text.slice(part.to - start);\n        start = part.to;\n      }\n    }\n  }\n\n  function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n    var widget = !ignoreWidget && marker.widgetNode;\n    if (widget) { builder.map.push(builder.pos, builder.pos + size, widget); }\n    if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n      if (!widget)\n        { widget = builder.content.appendChild(document.createElement(\"span\")); }\n      widget.setAttribute(\"cm-marker\", marker.id);\n    }\n    if (widget) {\n      builder.cm.display.input.setUneditable(widget);\n      builder.content.appendChild(widget);\n    }\n    builder.pos += size;\n    builder.trailingSpace = false;\n  }\n\n  // Outputs a number of spans to make up a line, taking highlighting\n  // and marked text into account.\n  function insertLineContent(line, builder, styles) {\n    var spans = line.markedSpans, allText = line.text, at = 0;\n    if (!spans) {\n      for (var i$1 = 1; i$1 < styles.length; i$1+=2)\n        { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)); }\n      return\n    }\n\n    var len = allText.length, pos = 0, i = 1, text = \"\", style, css;\n    var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, collapsed, attributes;\n    for (;;) {\n      if (nextChange == pos) { // Update current marker set\n        spanStyle = spanEndStyle = spanStartStyle = css = \"\";\n        attributes = null;\n        collapsed = null; nextChange = Infinity;\n        var foundBookmarks = [], endStyles = (void 0);\n        for (var j = 0; j < spans.length; ++j) {\n          var sp = spans[j], m = sp.marker;\n          if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n            foundBookmarks.push(m);\n          } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n            if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n              nextChange = sp.to;\n              spanEndStyle = \"\";\n            }\n            if (m.className) { spanStyle += \" \" + m.className; }\n            if (m.css) { css = (css ? css + \";\" : \"\") + m.css; }\n            if (m.startStyle && sp.from == pos) { spanStartStyle += \" \" + m.startStyle; }\n            if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to); }\n            // support for the old title property\n            // https://github.com/codemirror/CodeMirror/pull/5673\n            if (m.title) { (attributes || (attributes = {})).title = m.title; }\n            if (m.attributes) {\n              for (var attr in m.attributes)\n                { (attributes || (attributes = {}))[attr] = m.attributes[attr]; }\n            }\n            if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n              { collapsed = sp; }\n          } else if (sp.from > pos && nextChange > sp.from) {\n            nextChange = sp.from;\n          }\n        }\n        if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\n          { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += \" \" + endStyles[j$1]; } } }\n\n        if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\n          { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]); } }\n        if (collapsed && (collapsed.from || 0) == pos) {\n          buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                             collapsed.marker, collapsed.from == null);\n          if (collapsed.to == null) { return }\n          if (collapsed.to == pos) { collapsed = false; }\n        }\n      }\n      if (pos >= len) { break }\n\n      var upto = Math.min(len, nextChange);\n      while (true) {\n        if (text) {\n          var end = pos + text.length;\n          if (!collapsed) {\n            var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n            builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                             spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", css, attributes);\n          }\n          if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\n          pos = end;\n          spanStartStyle = \"\";\n        }\n        text = allText.slice(at, at = styles[i++]);\n        style = interpretTokenStyle(styles[i++], builder.cm.options);\n      }\n    }\n  }\n\n\n  // These objects are used to represent the visible (currently drawn)\n  // part of the document. A LineView may correspond to multiple\n  // logical lines, if those are connected by collapsed ranges.\n  function LineView(doc, line, lineN) {\n    // The starting line\n    this.line = line;\n    // Continuing lines, if any\n    this.rest = visualLineContinued(line);\n    // Number of logical lines in this visual line\n    this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n    this.node = this.text = null;\n    this.hidden = lineIsHidden(doc, line);\n  }\n\n  // Create a range of LineView objects for the given lines.\n  function buildViewArray(cm, from, to) {\n    var array = [], nextPos;\n    for (var pos = from; pos < to; pos = nextPos) {\n      var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n      nextPos = pos + view.size;\n      array.push(view);\n    }\n    return array\n  }\n\n  var operationGroup = null;\n\n  function pushOperation(op) {\n    if (operationGroup) {\n      operationGroup.ops.push(op);\n    } else {\n      op.ownsGroup = operationGroup = {\n        ops: [op],\n        delayedCallbacks: []\n      };\n    }\n  }\n\n  function fireCallbacksForOps(group) {\n    // Calls delayed callbacks and cursorActivity handlers until no\n    // new ones appear\n    var callbacks = group.delayedCallbacks, i = 0;\n    do {\n      for (; i < callbacks.length; i++)\n        { callbacks[i].call(null); }\n      for (var j = 0; j < group.ops.length; j++) {\n        var op = group.ops[j];\n        if (op.cursorActivityHandlers)\n          { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n            { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm); } }\n      }\n    } while (i < callbacks.length)\n  }\n\n  function finishOperation(op, endCb) {\n    var group = op.ownsGroup;\n    if (!group) { return }\n\n    try { fireCallbacksForOps(group); }\n    finally {\n      operationGroup = null;\n      endCb(group);\n    }\n  }\n\n  var orphanDelayedCallbacks = null;\n\n  // Often, we want to signal events at a point where we are in the\n  // middle of some work, but don't want the handler to start calling\n  // other methods on the editor, which might be in an inconsistent\n  // state or simply not expect any other events to happen.\n  // signalLater looks whether there are any handlers, and schedules\n  // them to be executed when the last operation ends, or, if no\n  // operation is active, when a timeout fires.\n  function signalLater(emitter, type /*, values...*/) {\n    var arr = getHandlers(emitter, type);\n    if (!arr.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2), list;\n    if (operationGroup) {\n      list = operationGroup.delayedCallbacks;\n    } else if (orphanDelayedCallbacks) {\n      list = orphanDelayedCallbacks;\n    } else {\n      list = orphanDelayedCallbacks = [];\n      setTimeout(fireOrphanDelayed, 0);\n    }\n    var loop = function ( i ) {\n      list.push(function () { return arr[i].apply(null, args); });\n    };\n\n    for (var i = 0; i < arr.length; ++i)\n      loop( i );\n  }\n\n  function fireOrphanDelayed() {\n    var delayed = orphanDelayedCallbacks;\n    orphanDelayedCallbacks = null;\n    for (var i = 0; i < delayed.length; ++i) { delayed[i](); }\n  }\n\n  // When an aspect of a line changes, a string is added to\n  // lineView.changes. This updates the relevant part of the line's\n  // DOM structure.\n  function updateLineForChanges(cm, lineView, lineN, dims) {\n    for (var j = 0; j < lineView.changes.length; j++) {\n      var type = lineView.changes[j];\n      if (type == \"text\") { updateLineText(cm, lineView); }\n      else if (type == \"gutter\") { updateLineGutter(cm, lineView, lineN, dims); }\n      else if (type == \"class\") { updateLineClasses(cm, lineView); }\n      else if (type == \"widget\") { updateLineWidgets(cm, lineView, dims); }\n    }\n    lineView.changes = null;\n  }\n\n  // Lines with gutter elements, widgets or a background class need to\n  // be wrapped, and have the extra elements added to the wrapper div\n  function ensureLineWrapped(lineView) {\n    if (lineView.node == lineView.text) {\n      lineView.node = elt(\"div\", null, null, \"position: relative\");\n      if (lineView.text.parentNode)\n        { lineView.text.parentNode.replaceChild(lineView.node, lineView.text); }\n      lineView.node.appendChild(lineView.text);\n      if (ie && ie_version < 8) { lineView.node.style.zIndex = 2; }\n    }\n    return lineView.node\n  }\n\n  function updateLineBackground(cm, lineView) {\n    var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n    if (cls) { cls += \" CodeMirror-linebackground\"; }\n    if (lineView.background) {\n      if (cls) { lineView.background.className = cls; }\n      else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n    } else if (cls) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n      cm.display.input.setUneditable(lineView.background);\n    }\n  }\n\n  // Wrapper around buildLineContent which will reuse the structure\n  // in display.externalMeasured when possible.\n  function getLineContent(cm, lineView) {\n    var ext = cm.display.externalMeasured;\n    if (ext && ext.line == lineView.line) {\n      cm.display.externalMeasured = null;\n      lineView.measure = ext.measure;\n      return ext.built\n    }\n    return buildLineContent(cm, lineView)\n  }\n\n  // Redraw the line's text. Interacts with the background and text\n  // classes because the mode may output tokens that influence these\n  // classes.\n  function updateLineText(cm, lineView) {\n    var cls = lineView.text.className;\n    var built = getLineContent(cm, lineView);\n    if (lineView.text == lineView.node) { lineView.node = built.pre; }\n    lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n    lineView.text = built.pre;\n    if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n      lineView.bgClass = built.bgClass;\n      lineView.textClass = built.textClass;\n      updateLineClasses(cm, lineView);\n    } else if (cls) {\n      lineView.text.className = cls;\n    }\n  }\n\n  function updateLineClasses(cm, lineView) {\n    updateLineBackground(cm, lineView);\n    if (lineView.line.wrapClass)\n      { ensureLineWrapped(lineView).className = lineView.line.wrapClass; }\n    else if (lineView.node != lineView.text)\n      { lineView.node.className = \"\"; }\n    var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n    lineView.text.className = textClass || \"\";\n  }\n\n  function updateLineGutter(cm, lineView, lineN, dims) {\n    if (lineView.gutter) {\n      lineView.node.removeChild(lineView.gutter);\n      lineView.gutter = null;\n    }\n    if (lineView.gutterBackground) {\n      lineView.node.removeChild(lineView.gutterBackground);\n      lineView.gutterBackground = null;\n    }\n    if (lineView.line.gutterClass) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\n                                      (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + (dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(lineView.gutterBackground);\n      wrap.insertBefore(lineView.gutterBackground, lineView.text);\n    }\n    var markers = lineView.line.gutterMarkers;\n    if (cm.options.lineNumbers || markers) {\n      var wrap$1 = ensureLineWrapped(lineView);\n      var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(gutterWrap);\n      wrap$1.insertBefore(gutterWrap, lineView.text);\n      if (lineView.line.gutterClass)\n        { gutterWrap.className += \" \" + lineView.line.gutterClass; }\n      if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n        { lineView.lineNumber = gutterWrap.appendChild(\n          elt(\"div\", lineNumberFor(cm.options, lineN),\n              \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n              (\"left: \" + (dims.gutterLeft[\"CodeMirror-linenumbers\"]) + \"px; width: \" + (cm.display.lineNumInnerWidth) + \"px\"))); }\n      if (markers) { for (var k = 0; k < cm.display.gutterSpecs.length; ++k) {\n        var id = cm.display.gutterSpecs[k].className, found = markers.hasOwnProperty(id) && markers[id];\n        if (found)\n          { gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\",\n                                     (\"left: \" + (dims.gutterLeft[id]) + \"px; width: \" + (dims.gutterWidth[id]) + \"px\"))); }\n      } }\n    }\n  }\n\n  function updateLineWidgets(cm, lineView, dims) {\n    if (lineView.alignable) { lineView.alignable = null; }\n    var isWidget = classTest(\"CodeMirror-linewidget\");\n    for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\n      next = node.nextSibling;\n      if (isWidget.test(node.className)) { lineView.node.removeChild(node); }\n    }\n    insertLineWidgets(cm, lineView, dims);\n  }\n\n  // Build a line's DOM representation from scratch\n  function buildLineElement(cm, lineView, lineN, dims) {\n    var built = getLineContent(cm, lineView);\n    lineView.text = lineView.node = built.pre;\n    if (built.bgClass) { lineView.bgClass = built.bgClass; }\n    if (built.textClass) { lineView.textClass = built.textClass; }\n\n    updateLineClasses(cm, lineView);\n    updateLineGutter(cm, lineView, lineN, dims);\n    insertLineWidgets(cm, lineView, dims);\n    return lineView.node\n  }\n\n  // A lineView may contain multiple logical lines (when merged by\n  // collapsed spans). The widgets for all of them need to be drawn.\n  function insertLineWidgets(cm, lineView, dims) {\n    insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n      { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false); } }\n  }\n\n  function insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n    if (!line.widgets) { return }\n    var wrap = ensureLineWrapped(lineView);\n    for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n      var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\" + (widget.className ? \" \" + widget.className : \"\"));\n      if (!widget.handleMouseEvents) { node.setAttribute(\"cm-ignore-events\", \"true\"); }\n      positionLineWidget(widget, node, lineView, dims);\n      cm.display.input.setUneditable(node);\n      if (allowAbove && widget.above)\n        { wrap.insertBefore(node, lineView.gutter || lineView.text); }\n      else\n        { wrap.appendChild(node); }\n      signalLater(widget, \"redraw\");\n    }\n  }\n\n  function positionLineWidget(widget, node, lineView, dims) {\n    if (widget.noHScroll) {\n  (lineView.alignable || (lineView.alignable = [])).push(node);\n      var width = dims.wrapperWidth;\n      node.style.left = dims.fixedPos + \"px\";\n      if (!widget.coverGutter) {\n        width -= dims.gutterTotalWidth;\n        node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n      }\n      node.style.width = width + \"px\";\n    }\n    if (widget.coverGutter) {\n      node.style.zIndex = 5;\n      node.style.position = \"relative\";\n      if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + \"px\"; }\n    }\n  }\n\n  function widgetHeight(widget) {\n    if (widget.height != null) { return widget.height }\n    var cm = widget.doc.cm;\n    if (!cm) { return 0 }\n    if (!contains(document.body, widget.node)) {\n      var parentStyle = \"position: relative;\";\n      if (widget.coverGutter)\n        { parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\"; }\n      if (widget.noHScroll)\n        { parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\"; }\n      removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n    }\n    return widget.height = widget.node.parentNode.offsetHeight\n  }\n\n  // Return true when the given mouse event happened in a widget\n  function eventInWidget(display, e) {\n    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n      if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\n          (n.parentNode == display.sizer && n != display.mover))\n        { return true }\n    }\n  }\n\n  // POSITION MEASUREMENT\n\n  function paddingTop(display) {return display.lineSpace.offsetTop}\n  function paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\n  function paddingH(display) {\n    if (display.cachedPaddingH) { return display.cachedPaddingH }\n    var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\", \"CodeMirror-line-like\"));\n    var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n    var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n    if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data; }\n    return data\n  }\n\n  function scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\n  function displayWidth(cm) {\n    return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\n  }\n  function displayHeight(cm) {\n    return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\n  }\n\n  // Ensure the lineView.wrapping.heights array is populated. This is\n  // an array of bottom offsets for the lines that make up a drawn\n  // line. When lineWrapping is on, there might be more than one\n  // height.\n  function ensureLineHeights(cm, lineView, rect) {\n    var wrapping = cm.options.lineWrapping;\n    var curWidth = wrapping && displayWidth(cm);\n    if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n      var heights = lineView.measure.heights = [];\n      if (wrapping) {\n        lineView.measure.width = curWidth;\n        var rects = lineView.text.firstChild.getClientRects();\n        for (var i = 0; i < rects.length - 1; i++) {\n          var cur = rects[i], next = rects[i + 1];\n          if (Math.abs(cur.bottom - next.bottom) > 2)\n            { heights.push((cur.bottom + next.top) / 2 - rect.top); }\n        }\n      }\n      heights.push(rect.bottom - rect.top);\n    }\n  }\n\n  // Find a line map (mapping character offsets to text nodes) and a\n  // measurement cache for the given line number. (A line view might\n  // contain multiple lines when collapsed ranges are present.)\n  function mapFromLineView(lineView, line, lineN) {\n    if (lineView.line == line)\n      { return {map: lineView.measure.map, cache: lineView.measure.cache} }\n    for (var i = 0; i < lineView.rest.length; i++)\n      { if (lineView.rest[i] == line)\n        { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\n    for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\n      { if (lineNo(lineView.rest[i$1]) > lineN)\n        { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\n  }\n\n  // Render a line into the hidden node display.externalMeasured. Used\n  // when measurement is needed for a line that's not in the viewport.\n  function updateExternalMeasurement(cm, line) {\n    line = visualLine(line);\n    var lineN = lineNo(line);\n    var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n    view.lineN = lineN;\n    var built = view.built = buildLineContent(cm, view);\n    view.text = built.pre;\n    removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n    return view\n  }\n\n  // Get a {top, bottom, left, right} box (in line-local coordinates)\n  // for a given character.\n  function measureChar(cm, line, ch, bias) {\n    return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\n  }\n\n  // Find a line view that corresponds to the given line number.\n  function findViewForLine(cm, lineN) {\n    if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n      { return cm.display.view[findViewIndex(cm, lineN)] }\n    var ext = cm.display.externalMeasured;\n    if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n      { return ext }\n  }\n\n  // Measurement can be split in two steps, the set-up work that\n  // applies to the whole line, and the measurement of the actual\n  // character. Functions like coordsChar, that need to do a lot of\n  // measurements in a row, can thus ensure that the set-up work is\n  // only done once.\n  function prepareMeasureForLine(cm, line) {\n    var lineN = lineNo(line);\n    var view = findViewForLine(cm, lineN);\n    if (view && !view.text) {\n      view = null;\n    } else if (view && view.changes) {\n      updateLineForChanges(cm, view, lineN, getDimensions(cm));\n      cm.curOp.forceUpdate = true;\n    }\n    if (!view)\n      { view = updateExternalMeasurement(cm, line); }\n\n    var info = mapFromLineView(view, line, lineN);\n    return {\n      line: line, view: view, rect: null,\n      map: info.map, cache: info.cache, before: info.before,\n      hasHeights: false\n    }\n  }\n\n  // Given a prepared measurement object, measures the position of an\n  // actual character (or fetches it from the cache).\n  function measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n    if (prepared.before) { ch = -1; }\n    var key = ch + (bias || \"\"), found;\n    if (prepared.cache.hasOwnProperty(key)) {\n      found = prepared.cache[key];\n    } else {\n      if (!prepared.rect)\n        { prepared.rect = prepared.view.text.getBoundingClientRect(); }\n      if (!prepared.hasHeights) {\n        ensureLineHeights(cm, prepared.view, prepared.rect);\n        prepared.hasHeights = true;\n      }\n      found = measureCharInner(cm, prepared, ch, bias);\n      if (!found.bogus) { prepared.cache[key] = found; }\n    }\n    return {left: found.left, right: found.right,\n            top: varHeight ? found.rtop : found.top,\n            bottom: varHeight ? found.rbottom : found.bottom}\n  }\n\n  var nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\n  function nodeAndOffsetInLineMap(map, ch, bias) {\n    var node, start, end, collapse, mStart, mEnd;\n    // First, search the line map for the text node corresponding to,\n    // or closest to, the target character.\n    for (var i = 0; i < map.length; i += 3) {\n      mStart = map[i];\n      mEnd = map[i + 1];\n      if (ch < mStart) {\n        start = 0; end = 1;\n        collapse = \"left\";\n      } else if (ch < mEnd) {\n        start = ch - mStart;\n        end = start + 1;\n      } else if (i == map.length - 3 || ch == mEnd && map[i + 3] > ch) {\n        end = mEnd - mStart;\n        start = end - 1;\n        if (ch >= mEnd) { collapse = \"right\"; }\n      }\n      if (start != null) {\n        node = map[i + 2];\n        if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n          { collapse = bias; }\n        if (bias == \"left\" && start == 0)\n          { while (i && map[i - 2] == map[i - 3] && map[i - 1].insertLeft) {\n            node = map[(i -= 3) + 2];\n            collapse = \"left\";\n          } }\n        if (bias == \"right\" && start == mEnd - mStart)\n          { while (i < map.length - 3 && map[i + 3] == map[i + 4] && !map[i + 5].insertLeft) {\n            node = map[(i += 3) + 2];\n            collapse = \"right\";\n          } }\n        break\n      }\n    }\n    return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\n  }\n\n  function getUsefulRect(rects, bias) {\n    var rect = nullRect;\n    if (bias == \"left\") { for (var i = 0; i < rects.length; i++) {\n      if ((rect = rects[i]).left != rect.right) { break }\n    } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n      if ((rect = rects[i$1]).left != rect.right) { break }\n    } }\n    return rect\n  }\n\n  function measureCharInner(cm, prepared, ch, bias) {\n    var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n    var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\n\n    var rect;\n    if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n      for (var i$1 = 0; i$1 < 4; i$1++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n        while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start; }\n        while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end; }\n        if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\n          { rect = node.parentNode.getBoundingClientRect(); }\n        else\n          { rect = getUsefulRect(range(node, start, end).getClientRects(), bias); }\n        if (rect.left || rect.right || start == 0) { break }\n        end = start;\n        start = start - 1;\n        collapse = \"right\";\n      }\n      if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect); }\n    } else { // If it is a widget, simply get the box for the whole widget.\n      if (start > 0) { collapse = bias = \"right\"; }\n      var rects;\n      if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n        { rect = rects[bias == \"right\" ? rects.length - 1 : 0]; }\n      else\n        { rect = node.getBoundingClientRect(); }\n    }\n    if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n      var rSpan = node.parentNode.getClientRects()[0];\n      if (rSpan)\n        { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom}; }\n      else\n        { rect = nullRect; }\n    }\n\n    var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n    var mid = (rtop + rbot) / 2;\n    var heights = prepared.view.measure.heights;\n    var i = 0;\n    for (; i < heights.length - 1; i++)\n      { if (mid < heights[i]) { break } }\n    var top = i ? heights[i - 1] : 0, bot = heights[i];\n    var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                  right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                  top: top, bottom: bot};\n    if (!rect.left && !rect.right) { result.bogus = true; }\n    if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n    return result\n  }\n\n  // Work around problem with bounding client rects on ranges being\n  // returned incorrectly when zoomed on IE10 and below.\n  function maybeUpdateRectForZooming(measure, rect) {\n    if (!window.screen || screen.logicalXDPI == null ||\n        screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n      { return rect }\n    var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n    var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n    return {left: rect.left * scaleX, right: rect.right * scaleX,\n            top: rect.top * scaleY, bottom: rect.bottom * scaleY}\n  }\n\n  function clearLineMeasurementCacheFor(lineView) {\n    if (lineView.measure) {\n      lineView.measure.cache = {};\n      lineView.measure.heights = null;\n      if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n        { lineView.measure.caches[i] = {}; } }\n    }\n  }\n\n  function clearLineMeasurementCache(cm) {\n    cm.display.externalMeasure = null;\n    removeChildren(cm.display.lineMeasure);\n    for (var i = 0; i < cm.display.view.length; i++)\n      { clearLineMeasurementCacheFor(cm.display.view[i]); }\n  }\n\n  function clearCaches(cm) {\n    clearLineMeasurementCache(cm);\n    cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n    if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true; }\n    cm.display.lineNumChars = null;\n  }\n\n  function pageScrollX() {\n    // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n    // which causes page_Offset and bounding client rects to use\n    // different reference viewports and invalidate our calculations.\n    if (chrome && android) { return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft)) }\n    return window.pageXOffset || (document.documentElement || document.body).scrollLeft\n  }\n  function pageScrollY() {\n    if (chrome && android) { return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop)) }\n    return window.pageYOffset || (document.documentElement || document.body).scrollTop\n  }\n\n  function widgetTopHeight(lineObj) {\n    var height = 0;\n    if (lineObj.widgets) { for (var i = 0; i < lineObj.widgets.length; ++i) { if (lineObj.widgets[i].above)\n      { height += widgetHeight(lineObj.widgets[i]); } } }\n    return height\n  }\n\n  // Converts a {top, bottom, left, right} box from line-local\n  // coordinates into another coordinate system. Context may be one of\n  // \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n  // or \"page\".\n  function intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n    if (!includeWidgets) {\n      var height = widgetTopHeight(lineObj);\n      rect.top += height; rect.bottom += height;\n    }\n    if (context == \"line\") { return rect }\n    if (!context) { context = \"local\"; }\n    var yOff = heightAtLine(lineObj);\n    if (context == \"local\") { yOff += paddingTop(cm.display); }\n    else { yOff -= cm.display.viewOffset; }\n    if (context == \"page\" || context == \"window\") {\n      var lOff = cm.display.lineSpace.getBoundingClientRect();\n      yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n      var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n      rect.left += xOff; rect.right += xOff;\n    }\n    rect.top += yOff; rect.bottom += yOff;\n    return rect\n  }\n\n  // Coverts a box from \"div\" coords to another coordinate system.\n  // Context may be \"window\", \"page\", \"div\", or \"local\"./null.\n  function fromCoordSystem(cm, coords, context) {\n    if (context == \"div\") { return coords }\n    var left = coords.left, top = coords.top;\n    // First move into \"page\" coordinate system\n    if (context == \"page\") {\n      left -= pageScrollX();\n      top -= pageScrollY();\n    } else if (context == \"local\" || !context) {\n      var localBox = cm.display.sizer.getBoundingClientRect();\n      left += localBox.left;\n      top += localBox.top;\n    }\n\n    var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n    return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\n  }\n\n  function charCoords(cm, pos, context, lineObj, bias) {\n    if (!lineObj) { lineObj = getLine(cm.doc, pos.line); }\n    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\n  }\n\n  // Returns a box for a given cursor position, which may have an\n  // 'other' property containing the position of the secondary cursor\n  // on a bidi boundary.\n  // A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n  // and after `char - 1` in writing order of `char - 1`\n  // A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n  // and before `char` in writing order of `char`\n  // Examples (upper-case letters are RTL, lower-case are LTR):\n  //     Pos(0, 1, ...)\n  //     before   after\n  // ab     a|b     a|b\n  // aB     a|B     aB|\n  // Ab     |Ab     A|b\n  // AB     B|A     B|A\n  // Every position after the last character on a line is considered to stick\n  // to the last character on the line.\n  function cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n    lineObj = lineObj || getLine(cm.doc, pos.line);\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    function get(ch, right) {\n      var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n      if (right) { m.left = m.right; } else { m.right = m.left; }\n      return intoCoordSystem(cm, lineObj, m, context)\n    }\n    var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky;\n    if (ch >= lineObj.text.length) {\n      ch = lineObj.text.length;\n      sticky = \"before\";\n    } else if (ch <= 0) {\n      ch = 0;\n      sticky = \"after\";\n    }\n    if (!order) { return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\") }\n\n    function getBidi(ch, partPos, invert) {\n      var part = order[partPos], right = part.level == 1;\n      return get(invert ? ch - 1 : ch, right != invert)\n    }\n    var partPos = getBidiPartAt(order, ch, sticky);\n    var other = bidiOther;\n    var val = getBidi(ch, partPos, sticky == \"before\");\n    if (other != null) { val.other = getBidi(ch, other, sticky != \"before\"); }\n    return val\n  }\n\n  // Used to cheaply estimate the coordinates for a position. Used for\n  // intermediate scroll updates.\n  function estimateCoords(cm, pos) {\n    var left = 0;\n    pos = clipPos(cm.doc, pos);\n    if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch; }\n    var lineObj = getLine(cm.doc, pos.line);\n    var top = heightAtLine(lineObj) + paddingTop(cm.display);\n    return {left: left, right: left, top: top, bottom: top + lineObj.height}\n  }\n\n  // Positions returned by coordsChar contain some extra information.\n  // xRel is the relative x position of the input coordinates compared\n  // to the found position (so xRel > 0 means the coordinates are to\n  // the right of the character position, for example). When outside\n  // is true, that means the coordinates lie outside the line's\n  // vertical range.\n  function PosWithInfo(line, ch, sticky, outside, xRel) {\n    var pos = Pos(line, ch, sticky);\n    pos.xRel = xRel;\n    if (outside) { pos.outside = outside; }\n    return pos\n  }\n\n  // Compute the character position closest to the given coordinates.\n  // Input must be lineSpace-local (\"div\" coordinate system).\n  function coordsChar(cm, x, y) {\n    var doc = cm.doc;\n    y += cm.display.viewOffset;\n    if (y < 0) { return PosWithInfo(doc.first, 0, null, -1, -1) }\n    var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n    if (lineN > last)\n      { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, 1, 1) }\n    if (x < 0) { x = 0; }\n\n    var lineObj = getLine(doc, lineN);\n    for (;;) {\n      var found = coordsCharInner(cm, lineObj, lineN, x, y);\n      var collapsed = collapsedSpanAround(lineObj, found.ch + (found.xRel > 0 || found.outside > 0 ? 1 : 0));\n      if (!collapsed) { return found }\n      var rangeEnd = collapsed.find(1);\n      if (rangeEnd.line == lineN) { return rangeEnd }\n      lineObj = getLine(doc, lineN = rangeEnd.line);\n    }\n  }\n\n  function wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n    y -= widgetTopHeight(lineObj);\n    var end = lineObj.text.length;\n    var begin = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch - 1).bottom <= y; }, end, 0);\n    end = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch).top > y; }, begin, end);\n    return {begin: begin, end: end}\n  }\n\n  function wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n    return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\n  }\n\n  // Returns true if the given side of a box is after the given\n  // coordinates, in top-to-bottom, left-to-right order.\n  function boxIsAfter(box, x, y, left) {\n    return box.bottom <= y ? false : box.top > y ? true : (left ? box.left : box.right) > x\n  }\n\n  function coordsCharInner(cm, lineObj, lineNo, x, y) {\n    // Move y into line-local coordinate space\n    y -= heightAtLine(lineObj);\n    var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n    // When directly calling `measureCharPrepared`, we have to adjust\n    // for the widgets at this line.\n    var widgetHeight = widgetTopHeight(lineObj);\n    var begin = 0, end = lineObj.text.length, ltr = true;\n\n    var order = getOrder(lineObj, cm.doc.direction);\n    // If the line isn't plain left-to-right text, first figure out\n    // which bidi section the coordinates fall into.\n    if (order) {\n      var part = (cm.options.lineWrapping ? coordsBidiPartWrapped : coordsBidiPart)\n                   (cm, lineObj, lineNo, preparedMeasure, order, x, y);\n      ltr = part.level != 1;\n      // The awkward -1 offsets are needed because findFirst (called\n      // on these below) will treat its first bound as inclusive,\n      // second as exclusive, but we want to actually address the\n      // characters in the part's range\n      begin = ltr ? part.from : part.to - 1;\n      end = ltr ? part.to : part.from - 1;\n    }\n\n    // A binary search to find the first character whose bounding box\n    // starts after the coordinates. If we run across any whose box wrap\n    // the coordinates, store that.\n    var chAround = null, boxAround = null;\n    var ch = findFirst(function (ch) {\n      var box = measureCharPrepared(cm, preparedMeasure, ch);\n      box.top += widgetHeight; box.bottom += widgetHeight;\n      if (!boxIsAfter(box, x, y, false)) { return false }\n      if (box.top <= y && box.left <= x) {\n        chAround = ch;\n        boxAround = box;\n      }\n      return true\n    }, begin, end);\n\n    var baseX, sticky, outside = false;\n    // If a box around the coordinates was found, use that\n    if (boxAround) {\n      // Distinguish coordinates nearer to the left or right side of the box\n      var atLeft = x - boxAround.left < boxAround.right - x, atStart = atLeft == ltr;\n      ch = chAround + (atStart ? 0 : 1);\n      sticky = atStart ? \"after\" : \"before\";\n      baseX = atLeft ? boxAround.left : boxAround.right;\n    } else {\n      // (Adjust for extended bound, if necessary.)\n      if (!ltr && (ch == end || ch == begin)) { ch++; }\n      // To determine which side to associate with, get the box to the\n      // left of the character and compare it's vertical position to the\n      // coordinates\n      sticky = ch == 0 ? \"after\" : ch == lineObj.text.length ? \"before\" :\n        (measureCharPrepared(cm, preparedMeasure, ch - (ltr ? 1 : 0)).bottom + widgetHeight <= y) == ltr ?\n        \"after\" : \"before\";\n      // Now get accurate coordinates for this place, in order to get a\n      // base X position\n      var coords = cursorCoords(cm, Pos(lineNo, ch, sticky), \"line\", lineObj, preparedMeasure);\n      baseX = coords.left;\n      outside = y < coords.top ? -1 : y >= coords.bottom ? 1 : 0;\n    }\n\n    ch = skipExtendingChars(lineObj.text, ch, 1);\n    return PosWithInfo(lineNo, ch, sticky, outside, x - baseX)\n  }\n\n  function coordsBidiPart(cm, lineObj, lineNo, preparedMeasure, order, x, y) {\n    // Bidi parts are sorted left-to-right, and in a non-line-wrapping\n    // situation, we can take this ordering to correspond to the visual\n    // ordering. This finds the first part whose end is after the given\n    // coordinates.\n    var index = findFirst(function (i) {\n      var part = order[i], ltr = part.level != 1;\n      return boxIsAfter(cursorCoords(cm, Pos(lineNo, ltr ? part.to : part.from, ltr ? \"before\" : \"after\"),\n                                     \"line\", lineObj, preparedMeasure), x, y, true)\n    }, 0, order.length - 1);\n    var part = order[index];\n    // If this isn't the first part, the part's start is also after\n    // the coordinates, and the coordinates aren't on the same line as\n    // that start, move one part back.\n    if (index > 0) {\n      var ltr = part.level != 1;\n      var start = cursorCoords(cm, Pos(lineNo, ltr ? part.from : part.to, ltr ? \"after\" : \"before\"),\n                               \"line\", lineObj, preparedMeasure);\n      if (boxIsAfter(start, x, y, true) && start.top > y)\n        { part = order[index - 1]; }\n    }\n    return part\n  }\n\n  function coordsBidiPartWrapped(cm, lineObj, _lineNo, preparedMeasure, order, x, y) {\n    // In a wrapped line, rtl text on wrapping boundaries can do things\n    // that don't correspond to the ordering in our `order` array at\n    // all, so a binary search doesn't work, and we want to return a\n    // part that only spans one line so that the binary search in\n    // coordsCharInner is safe. As such, we first find the extent of the\n    // wrapped line, and then do a flat search in which we discard any\n    // spans that aren't on the line.\n    var ref = wrappedLineExtent(cm, lineObj, preparedMeasure, y);\n    var begin = ref.begin;\n    var end = ref.end;\n    if (/\\s/.test(lineObj.text.charAt(end - 1))) { end--; }\n    var part = null, closestDist = null;\n    for (var i = 0; i < order.length; i++) {\n      var p = order[i];\n      if (p.from >= end || p.to <= begin) { continue }\n      var ltr = p.level != 1;\n      var endX = measureCharPrepared(cm, preparedMeasure, ltr ? Math.min(end, p.to) - 1 : Math.max(begin, p.from)).right;\n      // Weigh against spans ending before this, so that they are only\n      // picked if nothing ends after\n      var dist = endX < x ? x - endX + 1e9 : endX - x;\n      if (!part || closestDist > dist) {\n        part = p;\n        closestDist = dist;\n      }\n    }\n    if (!part) { part = order[order.length - 1]; }\n    // Clip the part to the wrapped line.\n    if (part.from < begin) { part = {from: begin, to: part.to, level: part.level}; }\n    if (part.to > end) { part = {from: part.from, to: end, level: part.level}; }\n    return part\n  }\n\n  var measureText;\n  // Compute the default text height.\n  function textHeight(display) {\n    if (display.cachedTextHeight != null) { return display.cachedTextHeight }\n    if (measureText == null) {\n      measureText = elt(\"pre\", null, \"CodeMirror-line-like\");\n      // Measure a bunch of lines, for browsers that compute\n      // fractional heights.\n      for (var i = 0; i < 49; ++i) {\n        measureText.appendChild(document.createTextNode(\"x\"));\n        measureText.appendChild(elt(\"br\"));\n      }\n      measureText.appendChild(document.createTextNode(\"x\"));\n    }\n    removeChildrenAndAdd(display.measure, measureText);\n    var height = measureText.offsetHeight / 50;\n    if (height > 3) { display.cachedTextHeight = height; }\n    removeChildren(display.measure);\n    return height || 1\n  }\n\n  // Compute the default character width.\n  function charWidth(display) {\n    if (display.cachedCharWidth != null) { return display.cachedCharWidth }\n    var anchor = elt(\"span\", \"xxxxxxxxxx\");\n    var pre = elt(\"pre\", [anchor], \"CodeMirror-line-like\");\n    removeChildrenAndAdd(display.measure, pre);\n    var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n    if (width > 2) { display.cachedCharWidth = width; }\n    return width || 10\n  }\n\n  // Do a bulk-read of the DOM positions and sizes needed to draw the\n  // view, so that we don't interleave reading and writing to the DOM.\n  function getDimensions(cm) {\n    var d = cm.display, left = {}, width = {};\n    var gutterLeft = d.gutters.clientLeft;\n    for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n      var id = cm.display.gutterSpecs[i].className;\n      left[id] = n.offsetLeft + n.clientLeft + gutterLeft;\n      width[id] = n.clientWidth;\n    }\n    return {fixedPos: compensateForHScroll(d),\n            gutterTotalWidth: d.gutters.offsetWidth,\n            gutterLeft: left,\n            gutterWidth: width,\n            wrapperWidth: d.wrapper.clientWidth}\n  }\n\n  // Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n  // but using getBoundingClientRect to get a sub-pixel-accurate\n  // result.\n  function compensateForHScroll(display) {\n    return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\n  }\n\n  // Returns a function that estimates the height of a line, to use as\n  // first approximation until the line becomes visible (and is thus\n  // properly measurable).\n  function estimateHeight(cm) {\n    var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n    var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n    return function (line) {\n      if (lineIsHidden(cm.doc, line)) { return 0 }\n\n      var widgetsHeight = 0;\n      if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\n        if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height; }\n      } }\n\n      if (wrapping)\n        { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\n      else\n        { return widgetsHeight + th }\n    }\n  }\n\n  function estimateLineHeights(cm) {\n    var doc = cm.doc, est = estimateHeight(cm);\n    doc.iter(function (line) {\n      var estHeight = est(line);\n      if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n    });\n  }\n\n  // Given a mouse event, find the corresponding position. If liberal\n  // is false, it checks whether a gutter or scrollbar was clicked,\n  // and returns null if it was. forRect is used by rectangular\n  // selections, and tries to estimate a character position even for\n  // coordinates beyond the right of the text.\n  function posFromMouse(cm, e, liberal, forRect) {\n    var display = cm.display;\n    if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") { return null }\n\n    var x, y, space = display.lineSpace.getBoundingClientRect();\n    // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n    try { x = e.clientX - space.left; y = e.clientY - space.top; }\n    catch (e) { return null }\n    var coords = coordsChar(cm, x, y), line;\n    if (forRect && coords.xRel > 0 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n      var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n      coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n    }\n    return coords\n  }\n\n  // Find the view element corresponding to a given line. Return null\n  // when the line isn't visible.\n  function findViewIndex(cm, n) {\n    if (n >= cm.display.viewTo) { return null }\n    n -= cm.display.viewFrom;\n    if (n < 0) { return null }\n    var view = cm.display.view;\n    for (var i = 0; i < view.length; i++) {\n      n -= view[i].size;\n      if (n < 0) { return i }\n    }\n  }\n\n  // Updates the display.view data structure for a given change to the\n  // document. From and to are in pre-change coordinates. Lendiff is\n  // the amount of lines added or subtracted by the change. This is\n  // used for changes that span multiple lines, or change the way\n  // lines are divided into visual lines. regLineChange (below)\n  // registers single-line changes.\n  function regChange(cm, from, to, lendiff) {\n    if (from == null) { from = cm.doc.first; }\n    if (to == null) { to = cm.doc.first + cm.doc.size; }\n    if (!lendiff) { lendiff = 0; }\n\n    var display = cm.display;\n    if (lendiff && to < display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers > from))\n      { display.updateLineNumbers = from; }\n\n    cm.curOp.viewChanged = true;\n\n    if (from >= display.viewTo) { // Change after\n      if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n        { resetView(cm); }\n    } else if (to <= display.viewFrom) { // Change before\n      if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n        resetView(cm);\n      } else {\n        display.viewFrom += lendiff;\n        display.viewTo += lendiff;\n      }\n    } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n      resetView(cm);\n    } else if (from <= display.viewFrom) { // Top overlap\n      var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cut) {\n        display.view = display.view.slice(cut.index);\n        display.viewFrom = cut.lineN;\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    } else if (to >= display.viewTo) { // Bottom overlap\n      var cut$1 = viewCuttingPoint(cm, from, from, -1);\n      if (cut$1) {\n        display.view = display.view.slice(0, cut$1.index);\n        display.viewTo = cut$1.lineN;\n      } else {\n        resetView(cm);\n      }\n    } else { // Gap in the middle\n      var cutTop = viewCuttingPoint(cm, from, from, -1);\n      var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cutTop && cutBot) {\n        display.view = display.view.slice(0, cutTop.index)\n          .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n          .concat(display.view.slice(cutBot.index));\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    }\n\n    var ext = display.externalMeasured;\n    if (ext) {\n      if (to < ext.lineN)\n        { ext.lineN += lendiff; }\n      else if (from < ext.lineN + ext.size)\n        { display.externalMeasured = null; }\n    }\n  }\n\n  // Register a change to a single line. Type must be one of \"text\",\n  // \"gutter\", \"class\", \"widget\"\n  function regLineChange(cm, line, type) {\n    cm.curOp.viewChanged = true;\n    var display = cm.display, ext = cm.display.externalMeasured;\n    if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n      { display.externalMeasured = null; }\n\n    if (line < display.viewFrom || line >= display.viewTo) { return }\n    var lineView = display.view[findViewIndex(cm, line)];\n    if (lineView.node == null) { return }\n    var arr = lineView.changes || (lineView.changes = []);\n    if (indexOf(arr, type) == -1) { arr.push(type); }\n  }\n\n  // Clear the view.\n  function resetView(cm) {\n    cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n    cm.display.view = [];\n    cm.display.viewOffset = 0;\n  }\n\n  function viewCuttingPoint(cm, oldN, newN, dir) {\n    var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n    if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n      { return {index: index, lineN: newN} }\n    var n = cm.display.viewFrom;\n    for (var i = 0; i < index; i++)\n      { n += view[i].size; }\n    if (n != oldN) {\n      if (dir > 0) {\n        if (index == view.length - 1) { return null }\n        diff = (n + view[index].size) - oldN;\n        index++;\n      } else {\n        diff = n - oldN;\n      }\n      oldN += diff; newN += diff;\n    }\n    while (visualLineNo(cm.doc, newN) != newN) {\n      if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\n      newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n      index += dir;\n    }\n    return {index: index, lineN: newN}\n  }\n\n  // Force the view to cover a given range, adding empty view element\n  // or clipping off existing ones as needed.\n  function adjustView(cm, from, to) {\n    var display = cm.display, view = display.view;\n    if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n      display.view = buildViewArray(cm, from, to);\n      display.viewFrom = from;\n    } else {\n      if (display.viewFrom > from)\n        { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view); }\n      else if (display.viewFrom < from)\n        { display.view = display.view.slice(findViewIndex(cm, from)); }\n      display.viewFrom = from;\n      if (display.viewTo < to)\n        { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)); }\n      else if (display.viewTo > to)\n        { display.view = display.view.slice(0, findViewIndex(cm, to)); }\n    }\n    display.viewTo = to;\n  }\n\n  // Count the number of lines in the view whose DOM representation is\n  // out of date (or nonexistent).\n  function countDirtyView(cm) {\n    var view = cm.display.view, dirty = 0;\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty; }\n    }\n    return dirty\n  }\n\n  function updateSelection(cm) {\n    cm.display.input.showSelection(cm.display.input.prepareSelection());\n  }\n\n  function prepareSelection(cm, primary) {\n    if ( primary === void 0 ) primary = true;\n\n    var doc = cm.doc, result = {};\n    var curFragment = result.cursors = document.createDocumentFragment();\n    var selFragment = result.selection = document.createDocumentFragment();\n\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      if (!primary && i == doc.sel.primIndex) { continue }\n      var range = doc.sel.ranges[i];\n      if (range.from().line >= cm.display.viewTo || range.to().line < cm.display.viewFrom) { continue }\n      var collapsed = range.empty();\n      if (collapsed || cm.options.showCursorWhenSelecting)\n        { drawSelectionCursor(cm, range.head, curFragment); }\n      if (!collapsed)\n        { drawSelectionRange(cm, range, selFragment); }\n    }\n    return result\n  }\n\n  // Draws a cursor for the given range\n  function drawSelectionCursor(cm, head, output) {\n    var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n    var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n    cursor.style.left = pos.left + \"px\";\n    cursor.style.top = pos.top + \"px\";\n    cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n    if (pos.other) {\n      // Secondary cursor, shown when on a 'jump' in bi-directional text\n      var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n      otherCursor.style.display = \"\";\n      otherCursor.style.left = pos.other.left + \"px\";\n      otherCursor.style.top = pos.other.top + \"px\";\n      otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n    }\n  }\n\n  function cmpCoords(a, b) { return a.top - b.top || a.left - b.left }\n\n  // Draws the given range as a highlighted selection\n  function drawSelectionRange(cm, range, output) {\n    var display = cm.display, doc = cm.doc;\n    var fragment = document.createDocumentFragment();\n    var padding = paddingH(cm.display), leftSide = padding.left;\n    var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n    var docLTR = doc.direction == \"ltr\";\n\n    function add(left, top, width, bottom) {\n      if (top < 0) { top = 0; }\n      top = Math.round(top);\n      bottom = Math.round(bottom);\n      fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", (\"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\")));\n    }\n\n    function drawForLine(line, fromArg, toArg) {\n      var lineObj = getLine(doc, line);\n      var lineLen = lineObj.text.length;\n      var start, end;\n      function coords(ch, bias) {\n        return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias)\n      }\n\n      function wrapX(pos, dir, side) {\n        var extent = wrappedLineExtentChar(cm, lineObj, null, pos);\n        var prop = (dir == \"ltr\") == (side == \"after\") ? \"left\" : \"right\";\n        var ch = side == \"after\" ? extent.begin : extent.end - (/\\s/.test(lineObj.text.charAt(extent.end - 1)) ? 2 : 1);\n        return coords(ch, prop)[prop]\n      }\n\n      var order = getOrder(lineObj, doc.direction);\n      iterateBidiSections(order, fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir, i) {\n        var ltr = dir == \"ltr\";\n        var fromPos = coords(from, ltr ? \"left\" : \"right\");\n        var toPos = coords(to - 1, ltr ? \"right\" : \"left\");\n\n        var openStart = fromArg == null && from == 0, openEnd = toArg == null && to == lineLen;\n        var first = i == 0, last = !order || i == order.length - 1;\n        if (toPos.top - fromPos.top <= 3) { // Single line\n          var openLeft = (docLTR ? openStart : openEnd) && first;\n          var openRight = (docLTR ? openEnd : openStart) && last;\n          var left = openLeft ? leftSide : (ltr ? fromPos : toPos).left;\n          var right = openRight ? rightSide : (ltr ? toPos : fromPos).right;\n          add(left, fromPos.top, right - left, fromPos.bottom);\n        } else { // Multiple lines\n          var topLeft, topRight, botLeft, botRight;\n          if (ltr) {\n            topLeft = docLTR && openStart && first ? leftSide : fromPos.left;\n            topRight = docLTR ? rightSide : wrapX(from, dir, \"before\");\n            botLeft = docLTR ? leftSide : wrapX(to, dir, \"after\");\n            botRight = docLTR && openEnd && last ? rightSide : toPos.right;\n          } else {\n            topLeft = !docLTR ? leftSide : wrapX(from, dir, \"before\");\n            topRight = !docLTR && openStart && first ? rightSide : fromPos.right;\n            botLeft = !docLTR && openEnd && last ? leftSide : toPos.left;\n            botRight = !docLTR ? rightSide : wrapX(to, dir, \"after\");\n          }\n          add(topLeft, fromPos.top, topRight - topLeft, fromPos.bottom);\n          if (fromPos.bottom < toPos.top) { add(leftSide, fromPos.bottom, null, toPos.top); }\n          add(botLeft, toPos.top, botRight - botLeft, toPos.bottom);\n        }\n\n        if (!start || cmpCoords(fromPos, start) < 0) { start = fromPos; }\n        if (cmpCoords(toPos, start) < 0) { start = toPos; }\n        if (!end || cmpCoords(fromPos, end) < 0) { end = fromPos; }\n        if (cmpCoords(toPos, end) < 0) { end = toPos; }\n      });\n      return {start: start, end: end}\n    }\n\n    var sFrom = range.from(), sTo = range.to();\n    if (sFrom.line == sTo.line) {\n      drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n    } else {\n      var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n      var singleVLine = visualLine(fromLine) == visualLine(toLine);\n      var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n      var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n      if (singleVLine) {\n        if (leftEnd.top < rightStart.top - 2) {\n          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n          add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n        } else {\n          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n        }\n      }\n      if (leftEnd.bottom < rightStart.top)\n        { add(leftSide, leftEnd.bottom, null, rightStart.top); }\n    }\n\n    output.appendChild(fragment);\n  }\n\n  // Cursor-blinking\n  function restartBlink(cm) {\n    if (!cm.state.focused) { return }\n    var display = cm.display;\n    clearInterval(display.blinker);\n    var on = true;\n    display.cursorDiv.style.visibility = \"\";\n    if (cm.options.cursorBlinkRate > 0)\n      { display.blinker = setInterval(function () { return display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\"; },\n        cm.options.cursorBlinkRate); }\n    else if (cm.options.cursorBlinkRate < 0)\n      { display.cursorDiv.style.visibility = \"hidden\"; }\n  }\n\n  function ensureFocus(cm) {\n    if (!cm.state.focused) { cm.display.input.focus(); onFocus(cm); }\n  }\n\n  function delayBlurEvent(cm) {\n    cm.state.delayingBlurEvent = true;\n    setTimeout(function () { if (cm.state.delayingBlurEvent) {\n      cm.state.delayingBlurEvent = false;\n      onBlur(cm);\n    } }, 100);\n  }\n\n  function onFocus(cm, e) {\n    if (cm.state.delayingBlurEvent) { cm.state.delayingBlurEvent = false; }\n\n    if (cm.options.readOnly == \"nocursor\") { return }\n    if (!cm.state.focused) {\n      signal(cm, \"focus\", cm, e);\n      cm.state.focused = true;\n      addClass(cm.display.wrapper, \"CodeMirror-focused\");\n      // This test prevents this from firing when a context\n      // menu is closed (since the input reset would kill the\n      // select-all detection hack)\n      if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n        cm.display.input.reset();\n        if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20); } // Issue #1730\n      }\n      cm.display.input.receivedFocus();\n    }\n    restartBlink(cm);\n  }\n  function onBlur(cm, e) {\n    if (cm.state.delayingBlurEvent) { return }\n\n    if (cm.state.focused) {\n      signal(cm, \"blur\", cm, e);\n      cm.state.focused = false;\n      rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n    }\n    clearInterval(cm.display.blinker);\n    setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false; } }, 150);\n  }\n\n  // Read the actual heights of the rendered lines, and update their\n  // stored heights to match.\n  function updateHeightsInViewport(cm) {\n    var display = cm.display;\n    var prevBottom = display.lineDiv.offsetTop;\n    for (var i = 0; i < display.view.length; i++) {\n      var cur = display.view[i], wrapping = cm.options.lineWrapping;\n      var height = (void 0), width = 0;\n      if (cur.hidden) { continue }\n      if (ie && ie_version < 8) {\n        var bot = cur.node.offsetTop + cur.node.offsetHeight;\n        height = bot - prevBottom;\n        prevBottom = bot;\n      } else {\n        var box = cur.node.getBoundingClientRect();\n        height = box.bottom - box.top;\n        // Check that lines don't extend past the right of the current\n        // editor width\n        if (!wrapping && cur.text.firstChild)\n          { width = cur.text.firstChild.getBoundingClientRect().right - box.left - 1; }\n      }\n      var diff = cur.line.height - height;\n      if (diff > .005 || diff < -.005) {\n        updateLineHeight(cur.line, height);\n        updateWidgetHeight(cur.line);\n        if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\n          { updateWidgetHeight(cur.rest[j]); } }\n      }\n      if (width > cm.display.sizerWidth) {\n        var chWidth = Math.ceil(width / charWidth(cm.display));\n        if (chWidth > cm.display.maxLineLength) {\n          cm.display.maxLineLength = chWidth;\n          cm.display.maxLine = cur.line;\n          cm.display.maxLineChanged = true;\n        }\n      }\n    }\n  }\n\n  // Read and store the height of line widgets associated with the\n  // given line.\n  function updateWidgetHeight(line) {\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i) {\n      var w = line.widgets[i], parent = w.node.parentNode;\n      if (parent) { w.height = parent.offsetHeight; }\n    } }\n  }\n\n  // Compute the lines that are visible in a given viewport (defaults\n  // the the current scroll position). viewport may contain top,\n  // height, and ensure (see op.scrollToPos) properties.\n  function visibleLines(display, doc, viewport) {\n    var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n    top = Math.floor(top - paddingTop(display));\n    var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n    var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n    // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n    // forces those lines into the viewport (if possible).\n    if (viewport && viewport.ensure) {\n      var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n      if (ensureFrom < from) {\n        from = ensureFrom;\n        to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n      } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n        from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n        to = ensureTo;\n      }\n    }\n    return {from: from, to: Math.max(to, from + 1)}\n  }\n\n  // SCROLLING THINGS INTO VIEW\n\n  // If an editor sits on the top or bottom of the window, partially\n  // scrolled out of view, this ensures that the cursor is visible.\n  function maybeScrollWindow(cm, rect) {\n    if (signalDOMEvent(cm, \"scrollCursorIntoView\")) { return }\n\n    var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n    if (rect.top + box.top < 0) { doScroll = true; }\n    else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) { doScroll = false; }\n    if (doScroll != null && !phantom) {\n      var scrollNode = elt(\"div\", \"\\u200b\", null, (\"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + (rect.left) + \"px; width: \" + (Math.max(2, rect.right - rect.left)) + \"px;\"));\n      cm.display.lineSpace.appendChild(scrollNode);\n      scrollNode.scrollIntoView(doScroll);\n      cm.display.lineSpace.removeChild(scrollNode);\n    }\n  }\n\n  // Scroll a given position into view (immediately), verifying that\n  // it actually became visible (as line heights are accurately\n  // measured, the position of something may 'drift' during drawing).\n  function scrollPosIntoView(cm, pos, end, margin) {\n    if (margin == null) { margin = 0; }\n    var rect;\n    if (!cm.options.lineWrapping && pos == end) {\n      // Set pos and end to the cursor positions around the character pos sticks to\n      // If pos.sticky == \"before\", that is around pos.ch - 1, otherwise around pos.ch\n      // If pos == Pos(_, 0, \"before\"), pos and end are unchanged\n      pos = pos.ch ? Pos(pos.line, pos.sticky == \"before\" ? pos.ch - 1 : pos.ch, \"after\") : pos;\n      end = pos.sticky == \"before\" ? Pos(pos.line, pos.ch + 1, \"before\") : pos;\n    }\n    for (var limit = 0; limit < 5; limit++) {\n      var changed = false;\n      var coords = cursorCoords(cm, pos);\n      var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n      rect = {left: Math.min(coords.left, endCoords.left),\n              top: Math.min(coords.top, endCoords.top) - margin,\n              right: Math.max(coords.left, endCoords.left),\n              bottom: Math.max(coords.bottom, endCoords.bottom) + margin};\n      var scrollPos = calculateScrollPos(cm, rect);\n      var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n      if (scrollPos.scrollTop != null) {\n        updateScrollTop(cm, scrollPos.scrollTop);\n        if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true; }\n      }\n      if (scrollPos.scrollLeft != null) {\n        setScrollLeft(cm, scrollPos.scrollLeft);\n        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true; }\n      }\n      if (!changed) { break }\n    }\n    return rect\n  }\n\n  // Scroll a given set of coordinates into view (immediately).\n  function scrollIntoView(cm, rect) {\n    var scrollPos = calculateScrollPos(cm, rect);\n    if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop); }\n    if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft); }\n  }\n\n  // Calculate a new scroll position needed to scroll the given\n  // rectangle into view. Returns an object with scrollTop and\n  // scrollLeft properties. When these are undefined, the\n  // vertical/horizontal position does not need to be adjusted.\n  function calculateScrollPos(cm, rect) {\n    var display = cm.display, snapMargin = textHeight(cm.display);\n    if (rect.top < 0) { rect.top = 0; }\n    var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n    var screen = displayHeight(cm), result = {};\n    if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen; }\n    var docBottom = cm.doc.height + paddingVert(display);\n    var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin;\n    if (rect.top < screentop) {\n      result.scrollTop = atTop ? 0 : rect.top;\n    } else if (rect.bottom > screentop + screen) {\n      var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n      if (newTop != screentop) { result.scrollTop = newTop; }\n    }\n\n    var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n    var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0);\n    var tooWide = rect.right - rect.left > screenw;\n    if (tooWide) { rect.right = rect.left + screenw; }\n    if (rect.left < 10)\n      { result.scrollLeft = 0; }\n    else if (rect.left < screenleft)\n      { result.scrollLeft = Math.max(0, rect.left - (tooWide ? 0 : 10)); }\n    else if (rect.right > screenw + screenleft - 3)\n      { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw; }\n    return result\n  }\n\n  // Store a relative adjustment to the scroll position in the current\n  // operation (to be applied when the operation finishes).\n  function addToScrollTop(cm, top) {\n    if (top == null) { return }\n    resolveScrollToPos(cm);\n    cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n  }\n\n  // Make sure that at the end of the operation the current cursor is\n  // shown.\n  function ensureCursorVisible(cm) {\n    resolveScrollToPos(cm);\n    var cur = cm.getCursor();\n    cm.curOp.scrollToPos = {from: cur, to: cur, margin: cm.options.cursorScrollMargin};\n  }\n\n  function scrollToCoords(cm, x, y) {\n    if (x != null || y != null) { resolveScrollToPos(cm); }\n    if (x != null) { cm.curOp.scrollLeft = x; }\n    if (y != null) { cm.curOp.scrollTop = y; }\n  }\n\n  function scrollToRange(cm, range) {\n    resolveScrollToPos(cm);\n    cm.curOp.scrollToPos = range;\n  }\n\n  // When an operation has its scrollToPos property set, and another\n  // scroll action is applied before the end of the operation, this\n  // 'simulates' scrolling that position into view in a cheap way, so\n  // that the effect of intermediate scroll commands is not ignored.\n  function resolveScrollToPos(cm) {\n    var range = cm.curOp.scrollToPos;\n    if (range) {\n      cm.curOp.scrollToPos = null;\n      var from = estimateCoords(cm, range.from), to = estimateCoords(cm, range.to);\n      scrollToCoordsRange(cm, from, to, range.margin);\n    }\n  }\n\n  function scrollToCoordsRange(cm, from, to, margin) {\n    var sPos = calculateScrollPos(cm, {\n      left: Math.min(from.left, to.left),\n      top: Math.min(from.top, to.top) - margin,\n      right: Math.max(from.right, to.right),\n      bottom: Math.max(from.bottom, to.bottom) + margin\n    });\n    scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n  }\n\n  // Sync the scrollable area and scrollbars, ensure the viewport\n  // covers the visible area.\n  function updateScrollTop(cm, val) {\n    if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\n    if (!gecko) { updateDisplaySimple(cm, {top: val}); }\n    setScrollTop(cm, val, true);\n    if (gecko) { updateDisplaySimple(cm); }\n    startWorker(cm, 100);\n  }\n\n  function setScrollTop(cm, val, forceScroll) {\n    val = Math.max(0, Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val));\n    if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\n    cm.doc.scrollTop = val;\n    cm.display.scrollbars.setScrollTop(val);\n    if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val; }\n  }\n\n  // Sync scroller and scrollbar, ensure the gutter elements are\n  // aligned.\n  function setScrollLeft(cm, val, isScroller, forceScroll) {\n    val = Math.max(0, Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth));\n    if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\n    cm.doc.scrollLeft = val;\n    alignHorizontally(cm);\n    if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val; }\n    cm.display.scrollbars.setScrollLeft(val);\n  }\n\n  // SCROLLBARS\n\n  // Prepare DOM reads needed to update the scrollbars. Done in one\n  // shot to minimize update/measure roundtrips.\n  function measureForScrollbars(cm) {\n    var d = cm.display, gutterW = d.gutters.offsetWidth;\n    var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n    return {\n      clientHeight: d.scroller.clientHeight,\n      viewHeight: d.wrapper.clientHeight,\n      scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\n      viewWidth: d.wrapper.clientWidth,\n      barLeft: cm.options.fixedGutter ? gutterW : 0,\n      docHeight: docH,\n      scrollHeight: docH + scrollGap(cm) + d.barHeight,\n      nativeBarWidth: d.nativeBarWidth,\n      gutterWidth: gutterW\n    }\n  }\n\n  var NativeScrollbars = function(place, scroll, cm) {\n    this.cm = cm;\n    var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n    var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n    vert.tabIndex = horiz.tabIndex = -1;\n    place(vert); place(horiz);\n\n    on(vert, \"scroll\", function () {\n      if (vert.clientHeight) { scroll(vert.scrollTop, \"vertical\"); }\n    });\n    on(horiz, \"scroll\", function () {\n      if (horiz.clientWidth) { scroll(horiz.scrollLeft, \"horizontal\"); }\n    });\n\n    this.checkedZeroWidth = false;\n    // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n    if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\"; }\n  };\n\n  NativeScrollbars.prototype.update = function (measure) {\n    var needsH = measure.scrollWidth > measure.clientWidth + 1;\n    var needsV = measure.scrollHeight > measure.clientHeight + 1;\n    var sWidth = measure.nativeBarWidth;\n\n    if (needsV) {\n      this.vert.style.display = \"block\";\n      this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n      var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\n      // A bug in IE8 can cause this value to be negative, so guard it.\n      this.vert.firstChild.style.height =\n        Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n    } else {\n      this.vert.style.display = \"\";\n      this.vert.firstChild.style.height = \"0\";\n    }\n\n    if (needsH) {\n      this.horiz.style.display = \"block\";\n      this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n      this.horiz.style.left = measure.barLeft + \"px\";\n      var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n      this.horiz.firstChild.style.width =\n        Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n    } else {\n      this.horiz.style.display = \"\";\n      this.horiz.firstChild.style.width = \"0\";\n    }\n\n    if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n      if (sWidth == 0) { this.zeroWidthHack(); }\n      this.checkedZeroWidth = true;\n    }\n\n    return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\n  };\n\n  NativeScrollbars.prototype.setScrollLeft = function (pos) {\n    if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos; }\n    if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\"); }\n  };\n\n  NativeScrollbars.prototype.setScrollTop = function (pos) {\n    if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos; }\n    if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\"); }\n  };\n\n  NativeScrollbars.prototype.zeroWidthHack = function () {\n    var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n    this.horiz.style.height = this.vert.style.width = w;\n    this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\";\n    this.disableHoriz = new Delayed;\n    this.disableVert = new Delayed;\n  };\n\n  NativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n    bar.style.pointerEvents = \"auto\";\n    function maybeDisable() {\n      // To find out whether the scrollbar is still visible, we\n      // check whether the element under the pixel in the bottom\n      // right corner of the scrollbar box is the scrollbar box\n      // itself (when the bar is still visible) or its filler child\n      // (when the bar is hidden). If it is still visible, we keep\n      // it enabled, if it's hidden, we disable pointer events.\n      var box = bar.getBoundingClientRect();\n      var elt = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\n          : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n      if (elt != bar) { bar.style.pointerEvents = \"none\"; }\n      else { delay.set(1000, maybeDisable); }\n    }\n    delay.set(1000, maybeDisable);\n  };\n\n  NativeScrollbars.prototype.clear = function () {\n    var parent = this.horiz.parentNode;\n    parent.removeChild(this.horiz);\n    parent.removeChild(this.vert);\n  };\n\n  var NullScrollbars = function () {};\n\n  NullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\n  NullScrollbars.prototype.setScrollLeft = function () {};\n  NullScrollbars.prototype.setScrollTop = function () {};\n  NullScrollbars.prototype.clear = function () {};\n\n  function updateScrollbars(cm, measure) {\n    if (!measure) { measure = measureForScrollbars(cm); }\n    var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\n    updateScrollbarsInner(cm, measure);\n    for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n      if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\n        { updateHeightsInViewport(cm); }\n      updateScrollbarsInner(cm, measureForScrollbars(cm));\n      startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\n    }\n  }\n\n  // Re-synchronize the fake scrollbars with the actual size of the\n  // content.\n  function updateScrollbarsInner(cm, measure) {\n    var d = cm.display;\n    var sizes = d.scrollbars.update(measure);\n\n    d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n    d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n    d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n    if (sizes.right && sizes.bottom) {\n      d.scrollbarFiller.style.display = \"block\";\n      d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n      d.scrollbarFiller.style.width = sizes.right + \"px\";\n    } else { d.scrollbarFiller.style.display = \"\"; }\n    if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n      d.gutterFiller.style.display = \"block\";\n      d.gutterFiller.style.height = sizes.bottom + \"px\";\n      d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n    } else { d.gutterFiller.style.display = \"\"; }\n  }\n\n  var scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars};\n\n  function initScrollbars(cm) {\n    if (cm.display.scrollbars) {\n      cm.display.scrollbars.clear();\n      if (cm.display.scrollbars.addClass)\n        { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n    }\n\n    cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n      cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\n      // Prevent clicks in the scrollbars from killing focus\n      on(node, \"mousedown\", function () {\n        if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0); }\n      });\n      node.setAttribute(\"cm-not-content\", \"true\");\n    }, function (pos, axis) {\n      if (axis == \"horizontal\") { setScrollLeft(cm, pos); }\n      else { updateScrollTop(cm, pos); }\n    }, cm);\n    if (cm.display.scrollbars.addClass)\n      { addClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n  }\n\n  // Operations are used to wrap a series of changes to the editor\n  // state in such a way that each change won't have to update the\n  // cursor and display (which would be awkward, slow, and\n  // error-prone). Instead, display updates are batched and then all\n  // combined and executed at once.\n\n  var nextOpId = 0;\n  // Start a new operation.\n  function startOperation(cm) {\n    cm.curOp = {\n      cm: cm,\n      viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n      startHeight: cm.doc.height, // Used to detect need to update scrollbar\n      forceUpdate: false,      // Used to force a redraw\n      updateInput: 0,       // Whether to reset the input textarea\n      typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n      changeObjs: null,        // Accumulated changes, for firing change events\n      cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n      cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n      selectionChanged: false, // Whether the selection needs to be redrawn\n      updateMaxLine: false,    // Set when the widest line needs to be determined anew\n      scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n      scrollToPos: null,       // Used to scroll to a specific position\n      focus: false,\n      id: ++nextOpId           // Unique ID\n    };\n    pushOperation(cm.curOp);\n  }\n\n  // Finish an operation, updating the display and signalling delayed events\n  function endOperation(cm) {\n    var op = cm.curOp;\n    if (op) { finishOperation(op, function (group) {\n      for (var i = 0; i < group.ops.length; i++)\n        { group.ops[i].cm.curOp = null; }\n      endOperations(group);\n    }); }\n  }\n\n  // The DOM updates done when an operation finishes are batched so\n  // that the minimum number of relayouts are required.\n  function endOperations(group) {\n    var ops = group.ops;\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      { endOperation_R1(ops[i]); }\n    for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n      { endOperation_W1(ops[i$1]); }\n    for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n      { endOperation_R2(ops[i$2]); }\n    for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n      { endOperation_W2(ops[i$3]); }\n    for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n      { endOperation_finish(ops[i$4]); }\n  }\n\n  function endOperation_R1(op) {\n    var cm = op.cm, display = cm.display;\n    maybeClipScrollbars(cm);\n    if (op.updateMaxLine) { findMaxLine(cm); }\n\n    op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n      op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                         op.scrollToPos.to.line >= display.viewTo) ||\n      display.maxLineChanged && cm.options.lineWrapping;\n    op.update = op.mustUpdate &&\n      new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n  }\n\n  function endOperation_W1(op) {\n    op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n  }\n\n  function endOperation_R2(op) {\n    var cm = op.cm, display = cm.display;\n    if (op.updatedDisplay) { updateHeightsInViewport(cm); }\n\n    op.barMeasure = measureForScrollbars(cm);\n\n    // If the max line changed since it was last measured, measure it,\n    // and ensure the document's width matches it.\n    // updateDisplay_W2 will use these properties to do the actual resizing\n    if (display.maxLineChanged && !cm.options.lineWrapping) {\n      op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n      cm.display.sizerWidth = op.adjustWidthTo;\n      op.barMeasure.scrollWidth =\n        Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n      op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n    }\n\n    if (op.updatedDisplay || op.selectionChanged)\n      { op.preparedSelection = display.input.prepareSelection(); }\n  }\n\n  function endOperation_W2(op) {\n    var cm = op.cm;\n\n    if (op.adjustWidthTo != null) {\n      cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n      if (op.maxScrollLeft < cm.doc.scrollLeft)\n        { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true); }\n      cm.display.maxLineChanged = false;\n    }\n\n    var takeFocus = op.focus && op.focus == activeElt();\n    if (op.preparedSelection)\n      { cm.display.input.showSelection(op.preparedSelection, takeFocus); }\n    if (op.updatedDisplay || op.startHeight != cm.doc.height)\n      { updateScrollbars(cm, op.barMeasure); }\n    if (op.updatedDisplay)\n      { setDocumentHeight(cm, op.barMeasure); }\n\n    if (op.selectionChanged) { restartBlink(cm); }\n\n    if (cm.state.focused && op.updateInput)\n      { cm.display.input.reset(op.typing); }\n    if (takeFocus) { ensureFocus(op.cm); }\n  }\n\n  function endOperation_finish(op) {\n    var cm = op.cm, display = cm.display, doc = cm.doc;\n\n    if (op.updatedDisplay) { postUpdateDisplay(cm, op.update); }\n\n    // Abort mouse wheel delta measurement, when scrolling explicitly\n    if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n      { display.wheelStartX = display.wheelStartY = null; }\n\n    // Propagate the scroll position to the actual DOM scroller\n    if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll); }\n\n    if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true); }\n    // If we need to scroll a specific position into view, do so.\n    if (op.scrollToPos) {\n      var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                   clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n      maybeScrollWindow(cm, rect);\n    }\n\n    // Fire events for markers that are hidden/unidden by editing or\n    // undoing\n    var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n    if (hidden) { for (var i = 0; i < hidden.length; ++i)\n      { if (!hidden[i].lines.length) { signal(hidden[i], \"hide\"); } } }\n    if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\n      { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], \"unhide\"); } } }\n\n    if (display.wrapper.offsetHeight)\n      { doc.scrollTop = cm.display.scroller.scrollTop; }\n\n    // Fire change events, and delayed event handlers\n    if (op.changeObjs)\n      { signal(cm, \"changes\", cm, op.changeObjs); }\n    if (op.update)\n      { op.update.finish(); }\n  }\n\n  // Run the given function in an operation\n  function runInOp(cm, f) {\n    if (cm.curOp) { return f() }\n    startOperation(cm);\n    try { return f() }\n    finally { endOperation(cm); }\n  }\n  // Wraps a function in an operation. Returns the wrapped function.\n  function operation(cm, f) {\n    return function() {\n      if (cm.curOp) { return f.apply(cm, arguments) }\n      startOperation(cm);\n      try { return f.apply(cm, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n  // Used to add methods to editor and doc instances, wrapping them in\n  // operations.\n  function methodOp(f) {\n    return function() {\n      if (this.curOp) { return f.apply(this, arguments) }\n      startOperation(this);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(this); }\n    }\n  }\n  function docMethodOp(f) {\n    return function() {\n      var cm = this.cm;\n      if (!cm || cm.curOp) { return f.apply(this, arguments) }\n      startOperation(cm);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n\n  // HIGHLIGHT WORKER\n\n  function startWorker(cm, time) {\n    if (cm.doc.highlightFrontier < cm.display.viewTo)\n      { cm.state.highlight.set(time, bind(highlightWorker, cm)); }\n  }\n\n  function highlightWorker(cm) {\n    var doc = cm.doc;\n    if (doc.highlightFrontier >= cm.display.viewTo) { return }\n    var end = +new Date + cm.options.workTime;\n    var context = getContextBefore(cm, doc.highlightFrontier);\n    var changedLines = [];\n\n    doc.iter(context.line, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n      if (context.line >= cm.display.viewFrom) { // Visible\n        var oldStyles = line.styles;\n        var resetState = line.text.length > cm.options.maxHighlightLength ? copyState(doc.mode, context.state) : null;\n        var highlighted = highlightLine(cm, line, context, true);\n        if (resetState) { context.state = resetState; }\n        line.styles = highlighted.styles;\n        var oldCls = line.styleClasses, newCls = highlighted.classes;\n        if (newCls) { line.styleClasses = newCls; }\n        else if (oldCls) { line.styleClasses = null; }\n        var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n          oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n        for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i]; }\n        if (ischange) { changedLines.push(context.line); }\n        line.stateAfter = context.save();\n        context.nextLine();\n      } else {\n        if (line.text.length <= cm.options.maxHighlightLength)\n          { processLine(cm, line.text, context); }\n        line.stateAfter = context.line % 5 == 0 ? context.save() : null;\n        context.nextLine();\n      }\n      if (+new Date > end) {\n        startWorker(cm, cm.options.workDelay);\n        return true\n      }\n    });\n    doc.highlightFrontier = context.line;\n    doc.modeFrontier = Math.max(doc.modeFrontier, context.line);\n    if (changedLines.length) { runInOp(cm, function () {\n      for (var i = 0; i < changedLines.length; i++)\n        { regLineChange(cm, changedLines[i], \"text\"); }\n    }); }\n  }\n\n  // DISPLAY DRAWING\n\n  var DisplayUpdate = function(cm, viewport, force) {\n    var display = cm.display;\n\n    this.viewport = viewport;\n    // Store some values that we'll need later (but don't want to force a relayout for)\n    this.visible = visibleLines(display, cm.doc, viewport);\n    this.editorIsHidden = !display.wrapper.offsetWidth;\n    this.wrapperHeight = display.wrapper.clientHeight;\n    this.wrapperWidth = display.wrapper.clientWidth;\n    this.oldDisplayWidth = displayWidth(cm);\n    this.force = force;\n    this.dims = getDimensions(cm);\n    this.events = [];\n  };\n\n  DisplayUpdate.prototype.signal = function (emitter, type) {\n    if (hasHandler(emitter, type))\n      { this.events.push(arguments); }\n  };\n  DisplayUpdate.prototype.finish = function () {\n    for (var i = 0; i < this.events.length; i++)\n      { signal.apply(null, this.events[i]); }\n  };\n\n  function maybeClipScrollbars(cm) {\n    var display = cm.display;\n    if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n      display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n      display.heightForcer.style.height = scrollGap(cm) + \"px\";\n      display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n      display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n      display.scrollbarsClipped = true;\n    }\n  }\n\n  function selectionSnapshot(cm) {\n    if (cm.hasFocus()) { return null }\n    var active = activeElt();\n    if (!active || !contains(cm.display.lineDiv, active)) { return null }\n    var result = {activeElt: active};\n    if (window.getSelection) {\n      var sel = window.getSelection();\n      if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n        result.anchorNode = sel.anchorNode;\n        result.anchorOffset = sel.anchorOffset;\n        result.focusNode = sel.focusNode;\n        result.focusOffset = sel.focusOffset;\n      }\n    }\n    return result\n  }\n\n  function restoreSelection(snapshot) {\n    if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) { return }\n    snapshot.activeElt.focus();\n    if (snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n      var sel = window.getSelection(), range = document.createRange();\n      range.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n      range.collapse(false);\n      sel.removeAllRanges();\n      sel.addRange(range);\n      sel.extend(snapshot.focusNode, snapshot.focusOffset);\n    }\n  }\n\n  // Does the actual updating of the line display. Bails out\n  // (returning false) when there is nothing to be done and forced is\n  // false.\n  function updateDisplayIfNeeded(cm, update) {\n    var display = cm.display, doc = cm.doc;\n\n    if (update.editorIsHidden) {\n      resetView(cm);\n      return false\n    }\n\n    // Bail out if the visible area is already rendered and nothing changed.\n    if (!update.force &&\n        update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n        display.renderedView == display.view && countDirtyView(cm) == 0)\n      { return false }\n\n    if (maybeUpdateLineNumberWidth(cm)) {\n      resetView(cm);\n      update.dims = getDimensions(cm);\n    }\n\n    // Compute a suitable new viewport (from & to)\n    var end = doc.first + doc.size;\n    var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n    var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n    if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom); }\n    if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo); }\n    if (sawCollapsedSpans) {\n      from = visualLineNo(cm.doc, from);\n      to = visualLineEndNo(cm.doc, to);\n    }\n\n    var different = from != display.viewFrom || to != display.viewTo ||\n      display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n    adjustView(cm, from, to);\n\n    display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n    // Position the mover div to align with the current scroll position\n    cm.display.mover.style.top = display.viewOffset + \"px\";\n\n    var toUpdate = countDirtyView(cm);\n    if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n      { return false }\n\n    // For big changes, we hide the enclosing element during the\n    // update, since that speeds up the operations on most browsers.\n    var selSnapshot = selectionSnapshot(cm);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"none\"; }\n    patchDisplay(cm, display.updateLineNumbers, update.dims);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"\"; }\n    display.renderedView = display.view;\n    // There might have been a widget with a focused element that got\n    // hidden or updated, if so re-focus it.\n    restoreSelection(selSnapshot);\n\n    // Prevent selection and cursors from interfering with the scroll\n    // width and height.\n    removeChildren(display.cursorDiv);\n    removeChildren(display.selectionDiv);\n    display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n    if (different) {\n      display.lastWrapHeight = update.wrapperHeight;\n      display.lastWrapWidth = update.wrapperWidth;\n      startWorker(cm, 400);\n    }\n\n    display.updateLineNumbers = null;\n\n    return true\n  }\n\n  function postUpdateDisplay(cm, update) {\n    var viewport = update.viewport;\n\n    for (var first = true;; first = false) {\n      if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n        // Clip forced viewport to actual scrollable area.\n        if (viewport && viewport.top != null)\n          { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)}; }\n        // Updated line heights might result in the drawn area not\n        // actually covering the viewport. Keep looping until it does.\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n        if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n          { break }\n      } else if (first) {\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n      }\n      if (!updateDisplayIfNeeded(cm, update)) { break }\n      updateHeightsInViewport(cm);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.force = false;\n    }\n\n    update.signal(cm, \"update\", cm);\n    if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n      update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n      cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\n    }\n  }\n\n  function updateDisplaySimple(cm, viewport) {\n    var update = new DisplayUpdate(cm, viewport);\n    if (updateDisplayIfNeeded(cm, update)) {\n      updateHeightsInViewport(cm);\n      postUpdateDisplay(cm, update);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.finish();\n    }\n  }\n\n  // Sync the actual display DOM structure with display.view, removing\n  // nodes for lines that are no longer in view, and creating the ones\n  // that are not there yet, and updating the ones that are out of\n  // date.\n  function patchDisplay(cm, updateNumbersFrom, dims) {\n    var display = cm.display, lineNumbers = cm.options.lineNumbers;\n    var container = display.lineDiv, cur = container.firstChild;\n\n    function rm(node) {\n      var next = node.nextSibling;\n      // Works around a throw-scroll bug in OS X Webkit\n      if (webkit && mac && cm.display.currentWheelTarget == node)\n        { node.style.display = \"none\"; }\n      else\n        { node.parentNode.removeChild(node); }\n      return next\n    }\n\n    var view = display.view, lineN = display.viewFrom;\n    // Loop over the elements in the view, syncing cur (the DOM nodes\n    // in display.lineDiv) with the view as we go.\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (lineView.hidden) ; else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\n        var node = buildLineElement(cm, lineView, lineN, dims);\n        container.insertBefore(node, cur);\n      } else { // Already drawn\n        while (cur != lineView.node) { cur = rm(cur); }\n        var updateNumber = lineNumbers && updateNumbersFrom != null &&\n          updateNumbersFrom <= lineN && lineView.lineNumber;\n        if (lineView.changes) {\n          if (indexOf(lineView.changes, \"gutter\") > -1) { updateNumber = false; }\n          updateLineForChanges(cm, lineView, lineN, dims);\n        }\n        if (updateNumber) {\n          removeChildren(lineView.lineNumber);\n          lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n        }\n        cur = lineView.node.nextSibling;\n      }\n      lineN += lineView.size;\n    }\n    while (cur) { cur = rm(cur); }\n  }\n\n  function updateGutterSpace(display) {\n    var width = display.gutters.offsetWidth;\n    display.sizer.style.marginLeft = width + \"px\";\n  }\n\n  function setDocumentHeight(cm, measure) {\n    cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n    cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n    cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + \"px\";\n  }\n\n  // Re-align line numbers and gutter marks to compensate for\n  // horizontal scrolling.\n  function alignHorizontally(cm) {\n    var display = cm.display, view = display.view;\n    if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\n    var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n    var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n    for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\n      if (cm.options.fixedGutter) {\n        if (view[i].gutter)\n          { view[i].gutter.style.left = left; }\n        if (view[i].gutterBackground)\n          { view[i].gutterBackground.style.left = left; }\n      }\n      var align = view[i].alignable;\n      if (align) { for (var j = 0; j < align.length; j++)\n        { align[j].style.left = left; } }\n    } }\n    if (cm.options.fixedGutter)\n      { display.gutters.style.left = (comp + gutterW) + \"px\"; }\n  }\n\n  // Used to ensure that the line number gutter is still the right\n  // size for the current document size. Returns true when an update\n  // is needed.\n  function maybeUpdateLineNumberWidth(cm) {\n    if (!cm.options.lineNumbers) { return false }\n    var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n    if (last.length != display.lineNumChars) {\n      var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                                 \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n      var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n      display.lineGutter.style.width = \"\";\n      display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n      display.lineNumWidth = display.lineNumInnerWidth + padding;\n      display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n      display.lineGutter.style.width = display.lineNumWidth + \"px\";\n      updateGutterSpace(cm.display);\n      return true\n    }\n    return false\n  }\n\n  function getGutters(gutters, lineNumbers) {\n    var result = [], sawLineNumbers = false;\n    for (var i = 0; i < gutters.length; i++) {\n      var name = gutters[i], style = null;\n      if (typeof name != \"string\") { style = name.style; name = name.className; }\n      if (name == \"CodeMirror-linenumbers\") {\n        if (!lineNumbers) { continue }\n        else { sawLineNumbers = true; }\n      }\n      result.push({className: name, style: style});\n    }\n    if (lineNumbers && !sawLineNumbers) { result.push({className: \"CodeMirror-linenumbers\", style: null}); }\n    return result\n  }\n\n  // Rebuild the gutter elements, ensure the margin to the left of the\n  // code matches their width.\n  function renderGutters(display) {\n    var gutters = display.gutters, specs = display.gutterSpecs;\n    removeChildren(gutters);\n    display.lineGutter = null;\n    for (var i = 0; i < specs.length; ++i) {\n      var ref = specs[i];\n      var className = ref.className;\n      var style = ref.style;\n      var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + className));\n      if (style) { gElt.style.cssText = style; }\n      if (className == \"CodeMirror-linenumbers\") {\n        display.lineGutter = gElt;\n        gElt.style.width = (display.lineNumWidth || 1) + \"px\";\n      }\n    }\n    gutters.style.display = specs.length ? \"\" : \"none\";\n    updateGutterSpace(display);\n  }\n\n  function updateGutters(cm) {\n    renderGutters(cm.display);\n    regChange(cm);\n    alignHorizontally(cm);\n  }\n\n  // The display handles the DOM integration, both for input reading\n  // and content drawing. It holds references to DOM nodes and\n  // display-related state.\n\n  function Display(place, doc, input, options) {\n    var d = this;\n    this.input = input;\n\n    // Covers bottom-right square when both scrollbars are present.\n    d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n    d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Covers bottom of gutter when coverGutterNextToScrollbar is on\n    // and h scrollbar is present.\n    d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n    d.gutterFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Will contain the actual code, positioned to cover the viewport.\n    d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\");\n    // Elements are added to these to represent selection and cursors.\n    d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n    d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n    // A visibility: hidden element used to find the size of things.\n    d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n    // When lines outside of the viewport are measured, they are drawn in this.\n    d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n    // Wraps everything that needs to exist inside the vertically-padded coordinate system\n    d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                      null, \"position: relative; outline: none\");\n    var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\");\n    // Moved around its parent to cover visible view.\n    d.mover = elt(\"div\", [lines], null, \"position: relative\");\n    // Set to the height of the document, allowing scrolling.\n    d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n    d.sizerWidth = null;\n    // Behavior of elts with overflow: auto and padding is\n    // inconsistent across browsers. This is used to ensure the\n    // scrollable area is big enough.\n    d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\");\n    // Will contain the gutters, if any.\n    d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n    d.lineGutter = null;\n    // Actual scrollable element.\n    d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n    d.scroller.setAttribute(\"tabIndex\", \"-1\");\n    // The element in which the editor lives.\n    d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n\n    // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n    if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n    if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true; }\n\n    if (place) {\n      if (place.appendChild) { place.appendChild(d.wrapper); }\n      else { place(d.wrapper); }\n    }\n\n    // Current rendered range (may be bigger than the view window).\n    d.viewFrom = d.viewTo = doc.first;\n    d.reportedViewFrom = d.reportedViewTo = doc.first;\n    // Information about the rendered lines.\n    d.view = [];\n    d.renderedView = null;\n    // Holds info about a single rendered line when it was rendered\n    // for measurement, while not in view.\n    d.externalMeasured = null;\n    // Empty space (in pixels) above the view\n    d.viewOffset = 0;\n    d.lastWrapHeight = d.lastWrapWidth = 0;\n    d.updateLineNumbers = null;\n\n    d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n    d.scrollbarsClipped = false;\n\n    // Used to only resize the line number gutter when necessary (when\n    // the amount of lines crosses a boundary that makes its width change)\n    d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n    // Set to true when a non-horizontal-scrolling line widget is\n    // added. As an optimization, line widget aligning is skipped when\n    // this is false.\n    d.alignWidgets = false;\n\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n    // Tracks the maximum line length so that the horizontal scrollbar\n    // can be kept static when scrolling.\n    d.maxLine = null;\n    d.maxLineLength = 0;\n    d.maxLineChanged = false;\n\n    // Used for measuring wheel scrolling granularity\n    d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n    // True when shift is held down.\n    d.shift = false;\n\n    // Used to track whether anything happened since the context menu\n    // was opened.\n    d.selForContextMenu = null;\n\n    d.activeTouch = null;\n\n    d.gutterSpecs = getGutters(options.gutters, options.lineNumbers);\n    renderGutters(d);\n\n    input.init(d);\n  }\n\n  // Since the delta values reported on mouse wheel events are\n  // unstandardized between browsers and even browser versions, and\n  // generally horribly unpredictable, this code starts by measuring\n  // the scroll effect that the first few mouse wheel events have,\n  // and, from that, detects the way it can convert deltas to pixel\n  // offsets afterwards.\n  //\n  // The reason we want to know the amount a wheel event will scroll\n  // is that it gives us a chance to update the display before the\n  // actual scrolling happens, reducing flickering.\n\n  var wheelSamples = 0, wheelPixelsPerUnit = null;\n  // Fill in a browser-detected starting value on browsers where we\n  // know one. These don't have to be accurate -- the result of them\n  // being wrong would just be a slight flicker on the first wheel\n  // scroll (if it is large enough).\n  if (ie) { wheelPixelsPerUnit = -.53; }\n  else if (gecko) { wheelPixelsPerUnit = 15; }\n  else if (chrome) { wheelPixelsPerUnit = -.7; }\n  else if (safari) { wheelPixelsPerUnit = -1/3; }\n\n  function wheelEventDelta(e) {\n    var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail; }\n    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail; }\n    else if (dy == null) { dy = e.wheelDelta; }\n    return {x: dx, y: dy}\n  }\n  function wheelEventPixels(e) {\n    var delta = wheelEventDelta(e);\n    delta.x *= wheelPixelsPerUnit;\n    delta.y *= wheelPixelsPerUnit;\n    return delta\n  }\n\n  function onScrollWheel(cm, e) {\n    var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\n\n    var display = cm.display, scroll = display.scroller;\n    // Quit if there's nothing to scroll here\n    var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n    var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n    if (!(dx && canScrollX || dy && canScrollY)) { return }\n\n    // Webkit browsers on OS X abort momentum scrolls when the target\n    // of the scroll event is removed from the scrollable element.\n    // This hack (see related code in patchDisplay) makes sure the\n    // element is kept around.\n    if (dy && mac && webkit) {\n      outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n        for (var i = 0; i < view.length; i++) {\n          if (view[i].node == cur) {\n            cm.display.currentWheelTarget = cur;\n            break outer\n          }\n        }\n      }\n    }\n\n    // On some browsers, horizontal scrolling will cause redraws to\n    // happen before the gutter has been realigned, causing it to\n    // wriggle around in a most unseemly way. When we have an\n    // estimated pixels/delta value, we just handle horizontal\n    // scrolling entirely here. It'll be slightly off from native, but\n    // better than glitching out.\n    if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n      if (dy && canScrollY)\n        { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit)); }\n      setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit));\n      // Only prevent default scrolling if vertical scrolling is\n      // actually possible. Otherwise, it causes vertical scroll\n      // jitter on OSX trackpads when deltaX is small and deltaY\n      // is large (issue #3579)\n      if (!dy || (dy && canScrollY))\n        { e_preventDefault(e); }\n      display.wheelStartX = null; // Abort measurement, if in progress\n      return\n    }\n\n    // 'Project' the visible viewport to cover the area that is being\n    // scrolled into view (if we know enough to estimate it).\n    if (dy && wheelPixelsPerUnit != null) {\n      var pixels = dy * wheelPixelsPerUnit;\n      var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n      if (pixels < 0) { top = Math.max(0, top + pixels - 50); }\n      else { bot = Math.min(cm.doc.height, bot + pixels + 50); }\n      updateDisplaySimple(cm, {top: top, bottom: bot});\n    }\n\n    if (wheelSamples < 20) {\n      if (display.wheelStartX == null) {\n        display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n        display.wheelDX = dx; display.wheelDY = dy;\n        setTimeout(function () {\n          if (display.wheelStartX == null) { return }\n          var movedX = scroll.scrollLeft - display.wheelStartX;\n          var movedY = scroll.scrollTop - display.wheelStartY;\n          var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n            (movedX && display.wheelDX && movedX / display.wheelDX);\n          display.wheelStartX = display.wheelStartY = null;\n          if (!sample) { return }\n          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n          ++wheelSamples;\n        }, 200);\n      } else {\n        display.wheelDX += dx; display.wheelDY += dy;\n      }\n    }\n  }\n\n  // Selection objects are immutable. A new one is created every time\n  // the selection changes. A selection is one or more non-overlapping\n  // (and non-touching) ranges, sorted, and an integer that indicates\n  // which one is the primary selection (the one that's scrolled into\n  // view, that getCursor returns, etc).\n  var Selection = function(ranges, primIndex) {\n    this.ranges = ranges;\n    this.primIndex = primIndex;\n  };\n\n  Selection.prototype.primary = function () { return this.ranges[this.primIndex] };\n\n  Selection.prototype.equals = function (other) {\n    if (other == this) { return true }\n    if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var here = this.ranges[i], there = other.ranges[i];\n      if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\n    }\n    return true\n  };\n\n  Selection.prototype.deepCopy = function () {\n    var out = [];\n    for (var i = 0; i < this.ranges.length; i++)\n      { out[i] = new Range(copyPos(this.ranges[i].anchor), copyPos(this.ranges[i].head)); }\n    return new Selection(out, this.primIndex)\n  };\n\n  Selection.prototype.somethingSelected = function () {\n    for (var i = 0; i < this.ranges.length; i++)\n      { if (!this.ranges[i].empty()) { return true } }\n    return false\n  };\n\n  Selection.prototype.contains = function (pos, end) {\n    if (!end) { end = pos; }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var range = this.ranges[i];\n      if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n        { return i }\n    }\n    return -1\n  };\n\n  var Range = function(anchor, head) {\n    this.anchor = anchor; this.head = head;\n  };\n\n  Range.prototype.from = function () { return minPos(this.anchor, this.head) };\n  Range.prototype.to = function () { return maxPos(this.anchor, this.head) };\n  Range.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\n\n  // Take an unsorted, potentially overlapping set of ranges, and\n  // build a selection out of it. 'Consumes' ranges array (modifying\n  // it).\n  function normalizeSelection(cm, ranges, primIndex) {\n    var mayTouch = cm && cm.options.selectionsMayTouch;\n    var prim = ranges[primIndex];\n    ranges.sort(function (a, b) { return cmp(a.from(), b.from()); });\n    primIndex = indexOf(ranges, prim);\n    for (var i = 1; i < ranges.length; i++) {\n      var cur = ranges[i], prev = ranges[i - 1];\n      var diff = cmp(prev.to(), cur.from());\n      if (mayTouch && !cur.empty() ? diff > 0 : diff >= 0) {\n        var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n        var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n        if (i <= primIndex) { --primIndex; }\n        ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n      }\n    }\n    return new Selection(ranges, primIndex)\n  }\n\n  function simpleSelection(anchor, head) {\n    return new Selection([new Range(anchor, head || anchor)], 0)\n  }\n\n  // Compute the position of the end of a change (its 'to' property\n  // refers to the pre-change end).\n  function changeEnd(change) {\n    if (!change.text) { return change.to }\n    return Pos(change.from.line + change.text.length - 1,\n               lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\n  }\n\n  // Adjust a position to refer to the post-change position of the\n  // same text, or the end of the change if the change covers it.\n  function adjustForChange(pos, change) {\n    if (cmp(pos, change.from) < 0) { return pos }\n    if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\n\n    var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n    if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch; }\n    return Pos(line, ch)\n  }\n\n  function computeSelAfterChange(doc, change) {\n    var out = [];\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      var range = doc.sel.ranges[i];\n      out.push(new Range(adjustForChange(range.anchor, change),\n                         adjustForChange(range.head, change)));\n    }\n    return normalizeSelection(doc.cm, out, doc.sel.primIndex)\n  }\n\n  function offsetPos(pos, old, nw) {\n    if (pos.line == old.line)\n      { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\n    else\n      { return Pos(nw.line + (pos.line - old.line), pos.ch) }\n  }\n\n  // Used by replaceSelections to allow moving the selection to the\n  // start or around the replaced test. Hint may be \"start\" or \"around\".\n  function computeReplacedSel(doc, changes, hint) {\n    var out = [];\n    var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n    for (var i = 0; i < changes.length; i++) {\n      var change = changes[i];\n      var from = offsetPos(change.from, oldPrev, newPrev);\n      var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n      oldPrev = change.to;\n      newPrev = to;\n      if (hint == \"around\") {\n        var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n        out[i] = new Range(inv ? to : from, inv ? from : to);\n      } else {\n        out[i] = new Range(from, from);\n      }\n    }\n    return new Selection(out, doc.sel.primIndex)\n  }\n\n  // Used to get the editor into a consistent state again when options change.\n\n  function loadMode(cm) {\n    cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n    resetModeState(cm);\n  }\n\n  function resetModeState(cm) {\n    cm.doc.iter(function (line) {\n      if (line.stateAfter) { line.stateAfter = null; }\n      if (line.styles) { line.styles = null; }\n    });\n    cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first;\n    startWorker(cm, 100);\n    cm.state.modeGen++;\n    if (cm.curOp) { regChange(cm); }\n  }\n\n  // DOCUMENT DATA STRUCTURE\n\n  // By default, updates that start and end at the beginning of a line\n  // are treated specially, in order to make the association of line\n  // widgets and marker elements with the text behave more intuitive.\n  function isWholeLineUpdate(doc, change) {\n    return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n      (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\n  }\n\n  // Perform a change on the document data structure.\n  function updateDoc(doc, change, markedSpans, estimateHeight) {\n    function spansFor(n) {return markedSpans ? markedSpans[n] : null}\n    function update(line, text, spans) {\n      updateLine(line, text, spans, estimateHeight);\n      signalLater(line, \"change\", line, change);\n    }\n    function linesFor(start, end) {\n      var result = [];\n      for (var i = start; i < end; ++i)\n        { result.push(new Line(text[i], spansFor(i), estimateHeight)); }\n      return result\n    }\n\n    var from = change.from, to = change.to, text = change.text;\n    var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n    var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n    // Adjust the line structure\n    if (change.full) {\n      doc.insert(0, linesFor(0, text.length));\n      doc.remove(text.length, doc.size - text.length);\n    } else if (isWholeLineUpdate(doc, change)) {\n      // This is a whole-line replace. Treated specially to make\n      // sure line objects move the way they are supposed to.\n      var added = linesFor(0, text.length - 1);\n      update(lastLine, lastLine.text, lastSpans);\n      if (nlines) { doc.remove(from.line, nlines); }\n      if (added.length) { doc.insert(from.line, added); }\n    } else if (firstLine == lastLine) {\n      if (text.length == 1) {\n        update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n      } else {\n        var added$1 = linesFor(1, text.length - 1);\n        added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight));\n        update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n        doc.insert(from.line + 1, added$1);\n      }\n    } else if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n      doc.remove(from.line + 1, nlines);\n    } else {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n      var added$2 = linesFor(1, text.length - 1);\n      if (nlines > 1) { doc.remove(from.line + 1, nlines - 1); }\n      doc.insert(from.line + 1, added$2);\n    }\n\n    signalLater(doc, \"change\", doc, change);\n  }\n\n  // Call f for all linked documents.\n  function linkedDocs(doc, f, sharedHistOnly) {\n    function propagate(doc, skip, sharedHist) {\n      if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\n        var rel = doc.linked[i];\n        if (rel.doc == skip) { continue }\n        var shared = sharedHist && rel.sharedHist;\n        if (sharedHistOnly && !shared) { continue }\n        f(rel.doc, shared);\n        propagate(rel.doc, doc, shared);\n      } }\n    }\n    propagate(doc, null, true);\n  }\n\n  // Attach a document to an editor.\n  function attachDoc(cm, doc) {\n    if (doc.cm) { throw new Error(\"This document is already in use.\") }\n    cm.doc = doc;\n    doc.cm = cm;\n    estimateLineHeights(cm);\n    loadMode(cm);\n    setDirectionClass(cm);\n    if (!cm.options.lineWrapping) { findMaxLine(cm); }\n    cm.options.mode = doc.modeOption;\n    regChange(cm);\n  }\n\n  function setDirectionClass(cm) {\n  (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n  }\n\n  function directionChanged(cm) {\n    runInOp(cm, function () {\n      setDirectionClass(cm);\n      regChange(cm);\n    });\n  }\n\n  function History(startGen) {\n    // Arrays of change events and selections. Doing something adds an\n    // event to done and clears undo. Undoing moves events from done\n    // to undone, redoing moves them in the other direction.\n    this.done = []; this.undone = [];\n    this.undoDepth = Infinity;\n    // Used to track when changes can be merged into a single undo\n    // event\n    this.lastModTime = this.lastSelTime = 0;\n    this.lastOp = this.lastSelOp = null;\n    this.lastOrigin = this.lastSelOrigin = null;\n    // Used by the isClean() method\n    this.generation = this.maxGeneration = startGen || 1;\n  }\n\n  // Create a history change event from an updateDoc-style change\n  // object.\n  function historyChangeFromChange(doc, change) {\n    var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n    attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n    linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true);\n    return histChange\n  }\n\n  // Pop all selection events off the end of a history array. Stop at\n  // a change event.\n  function clearSelectionEvents(array) {\n    while (array.length) {\n      var last = lst(array);\n      if (last.ranges) { array.pop(); }\n      else { break }\n    }\n  }\n\n  // Find the top change event in the history. Pop off selection\n  // events that are in the way.\n  function lastChangeEvent(hist, force) {\n    if (force) {\n      clearSelectionEvents(hist.done);\n      return lst(hist.done)\n    } else if (hist.done.length && !lst(hist.done).ranges) {\n      return lst(hist.done)\n    } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n      hist.done.pop();\n      return lst(hist.done)\n    }\n  }\n\n  // Register a change in the history. Merges changes that are within\n  // a single operation, or are close together with an origin that\n  // allows merging (starting with \"+\") into a single event.\n  function addChangeToHistory(doc, change, selAfter, opId) {\n    var hist = doc.history;\n    hist.undone.length = 0;\n    var time = +new Date, cur;\n    var last;\n\n    if ((hist.lastOp == opId ||\n         hist.lastOrigin == change.origin && change.origin &&\n         ((change.origin.charAt(0) == \"+\" && hist.lastModTime > time - (doc.cm ? doc.cm.options.historyEventDelay : 500)) ||\n          change.origin.charAt(0) == \"*\")) &&\n        (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n      // Merge this change into the last event\n      last = lst(cur.changes);\n      if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n        // Optimized case for simple insertion -- don't want to add\n        // new changesets for every character typed\n        last.to = changeEnd(change);\n      } else {\n        // Add new sub-event\n        cur.changes.push(historyChangeFromChange(doc, change));\n      }\n    } else {\n      // Can not be merged, start a new event.\n      var before = lst(hist.done);\n      if (!before || !before.ranges)\n        { pushSelectionToHistory(doc.sel, hist.done); }\n      cur = {changes: [historyChangeFromChange(doc, change)],\n             generation: hist.generation};\n      hist.done.push(cur);\n      while (hist.done.length > hist.undoDepth) {\n        hist.done.shift();\n        if (!hist.done[0].ranges) { hist.done.shift(); }\n      }\n    }\n    hist.done.push(selAfter);\n    hist.generation = ++hist.maxGeneration;\n    hist.lastModTime = hist.lastSelTime = time;\n    hist.lastOp = hist.lastSelOp = opId;\n    hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n    if (!last) { signal(doc, \"historyAdded\"); }\n  }\n\n  function selectionEventCanBeMerged(doc, origin, prev, sel) {\n    var ch = origin.charAt(0);\n    return ch == \"*\" ||\n      ch == \"+\" &&\n      prev.ranges.length == sel.ranges.length &&\n      prev.somethingSelected() == sel.somethingSelected() &&\n      new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\n  }\n\n  // Called whenever the selection changes, sets the new selection as\n  // the pending selection in the history, and pushes the old pending\n  // selection into the 'done' array when it was significantly\n  // different (in number of selected ranges, emptiness, or time).\n  function addSelectionToHistory(doc, sel, opId, options) {\n    var hist = doc.history, origin = options && options.origin;\n\n    // A new event is started when the previous origin does not match\n    // the current, or the origins don't allow matching. Origins\n    // starting with * are always merged, those starting with + are\n    // merged when similar and close together in time.\n    if (opId == hist.lastSelOp ||\n        (origin && hist.lastSelOrigin == origin &&\n         (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n          selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n      { hist.done[hist.done.length - 1] = sel; }\n    else\n      { pushSelectionToHistory(sel, hist.done); }\n\n    hist.lastSelTime = +new Date;\n    hist.lastSelOrigin = origin;\n    hist.lastSelOp = opId;\n    if (options && options.clearRedo !== false)\n      { clearSelectionEvents(hist.undone); }\n  }\n\n  function pushSelectionToHistory(sel, dest) {\n    var top = lst(dest);\n    if (!(top && top.ranges && top.equals(sel)))\n      { dest.push(sel); }\n  }\n\n  // Used to store marked span information in the history.\n  function attachLocalSpans(doc, change, from, to) {\n    var existing = change[\"spans_\" + doc.id], n = 0;\n    doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n      if (line.markedSpans)\n        { (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans; }\n      ++n;\n    });\n  }\n\n  // When un/re-doing restores text containing marked spans, those\n  // that have been explicitly cleared should not be restored.\n  function removeClearedSpans(spans) {\n    if (!spans) { return null }\n    var out;\n    for (var i = 0; i < spans.length; ++i) {\n      if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i); } }\n      else if (out) { out.push(spans[i]); }\n    }\n    return !out ? spans : out.length ? out : null\n  }\n\n  // Retrieve and filter the old marked spans stored in a change event.\n  function getOldSpans(doc, change) {\n    var found = change[\"spans_\" + doc.id];\n    if (!found) { return null }\n    var nw = [];\n    for (var i = 0; i < change.text.length; ++i)\n      { nw.push(removeClearedSpans(found[i])); }\n    return nw\n  }\n\n  // Used for un/re-doing changes from the history. Combines the\n  // result of computing the existing spans with the set of spans that\n  // existed in the history (so that deleting around a span and then\n  // undoing brings back the span).\n  function mergeOldSpans(doc, change) {\n    var old = getOldSpans(doc, change);\n    var stretched = stretchSpansOverChange(doc, change);\n    if (!old) { return stretched }\n    if (!stretched) { return old }\n\n    for (var i = 0; i < old.length; ++i) {\n      var oldCur = old[i], stretchCur = stretched[i];\n      if (oldCur && stretchCur) {\n        spans: for (var j = 0; j < stretchCur.length; ++j) {\n          var span = stretchCur[j];\n          for (var k = 0; k < oldCur.length; ++k)\n            { if (oldCur[k].marker == span.marker) { continue spans } }\n          oldCur.push(span);\n        }\n      } else if (stretchCur) {\n        old[i] = stretchCur;\n      }\n    }\n    return old\n  }\n\n  // Used both to provide a JSON-safe object in .getHistory, and, when\n  // detaching a document, to split the history in two\n  function copyHistoryArray(events, newGroup, instantiateSel) {\n    var copy = [];\n    for (var i = 0; i < events.length; ++i) {\n      var event = events[i];\n      if (event.ranges) {\n        copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n        continue\n      }\n      var changes = event.changes, newChanges = [];\n      copy.push({changes: newChanges});\n      for (var j = 0; j < changes.length; ++j) {\n        var change = changes[j], m = (void 0);\n        newChanges.push({from: change.from, to: change.to, text: change.text});\n        if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\n          if (indexOf(newGroup, Number(m[1])) > -1) {\n            lst(newChanges)[prop] = change[prop];\n            delete change[prop];\n          }\n        } } }\n      }\n    }\n    return copy\n  }\n\n  // The 'scroll' parameter given to many of these indicated whether\n  // the new cursor position should be scrolled into view after\n  // modifying the selection.\n\n  // If shift is held or the extend flag is set, extends a range to\n  // include a given position (and optionally a second position).\n  // Otherwise, simply returns the range between the given positions.\n  // Used for cursor motion and such.\n  function extendRange(range, head, other, extend) {\n    if (extend) {\n      var anchor = range.anchor;\n      if (other) {\n        var posBefore = cmp(head, anchor) < 0;\n        if (posBefore != (cmp(other, anchor) < 0)) {\n          anchor = head;\n          head = other;\n        } else if (posBefore != (cmp(head, other) < 0)) {\n          head = other;\n        }\n      }\n      return new Range(anchor, head)\n    } else {\n      return new Range(other || head, head)\n    }\n  }\n\n  // Extend the primary selection range, discard the rest.\n  function extendSelection(doc, head, other, options, extend) {\n    if (extend == null) { extend = doc.cm && (doc.cm.display.shift || doc.extend); }\n    setSelection(doc, new Selection([extendRange(doc.sel.primary(), head, other, extend)], 0), options);\n  }\n\n  // Extend all selections (pos is an array of selections with length\n  // equal the number of selections)\n  function extendSelections(doc, heads, options) {\n    var out = [];\n    var extend = doc.cm && (doc.cm.display.shift || doc.extend);\n    for (var i = 0; i < doc.sel.ranges.length; i++)\n      { out[i] = extendRange(doc.sel.ranges[i], heads[i], null, extend); }\n    var newSel = normalizeSelection(doc.cm, out, doc.sel.primIndex);\n    setSelection(doc, newSel, options);\n  }\n\n  // Updates a single range in the selection.\n  function replaceOneSelection(doc, i, range, options) {\n    var ranges = doc.sel.ranges.slice(0);\n    ranges[i] = range;\n    setSelection(doc, normalizeSelection(doc.cm, ranges, doc.sel.primIndex), options);\n  }\n\n  // Reset the selection to a single range.\n  function setSimpleSelection(doc, anchor, head, options) {\n    setSelection(doc, simpleSelection(anchor, head), options);\n  }\n\n  // Give beforeSelectionChange handlers a change to influence a\n  // selection update.\n  function filterSelectionChange(doc, sel, options) {\n    var obj = {\n      ranges: sel.ranges,\n      update: function(ranges) {\n        this.ranges = [];\n        for (var i = 0; i < ranges.length; i++)\n          { this.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                     clipPos(doc, ranges[i].head)); }\n      },\n      origin: options && options.origin\n    };\n    signal(doc, \"beforeSelectionChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj); }\n    if (obj.ranges != sel.ranges) { return normalizeSelection(doc.cm, obj.ranges, obj.ranges.length - 1) }\n    else { return sel }\n  }\n\n  function setSelectionReplaceHistory(doc, sel, options) {\n    var done = doc.history.done, last = lst(done);\n    if (last && last.ranges) {\n      done[done.length - 1] = sel;\n      setSelectionNoUndo(doc, sel, options);\n    } else {\n      setSelection(doc, sel, options);\n    }\n  }\n\n  // Set a new selection.\n  function setSelection(doc, sel, options) {\n    setSelectionNoUndo(doc, sel, options);\n    addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n  }\n\n  function setSelectionNoUndo(doc, sel, options) {\n    if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n      { sel = filterSelectionChange(doc, sel, options); }\n\n    var bias = options && options.bias ||\n      (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n    setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n    if (!(options && options.scroll === false) && doc.cm)\n      { ensureCursorVisible(doc.cm); }\n  }\n\n  function setSelectionInner(doc, sel) {\n    if (sel.equals(doc.sel)) { return }\n\n    doc.sel = sel;\n\n    if (doc.cm) {\n      doc.cm.curOp.updateInput = 1;\n      doc.cm.curOp.selectionChanged = true;\n      signalCursorActivity(doc.cm);\n    }\n    signalLater(doc, \"cursorActivity\", doc);\n  }\n\n  // Verify that the selection does not partially select any atomic\n  // marked ranges.\n  function reCheckSelection(doc) {\n    setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n  }\n\n  // Return a selection that does not partially select any atomic\n  // ranges.\n  function skipAtomicInSelection(doc, sel, bias, mayClear) {\n    var out;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range = sel.ranges[i];\n      var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n      var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n      var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n      if (out || newAnchor != range.anchor || newHead != range.head) {\n        if (!out) { out = sel.ranges.slice(0, i); }\n        out[i] = new Range(newAnchor, newHead);\n      }\n    }\n    return out ? normalizeSelection(doc.cm, out, sel.primIndex) : sel\n  }\n\n  function skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n    var line = getLine(doc, pos.line);\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n      var sp = line.markedSpans[i], m = sp.marker;\n\n      // Determine if we should prevent the cursor being placed to the left/right of an atomic marker\n      // Historically this was determined using the inclusiveLeft/Right option, but the new way to control it\n      // is with selectLeft/Right\n      var preventCursorLeft = (\"selectLeft\" in m) ? !m.selectLeft : m.inclusiveLeft;\n      var preventCursorRight = (\"selectRight\" in m) ? !m.selectRight : m.inclusiveRight;\n\n      if ((sp.from == null || (preventCursorLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\n          (sp.to == null || (preventCursorRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n        if (mayClear) {\n          signal(m, \"beforeCursorEnter\");\n          if (m.explicitlyCleared) {\n            if (!line.markedSpans) { break }\n            else {--i; continue}\n          }\n        }\n        if (!m.atomic) { continue }\n\n        if (oldPos) {\n          var near = m.find(dir < 0 ? 1 : -1), diff = (void 0);\n          if (dir < 0 ? preventCursorRight : preventCursorLeft)\n            { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null); }\n          if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\n            { return skipAtomicInner(doc, near, pos, dir, mayClear) }\n        }\n\n        var far = m.find(dir < 0 ? -1 : 1);\n        if (dir < 0 ? preventCursorLeft : preventCursorRight)\n          { far = movePos(doc, far, dir, far.line == pos.line ? line : null); }\n        return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\n      }\n    } }\n    return pos\n  }\n\n  // Ensure a given position is not inside an atomic range.\n  function skipAtomic(doc, pos, oldPos, bias, mayClear) {\n    var dir = bias || 1;\n    var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\n        skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true));\n    if (!found) {\n      doc.cantEdit = true;\n      return Pos(doc.first, 0)\n    }\n    return found\n  }\n\n  function movePos(doc, pos, dir, line) {\n    if (dir < 0 && pos.ch == 0) {\n      if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\n      else { return null }\n    } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n      if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\n      else { return null }\n    } else {\n      return new Pos(pos.line, pos.ch + dir)\n    }\n  }\n\n  function selectAll(cm) {\n    cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n  }\n\n  // UPDATING\n\n  // Allow \"beforeChange\" event handlers to influence a change\n  function filterChange(doc, change, update) {\n    var obj = {\n      canceled: false,\n      from: change.from,\n      to: change.to,\n      text: change.text,\n      origin: change.origin,\n      cancel: function () { return obj.canceled = true; }\n    };\n    if (update) { obj.update = function (from, to, text, origin) {\n      if (from) { obj.from = clipPos(doc, from); }\n      if (to) { obj.to = clipPos(doc, to); }\n      if (text) { obj.text = text; }\n      if (origin !== undefined) { obj.origin = origin; }\n    }; }\n    signal(doc, \"beforeChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeChange\", doc.cm, obj); }\n\n    if (obj.canceled) {\n      if (doc.cm) { doc.cm.curOp.updateInput = 2; }\n      return null\n    }\n    return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\n  }\n\n  // Apply a change to a document, and add it to the document's\n  // history, and propagating it to all linked documents.\n  function makeChange(doc, change, ignoreReadOnly) {\n    if (doc.cm) {\n      if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\n      if (doc.cm.state.suppressEdits) { return }\n    }\n\n    if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n      change = filterChange(doc, change, true);\n      if (!change) { return }\n    }\n\n    // Possibly split or suppress the update based on the presence\n    // of read-only spans in its range.\n    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n    if (split) {\n      for (var i = split.length - 1; i >= 0; --i)\n        { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text, origin: change.origin}); }\n    } else {\n      makeChangeInner(doc, change);\n    }\n  }\n\n  function makeChangeInner(doc, change) {\n    if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) { return }\n    var selAfter = computeSelAfterChange(doc, change);\n    addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n    var rebased = [];\n\n    linkedDocs(doc, function (doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n    });\n  }\n\n  // Revert a change stored in a document's history.\n  function makeChangeFromHistory(doc, type, allowSelectionOnly) {\n    var suppress = doc.cm && doc.cm.state.suppressEdits;\n    if (suppress && !allowSelectionOnly) { return }\n\n    var hist = doc.history, event, selAfter = doc.sel;\n    var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n    // Verify that there is a useable event (so that ctrl-z won't\n    // needlessly clear selection events)\n    var i = 0;\n    for (; i < source.length; i++) {\n      event = source[i];\n      if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n        { break }\n    }\n    if (i == source.length) { return }\n    hist.lastOrigin = hist.lastSelOrigin = null;\n\n    for (;;) {\n      event = source.pop();\n      if (event.ranges) {\n        pushSelectionToHistory(event, dest);\n        if (allowSelectionOnly && !event.equals(doc.sel)) {\n          setSelection(doc, event, {clearRedo: false});\n          return\n        }\n        selAfter = event;\n      } else if (suppress) {\n        source.push(event);\n        return\n      } else { break }\n    }\n\n    // Build up a reverse change object to add to the opposite history\n    // stack (redo when undoing, and vice versa).\n    var antiChanges = [];\n    pushSelectionToHistory(selAfter, dest);\n    dest.push({changes: antiChanges, generation: hist.generation});\n    hist.generation = event.generation || ++hist.maxGeneration;\n\n    var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n    var loop = function ( i ) {\n      var change = event.changes[i];\n      change.origin = type;\n      if (filter && !filterChange(doc, change, false)) {\n        source.length = 0;\n        return {}\n      }\n\n      antiChanges.push(historyChangeFromChange(doc, change));\n\n      var after = i ? computeSelAfterChange(doc, change) : lst(source);\n      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n      if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}); }\n      var rebased = [];\n\n      // Propagate to the linked documents\n      linkedDocs(doc, function (doc, sharedHist) {\n        if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n          rebaseHist(doc.history, change);\n          rebased.push(doc.history);\n        }\n        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n      });\n    };\n\n    for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n      var returned = loop( i$1 );\n\n      if ( returned ) return returned.v;\n    }\n  }\n\n  // Sub-views need their line numbers shifted when text is added\n  // above or below them in the parent document.\n  function shiftDoc(doc, distance) {\n    if (distance == 0) { return }\n    doc.first += distance;\n    doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\n      Pos(range.anchor.line + distance, range.anchor.ch),\n      Pos(range.head.line + distance, range.head.ch)\n    ); }), doc.sel.primIndex);\n    if (doc.cm) {\n      regChange(doc.cm, doc.first, doc.first - distance, distance);\n      for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n        { regLineChange(doc.cm, l, \"gutter\"); }\n    }\n  }\n\n  // More lower-level change function, handling only a single document\n  // (not linked ones).\n  function makeChangeSingleDoc(doc, change, selAfter, spans) {\n    if (doc.cm && !doc.cm.curOp)\n      { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\n\n    if (change.to.line < doc.first) {\n      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n      return\n    }\n    if (change.from.line > doc.lastLine()) { return }\n\n    // Clip the change to the size of this doc\n    if (change.from.line < doc.first) {\n      var shift = change.text.length - 1 - (doc.first - change.from.line);\n      shiftDoc(doc, shift);\n      change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n                text: [lst(change.text)], origin: change.origin};\n    }\n    var last = doc.lastLine();\n    if (change.to.line > last) {\n      change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n                text: [change.text[0]], origin: change.origin};\n    }\n\n    change.removed = getBetween(doc, change.from, change.to);\n\n    if (!selAfter) { selAfter = computeSelAfterChange(doc, change); }\n    if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans); }\n    else { updateDoc(doc, change, spans); }\n    setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n\n    if (doc.cantEdit && skipAtomic(doc, Pos(doc.firstLine(), 0)))\n      { doc.cantEdit = false; }\n  }\n\n  // Handle the interaction of a change to a document with the editor\n  // that this document is part of.\n  function makeChangeSingleDocInEditor(cm, change, spans) {\n    var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n    var recomputeMaxLength = false, checkWidthStart = from.line;\n    if (!cm.options.lineWrapping) {\n      checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n      doc.iter(checkWidthStart, to.line + 1, function (line) {\n        if (line == display.maxLine) {\n          recomputeMaxLength = true;\n          return true\n        }\n      });\n    }\n\n    if (doc.sel.contains(change.from, change.to) > -1)\n      { signalCursorActivity(cm); }\n\n    updateDoc(doc, change, spans, estimateHeight(cm));\n\n    if (!cm.options.lineWrapping) {\n      doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n        var len = lineLength(line);\n        if (len > display.maxLineLength) {\n          display.maxLine = line;\n          display.maxLineLength = len;\n          display.maxLineChanged = true;\n          recomputeMaxLength = false;\n        }\n      });\n      if (recomputeMaxLength) { cm.curOp.updateMaxLine = true; }\n    }\n\n    retreatFrontier(doc, from.line);\n    startWorker(cm, 400);\n\n    var lendiff = change.text.length - (to.line - from.line) - 1;\n    // Remember that these lines changed, for updating the display\n    if (change.full)\n      { regChange(cm); }\n    else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n      { regLineChange(cm, from.line, \"text\"); }\n    else\n      { regChange(cm, from.line, to.line + 1, lendiff); }\n\n    var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n    if (changeHandler || changesHandler) {\n      var obj = {\n        from: from, to: to,\n        text: change.text,\n        removed: change.removed,\n        origin: change.origin\n      };\n      if (changeHandler) { signalLater(cm, \"change\", cm, obj); }\n      if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj); }\n    }\n    cm.display.selForContextMenu = null;\n  }\n\n  function replaceRange(doc, code, from, to, origin) {\n    var assign;\n\n    if (!to) { to = from; }\n    if (cmp(to, from) < 0) { (assign = [to, from], from = assign[0], to = assign[1]); }\n    if (typeof code == \"string\") { code = doc.splitLines(code); }\n    makeChange(doc, {from: from, to: to, text: code, origin: origin});\n  }\n\n  // Rebasing/resetting history to deal with externally-sourced changes\n\n  function rebaseHistSelSingle(pos, from, to, diff) {\n    if (to < pos.line) {\n      pos.line += diff;\n    } else if (from < pos.line) {\n      pos.line = from;\n      pos.ch = 0;\n    }\n  }\n\n  // Tries to rebase an array of history events given a change in the\n  // document. If the change touches the same lines as the event, the\n  // event, and everything 'behind' it, is discarded. If the change is\n  // before the event, the event's positions are updated. Uses a\n  // copy-on-write scheme for the positions, to avoid having to\n  // reallocate them all on every rebase, but also avoid problems with\n  // shared position objects being unsafely updated.\n  function rebaseHistArray(array, from, to, diff) {\n    for (var i = 0; i < array.length; ++i) {\n      var sub = array[i], ok = true;\n      if (sub.ranges) {\n        if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n        for (var j = 0; j < sub.ranges.length; j++) {\n          rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n          rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n        }\n        continue\n      }\n      for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n        var cur = sub.changes[j$1];\n        if (to < cur.from.line) {\n          cur.from = Pos(cur.from.line + diff, cur.from.ch);\n          cur.to = Pos(cur.to.line + diff, cur.to.ch);\n        } else if (from <= cur.to.line) {\n          ok = false;\n          break\n        }\n      }\n      if (!ok) {\n        array.splice(0, i + 1);\n        i = 0;\n      }\n    }\n  }\n\n  function rebaseHist(hist, change) {\n    var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n    rebaseHistArray(hist.done, from, to, diff);\n    rebaseHistArray(hist.undone, from, to, diff);\n  }\n\n  // Utility for applying a change to a line by handle or number,\n  // returning the number and optionally registering the line as\n  // changed.\n  function changeLine(doc, handle, changeType, op) {\n    var no = handle, line = handle;\n    if (typeof handle == \"number\") { line = getLine(doc, clipLine(doc, handle)); }\n    else { no = lineNo(handle); }\n    if (no == null) { return null }\n    if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType); }\n    return line\n  }\n\n  // The document is represented as a BTree consisting of leaves, with\n  // chunk of lines in them, and branches, with up to ten leaves or\n  // other branch nodes below them. The top node is always a branch\n  // node, and is the document object itself (meaning it has\n  // additional methods and properties).\n  //\n  // All nodes have parent links. The tree is used both to go from\n  // line numbers to line objects, and to go from objects to numbers.\n  // It also indexes by height, and is used to convert between height\n  // and line object, and to find the total height of the document.\n  //\n  // See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\n  function LeafChunk(lines) {\n    this.lines = lines;\n    this.parent = null;\n    var height = 0;\n    for (var i = 0; i < lines.length; ++i) {\n      lines[i].parent = this;\n      height += lines[i].height;\n    }\n    this.height = height;\n  }\n\n  LeafChunk.prototype = {\n    chunkSize: function() { return this.lines.length },\n\n    // Remove the n lines at offset 'at'.\n    removeInner: function(at, n) {\n      for (var i = at, e = at + n; i < e; ++i) {\n        var line = this.lines[i];\n        this.height -= line.height;\n        cleanUpLine(line);\n        signalLater(line, \"delete\");\n      }\n      this.lines.splice(at, n);\n    },\n\n    // Helper used to collapse a small branch into a single leaf.\n    collapse: function(lines) {\n      lines.push.apply(lines, this.lines);\n    },\n\n    // Insert the given array of lines at offset 'at', count them as\n    // having the given height.\n    insertInner: function(at, lines, height) {\n      this.height += height;\n      this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n      for (var i = 0; i < lines.length; ++i) { lines[i].parent = this; }\n    },\n\n    // Used to iterate over a part of the tree.\n    iterN: function(at, n, op) {\n      for (var e = at + n; at < e; ++at)\n        { if (op(this.lines[at])) { return true } }\n    }\n  };\n\n  function BranchChunk(children) {\n    this.children = children;\n    var size = 0, height = 0;\n    for (var i = 0; i < children.length; ++i) {\n      var ch = children[i];\n      size += ch.chunkSize(); height += ch.height;\n      ch.parent = this;\n    }\n    this.size = size;\n    this.height = height;\n    this.parent = null;\n  }\n\n  BranchChunk.prototype = {\n    chunkSize: function() { return this.size },\n\n    removeInner: function(at, n) {\n      this.size -= n;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var rm = Math.min(n, sz - at), oldHeight = child.height;\n          child.removeInner(at, rm);\n          this.height -= oldHeight - child.height;\n          if (sz == rm) { this.children.splice(i--, 1); child.parent = null; }\n          if ((n -= rm) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n      // If the result is smaller than 25 lines, ensure that it is a\n      // single leaf node.\n      if (this.size - n < 25 &&\n          (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n        var lines = [];\n        this.collapse(lines);\n        this.children = [new LeafChunk(lines)];\n        this.children[0].parent = this;\n      }\n    },\n\n    collapse: function(lines) {\n      for (var i = 0; i < this.children.length; ++i) { this.children[i].collapse(lines); }\n    },\n\n    insertInner: function(at, lines, height) {\n      this.size += lines.length;\n      this.height += height;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at <= sz) {\n          child.insertInner(at, lines, height);\n          if (child.lines && child.lines.length > 50) {\n            // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n            // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n            var remaining = child.lines.length % 25 + 25;\n            for (var pos = remaining; pos < child.lines.length;) {\n              var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n              child.height -= leaf.height;\n              this.children.splice(++i, 0, leaf);\n              leaf.parent = this;\n            }\n            child.lines = child.lines.slice(0, remaining);\n            this.maybeSpill();\n          }\n          break\n        }\n        at -= sz;\n      }\n    },\n\n    // When a node has grown, check whether it should be split.\n    maybeSpill: function() {\n      if (this.children.length <= 10) { return }\n      var me = this;\n      do {\n        var spilled = me.children.splice(me.children.length - 5, 5);\n        var sibling = new BranchChunk(spilled);\n        if (!me.parent) { // Become the parent node\n          var copy = new BranchChunk(me.children);\n          copy.parent = me;\n          me.children = [copy, sibling];\n          me = copy;\n       } else {\n          me.size -= sibling.size;\n          me.height -= sibling.height;\n          var myIndex = indexOf(me.parent.children, me);\n          me.parent.children.splice(myIndex + 1, 0, sibling);\n        }\n        sibling.parent = me.parent;\n      } while (me.children.length > 10)\n      me.parent.maybeSpill();\n    },\n\n    iterN: function(at, n, op) {\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var used = Math.min(n, sz - at);\n          if (child.iterN(at, used, op)) { return true }\n          if ((n -= used) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n    }\n  };\n\n  // Line widgets are block elements displayed above or below a line.\n\n  var LineWidget = function(doc, node, options) {\n    if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\n      { this[opt] = options[opt]; } } }\n    this.doc = doc;\n    this.node = node;\n  };\n\n  LineWidget.prototype.clear = function () {\n    var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n    if (no == null || !ws) { return }\n    for (var i = 0; i < ws.length; ++i) { if (ws[i] == this) { ws.splice(i--, 1); } }\n    if (!ws.length) { line.widgets = null; }\n    var height = widgetHeight(this);\n    updateLineHeight(line, Math.max(0, line.height - height));\n    if (cm) {\n      runInOp(cm, function () {\n        adjustScrollWhenAboveVisible(cm, line, -height);\n        regLineChange(cm, no, \"widget\");\n      });\n      signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n    }\n  };\n\n  LineWidget.prototype.changed = function () {\n      var this$1 = this;\n\n    var oldH = this.height, cm = this.doc.cm, line = this.line;\n    this.height = null;\n    var diff = widgetHeight(this) - oldH;\n    if (!diff) { return }\n    if (!lineIsHidden(this.doc, line)) { updateLineHeight(line, line.height + diff); }\n    if (cm) {\n      runInOp(cm, function () {\n        cm.curOp.forceUpdate = true;\n        adjustScrollWhenAboveVisible(cm, line, diff);\n        signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n      });\n    }\n  };\n  eventMixin(LineWidget);\n\n  function adjustScrollWhenAboveVisible(cm, line, diff) {\n    if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n      { addToScrollTop(cm, diff); }\n  }\n\n  function addLineWidget(doc, handle, node, options) {\n    var widget = new LineWidget(doc, node, options);\n    var cm = doc.cm;\n    if (cm && widget.noHScroll) { cm.display.alignWidgets = true; }\n    changeLine(doc, handle, \"widget\", function (line) {\n      var widgets = line.widgets || (line.widgets = []);\n      if (widget.insertAt == null) { widgets.push(widget); }\n      else { widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget); }\n      widget.line = line;\n      if (cm && !lineIsHidden(doc, line)) {\n        var aboveVisible = heightAtLine(line) < doc.scrollTop;\n        updateLineHeight(line, line.height + widgetHeight(widget));\n        if (aboveVisible) { addToScrollTop(cm, widget.height); }\n        cm.curOp.forceUpdate = true;\n      }\n      return true\n    });\n    if (cm) { signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle)); }\n    return widget\n  }\n\n  // TEXTMARKERS\n\n  // Created with markText and setBookmark methods. A TextMarker is a\n  // handle that can be used to clear or find a marked position in the\n  // document. Line objects hold arrays (markedSpans) containing\n  // {from, to, marker} object pointing to such marker objects, and\n  // indicating that such a marker is present on that line. Multiple\n  // lines may point to the same marker when it spans across lines.\n  // The spans will have null for their from/to properties when the\n  // marker continues beyond the start/end of the line. Markers have\n  // links back to the lines they currently touch.\n\n  // Collapsed markers have unique ids, in order to be able to order\n  // them, which is needed for uniquely determining an outer marker\n  // when they overlap (they may nest, but not partially overlap).\n  var nextMarkerId = 0;\n\n  var TextMarker = function(doc, type) {\n    this.lines = [];\n    this.type = type;\n    this.doc = doc;\n    this.id = ++nextMarkerId;\n  };\n\n  // Clear the marker.\n  TextMarker.prototype.clear = function () {\n    if (this.explicitlyCleared) { return }\n    var cm = this.doc.cm, withOp = cm && !cm.curOp;\n    if (withOp) { startOperation(cm); }\n    if (hasHandler(this, \"clear\")) {\n      var found = this.find();\n      if (found) { signalLater(this, \"clear\", found.from, found.to); }\n    }\n    var min = null, max = null;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (cm && !this.collapsed) { regLineChange(cm, lineNo(line), \"text\"); }\n      else if (cm) {\n        if (span.to != null) { max = lineNo(line); }\n        if (span.from != null) { min = lineNo(line); }\n      }\n      line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n      if (span.from == null && this.collapsed && !lineIsHidden(this.doc, line) && cm)\n        { updateLineHeight(line, textHeight(cm.display)); }\n    }\n    if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n      var visual = visualLine(this.lines[i$1]), len = lineLength(visual);\n      if (len > cm.display.maxLineLength) {\n        cm.display.maxLine = visual;\n        cm.display.maxLineLength = len;\n        cm.display.maxLineChanged = true;\n      }\n    } }\n\n    if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1); }\n    this.lines.length = 0;\n    this.explicitlyCleared = true;\n    if (this.atomic && this.doc.cantEdit) {\n      this.doc.cantEdit = false;\n      if (cm) { reCheckSelection(cm.doc); }\n    }\n    if (cm) { signalLater(cm, \"markerCleared\", cm, this, min, max); }\n    if (withOp) { endOperation(cm); }\n    if (this.parent) { this.parent.clear(); }\n  };\n\n  // Find the position of the marker in the document. Returns a {from,\n  // to} object by default. Side can be passed to get a specific side\n  // -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n  // Pos objects returned contain a line object, rather than a line\n  // number (used to prevent looking up the same line twice).\n  TextMarker.prototype.find = function (side, lineObj) {\n    if (side == null && this.type == \"bookmark\") { side = 1; }\n    var from, to;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (span.from != null) {\n        from = Pos(lineObj ? line : lineNo(line), span.from);\n        if (side == -1) { return from }\n      }\n      if (span.to != null) {\n        to = Pos(lineObj ? line : lineNo(line), span.to);\n        if (side == 1) { return to }\n      }\n    }\n    return from && {from: from, to: to}\n  };\n\n  // Signals that the marker's widget changed, and surrounding layout\n  // should be recomputed.\n  TextMarker.prototype.changed = function () {\n      var this$1 = this;\n\n    var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n    if (!pos || !cm) { return }\n    runInOp(cm, function () {\n      var line = pos.line, lineN = lineNo(pos.line);\n      var view = findViewForLine(cm, lineN);\n      if (view) {\n        clearLineMeasurementCacheFor(view);\n        cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n      }\n      cm.curOp.updateMaxLine = true;\n      if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n        var oldHeight = widget.height;\n        widget.height = null;\n        var dHeight = widgetHeight(widget) - oldHeight;\n        if (dHeight)\n          { updateLineHeight(line, line.height + dHeight); }\n      }\n      signalLater(cm, \"markerChanged\", cm, this$1);\n    });\n  };\n\n  TextMarker.prototype.attachLine = function (line) {\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n        { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this); }\n    }\n    this.lines.push(line);\n  };\n\n  TextMarker.prototype.detachLine = function (line) {\n    this.lines.splice(indexOf(this.lines, line), 1);\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp\n      ;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n    }\n  };\n  eventMixin(TextMarker);\n\n  // Create a marker, wire it up to the right lines, and\n  function markText(doc, from, to, options, type) {\n    // Shared markers (across linked documents) are handled separately\n    // (markTextShared will call out to this again, once per\n    // document).\n    if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\n    // Ensure we are in an operation.\n    if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\n\n    var marker = new TextMarker(doc, type), diff = cmp(from, to);\n    if (options) { copyObj(options, marker, false); }\n    // Don't connect empty markers unless clearWhenEmpty is false\n    if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n      { return marker }\n    if (marker.replacedWith) {\n      // Showing up as a widget implies collapsed (widget replaces text)\n      marker.collapsed = true;\n      marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n      if (!options.handleMouseEvents) { marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\"); }\n      if (options.insertLeft) { marker.widgetNode.insertLeft = true; }\n    }\n    if (marker.collapsed) {\n      if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n          from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n        { throw new Error(\"Inserting collapsed marker partially overlapping an existing one\") }\n      seeCollapsedSpans();\n    }\n\n    if (marker.addToHistory)\n      { addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN); }\n\n    var curLine = from.line, cm = doc.cm, updateMaxLine;\n    doc.iter(curLine, to.line + 1, function (line) {\n      if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n        { updateMaxLine = true; }\n      if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0); }\n      addMarkedSpan(line, new MarkedSpan(marker,\n                                         curLine == from.line ? from.ch : null,\n                                         curLine == to.line ? to.ch : null));\n      ++curLine;\n    });\n    // lineIsHidden depends on the presence of the spans, so needs a second pass\n    if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\n      if (lineIsHidden(doc, line)) { updateLineHeight(line, 0); }\n    }); }\n\n    if (marker.clearOnEnter) { on(marker, \"beforeCursorEnter\", function () { return marker.clear(); }); }\n\n    if (marker.readOnly) {\n      seeReadOnlySpans();\n      if (doc.history.done.length || doc.history.undone.length)\n        { doc.clearHistory(); }\n    }\n    if (marker.collapsed) {\n      marker.id = ++nextMarkerId;\n      marker.atomic = true;\n    }\n    if (cm) {\n      // Sync editor state\n      if (updateMaxLine) { cm.curOp.updateMaxLine = true; }\n      if (marker.collapsed)\n        { regChange(cm, from.line, to.line + 1); }\n      else if (marker.className || marker.startStyle || marker.endStyle || marker.css ||\n               marker.attributes || marker.title)\n        { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, \"text\"); } }\n      if (marker.atomic) { reCheckSelection(cm.doc); }\n      signalLater(cm, \"markerAdded\", cm, marker);\n    }\n    return marker\n  }\n\n  // SHARED TEXTMARKERS\n\n  // A shared marker spans multiple linked documents. It is\n  // implemented as a meta-marker-object controlling multiple normal\n  // markers.\n  var SharedTextMarker = function(markers, primary) {\n    this.markers = markers;\n    this.primary = primary;\n    for (var i = 0; i < markers.length; ++i)\n      { markers[i].parent = this; }\n  };\n\n  SharedTextMarker.prototype.clear = function () {\n    if (this.explicitlyCleared) { return }\n    this.explicitlyCleared = true;\n    for (var i = 0; i < this.markers.length; ++i)\n      { this.markers[i].clear(); }\n    signalLater(this, \"clear\");\n  };\n\n  SharedTextMarker.prototype.find = function (side, lineObj) {\n    return this.primary.find(side, lineObj)\n  };\n  eventMixin(SharedTextMarker);\n\n  function markTextShared(doc, from, to, options, type) {\n    options = copyObj(options);\n    options.shared = false;\n    var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n    var widget = options.widgetNode;\n    linkedDocs(doc, function (doc) {\n      if (widget) { options.widgetNode = widget.cloneNode(true); }\n      markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n      for (var i = 0; i < doc.linked.length; ++i)\n        { if (doc.linked[i].isParent) { return } }\n      primary = lst(markers);\n    });\n    return new SharedTextMarker(markers, primary)\n  }\n\n  function findSharedMarkers(doc) {\n    return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\n  }\n\n  function copySharedMarkers(doc, markers) {\n    for (var i = 0; i < markers.length; i++) {\n      var marker = markers[i], pos = marker.find();\n      var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n      if (cmp(mFrom, mTo)) {\n        var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n        marker.markers.push(subMark);\n        subMark.parent = marker;\n      }\n    }\n  }\n\n  function detachSharedMarkers(markers) {\n    var loop = function ( i ) {\n      var marker = markers[i], linked = [marker.primary.doc];\n      linkedDocs(marker.primary.doc, function (d) { return linked.push(d); });\n      for (var j = 0; j < marker.markers.length; j++) {\n        var subMarker = marker.markers[j];\n        if (indexOf(linked, subMarker.doc) == -1) {\n          subMarker.parent = null;\n          marker.markers.splice(j--, 1);\n        }\n      }\n    };\n\n    for (var i = 0; i < markers.length; i++) loop( i );\n  }\n\n  var nextDocId = 0;\n  var Doc = function(text, mode, firstLine, lineSep, direction) {\n    if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\n    if (firstLine == null) { firstLine = 0; }\n\n    BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n    this.first = firstLine;\n    this.scrollTop = this.scrollLeft = 0;\n    this.cantEdit = false;\n    this.cleanGeneration = 1;\n    this.modeFrontier = this.highlightFrontier = firstLine;\n    var start = Pos(firstLine, 0);\n    this.sel = simpleSelection(start);\n    this.history = new History(null);\n    this.id = ++nextDocId;\n    this.modeOption = mode;\n    this.lineSep = lineSep;\n    this.direction = (direction == \"rtl\") ? \"rtl\" : \"ltr\";\n    this.extend = false;\n\n    if (typeof text == \"string\") { text = this.splitLines(text); }\n    updateDoc(this, {from: start, to: start, text: text});\n    setSelection(this, simpleSelection(start), sel_dontScroll);\n  };\n\n  Doc.prototype = createObj(BranchChunk.prototype, {\n    constructor: Doc,\n    // Iterate over the document. Supports two forms -- with only one\n    // argument, it calls that for each line in the document. With\n    // three, it iterates over the range given by the first two (with\n    // the second being non-inclusive).\n    iter: function(from, to, op) {\n      if (op) { this.iterN(from - this.first, to - from, op); }\n      else { this.iterN(this.first, this.first + this.size, from); }\n    },\n\n    // Non-public interface for adding and removing lines.\n    insert: function(at, lines) {\n      var height = 0;\n      for (var i = 0; i < lines.length; ++i) { height += lines[i].height; }\n      this.insertInner(at - this.first, lines, height);\n    },\n    remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n    // From here, the methods are part of the public interface. Most\n    // are also available from CodeMirror (editor) instances.\n\n    getValue: function(lineSep) {\n      var lines = getLines(this, this.first, this.first + this.size);\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n    setValue: docMethodOp(function(code) {\n      var top = Pos(this.first, 0), last = this.first + this.size - 1;\n      makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                        text: this.splitLines(code), origin: \"setValue\", full: true}, true);\n      if (this.cm) { scrollToCoords(this.cm, 0, 0); }\n      setSelection(this, simpleSelection(top), sel_dontScroll);\n    }),\n    replaceRange: function(code, from, to, origin) {\n      from = clipPos(this, from);\n      to = to ? clipPos(this, to) : from;\n      replaceRange(this, code, from, to, origin);\n    },\n    getRange: function(from, to, lineSep) {\n      var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n\n    getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\n\n    getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\n    getLineNumber: function(line) {return lineNo(line)},\n\n    getLineHandleVisualStart: function(line) {\n      if (typeof line == \"number\") { line = getLine(this, line); }\n      return visualLine(line)\n    },\n\n    lineCount: function() {return this.size},\n    firstLine: function() {return this.first},\n    lastLine: function() {return this.first + this.size - 1},\n\n    clipPos: function(pos) {return clipPos(this, pos)},\n\n    getCursor: function(start) {\n      var range = this.sel.primary(), pos;\n      if (start == null || start == \"head\") { pos = range.head; }\n      else if (start == \"anchor\") { pos = range.anchor; }\n      else if (start == \"end\" || start == \"to\" || start === false) { pos = range.to(); }\n      else { pos = range.from(); }\n      return pos\n    },\n    listSelections: function() { return this.sel.ranges },\n    somethingSelected: function() {return this.sel.somethingSelected()},\n\n    setCursor: docMethodOp(function(line, ch, options) {\n      setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n    }),\n    setSelection: docMethodOp(function(anchor, head, options) {\n      setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n    }),\n    extendSelection: docMethodOp(function(head, other, options) {\n      extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n    }),\n    extendSelections: docMethodOp(function(heads, options) {\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    extendSelectionsBy: docMethodOp(function(f, options) {\n      var heads = map(this.sel.ranges, f);\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    setSelections: docMethodOp(function(ranges, primary, options) {\n      if (!ranges.length) { return }\n      var out = [];\n      for (var i = 0; i < ranges.length; i++)\n        { out[i] = new Range(clipPos(this, ranges[i].anchor),\n                           clipPos(this, ranges[i].head)); }\n      if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex); }\n      setSelection(this, normalizeSelection(this.cm, out, primary), options);\n    }),\n    addSelection: docMethodOp(function(anchor, head, options) {\n      var ranges = this.sel.ranges.slice(0);\n      ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n      setSelection(this, normalizeSelection(this.cm, ranges, ranges.length - 1), options);\n    }),\n\n    getSelection: function(lineSep) {\n      var ranges = this.sel.ranges, lines;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        lines = lines ? lines.concat(sel) : sel;\n      }\n      if (lineSep === false) { return lines }\n      else { return lines.join(lineSep || this.lineSeparator()) }\n    },\n    getSelections: function(lineSep) {\n      var parts = [], ranges = this.sel.ranges;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        if (lineSep !== false) { sel = sel.join(lineSep || this.lineSeparator()); }\n        parts[i] = sel;\n      }\n      return parts\n    },\n    replaceSelection: function(code, collapse, origin) {\n      var dup = [];\n      for (var i = 0; i < this.sel.ranges.length; i++)\n        { dup[i] = code; }\n      this.replaceSelections(dup, collapse, origin || \"+input\");\n    },\n    replaceSelections: docMethodOp(function(code, collapse, origin) {\n      var changes = [], sel = this.sel;\n      for (var i = 0; i < sel.ranges.length; i++) {\n        var range = sel.ranges[i];\n        changes[i] = {from: range.from(), to: range.to(), text: this.splitLines(code[i]), origin: origin};\n      }\n      var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n      for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\n        { makeChange(this, changes[i$1]); }\n      if (newSel) { setSelectionReplaceHistory(this, newSel); }\n      else if (this.cm) { ensureCursorVisible(this.cm); }\n    }),\n    undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n    redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n    undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n    redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n    setExtending: function(val) {this.extend = val;},\n    getExtending: function() {return this.extend},\n\n    historySize: function() {\n      var hist = this.history, done = 0, undone = 0;\n      for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done; } }\n      for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone; } }\n      return {undo: done, redo: undone}\n    },\n    clearHistory: function() {\n      var this$1 = this;\n\n      this.history = new History(this.history.maxGeneration);\n      linkedDocs(this, function (doc) { return doc.history = this$1.history; }, true);\n    },\n\n    markClean: function() {\n      this.cleanGeneration = this.changeGeneration(true);\n    },\n    changeGeneration: function(forceSplit) {\n      if (forceSplit)\n        { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null; }\n      return this.history.generation\n    },\n    isClean: function (gen) {\n      return this.history.generation == (gen || this.cleanGeneration)\n    },\n\n    getHistory: function() {\n      return {done: copyHistoryArray(this.history.done),\n              undone: copyHistoryArray(this.history.undone)}\n    },\n    setHistory: function(histData) {\n      var hist = this.history = new History(this.history.maxGeneration);\n      hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n      hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n    },\n\n    setGutterMarker: docMethodOp(function(line, gutterID, value) {\n      return changeLine(this, line, \"gutter\", function (line) {\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\n        markers[gutterID] = value;\n        if (!value && isEmpty(markers)) { line.gutterMarkers = null; }\n        return true\n      })\n    }),\n\n    clearGutter: docMethodOp(function(gutterID) {\n      var this$1 = this;\n\n      this.iter(function (line) {\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n          changeLine(this$1, line, \"gutter\", function () {\n            line.gutterMarkers[gutterID] = null;\n            if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null; }\n            return true\n          });\n        }\n      });\n    }),\n\n    lineInfo: function(line) {\n      var n;\n      if (typeof line == \"number\") {\n        if (!isLine(this, line)) { return null }\n        n = line;\n        line = getLine(this, line);\n        if (!line) { return null }\n      } else {\n        n = lineNo(line);\n        if (n == null) { return null }\n      }\n      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n              widgets: line.widgets}\n    },\n\n    addLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        if (!line[prop]) { line[prop] = cls; }\n        else if (classTest(cls).test(line[prop])) { return false }\n        else { line[prop] += \" \" + cls; }\n        return true\n      })\n    }),\n    removeLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        var cur = line[prop];\n        if (!cur) { return false }\n        else if (cls == null) { line[prop] = null; }\n        else {\n          var found = cur.match(classTest(cls));\n          if (!found) { return false }\n          var end = found.index + found[0].length;\n          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n        }\n        return true\n      })\n    }),\n\n    addLineWidget: docMethodOp(function(handle, node, options) {\n      return addLineWidget(this, handle, node, options)\n    }),\n    removeLineWidget: function(widget) { widget.clear(); },\n\n    markText: function(from, to, options) {\n      return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\")\n    },\n    setBookmark: function(pos, options) {\n      var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                      insertLeft: options && options.insertLeft,\n                      clearWhenEmpty: false, shared: options && options.shared,\n                      handleMouseEvents: options && options.handleMouseEvents};\n      pos = clipPos(this, pos);\n      return markText(this, pos, pos, realOpts, \"bookmark\")\n    },\n    findMarksAt: function(pos) {\n      pos = clipPos(this, pos);\n      var markers = [], spans = getLine(this, pos.line).markedSpans;\n      if (spans) { for (var i = 0; i < spans.length; ++i) {\n        var span = spans[i];\n        if ((span.from == null || span.from <= pos.ch) &&\n            (span.to == null || span.to >= pos.ch))\n          { markers.push(span.marker.parent || span.marker); }\n      } }\n      return markers\n    },\n    findMarks: function(from, to, filter) {\n      from = clipPos(this, from); to = clipPos(this, to);\n      var found = [], lineNo = from.line;\n      this.iter(from.line, to.line + 1, function (line) {\n        var spans = line.markedSpans;\n        if (spans) { for (var i = 0; i < spans.length; i++) {\n          var span = spans[i];\n          if (!(span.to != null && lineNo == from.line && from.ch >= span.to ||\n                span.from == null && lineNo != from.line ||\n                span.from != null && lineNo == to.line && span.from >= to.ch) &&\n              (!filter || filter(span.marker)))\n            { found.push(span.marker.parent || span.marker); }\n        } }\n        ++lineNo;\n      });\n      return found\n    },\n    getAllMarks: function() {\n      var markers = [];\n      this.iter(function (line) {\n        var sps = line.markedSpans;\n        if (sps) { for (var i = 0; i < sps.length; ++i)\n          { if (sps[i].from != null) { markers.push(sps[i].marker); } } }\n      });\n      return markers\n    },\n\n    posFromIndex: function(off) {\n      var ch, lineNo = this.first, sepSize = this.lineSeparator().length;\n      this.iter(function (line) {\n        var sz = line.text.length + sepSize;\n        if (sz > off) { ch = off; return true }\n        off -= sz;\n        ++lineNo;\n      });\n      return clipPos(this, Pos(lineNo, ch))\n    },\n    indexFromPos: function (coords) {\n      coords = clipPos(this, coords);\n      var index = coords.ch;\n      if (coords.line < this.first || coords.ch < 0) { return 0 }\n      var sepSize = this.lineSeparator().length;\n      this.iter(this.first, coords.line, function (line) { // iter aborts when callback returns a truthy value\n        index += line.text.length + sepSize;\n      });\n      return index\n    },\n\n    copy: function(copyHistory) {\n      var doc = new Doc(getLines(this, this.first, this.first + this.size),\n                        this.modeOption, this.first, this.lineSep, this.direction);\n      doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n      doc.sel = this.sel;\n      doc.extend = false;\n      if (copyHistory) {\n        doc.history.undoDepth = this.history.undoDepth;\n        doc.setHistory(this.getHistory());\n      }\n      return doc\n    },\n\n    linkedDoc: function(options) {\n      if (!options) { options = {}; }\n      var from = this.first, to = this.first + this.size;\n      if (options.from != null && options.from > from) { from = options.from; }\n      if (options.to != null && options.to < to) { to = options.to; }\n      var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n      if (options.sharedHist) { copy.history = this.history\n      ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n      copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n      copySharedMarkers(copy, findSharedMarkers(this));\n      return copy\n    },\n    unlinkDoc: function(other) {\n      if (other instanceof CodeMirror) { other = other.doc; }\n      if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\n        var link = this.linked[i];\n        if (link.doc != other) { continue }\n        this.linked.splice(i, 1);\n        other.unlinkDoc(this);\n        detachSharedMarkers(findSharedMarkers(this));\n        break\n      } }\n      // If the histories were shared, split them again\n      if (other.history == this.history) {\n        var splitIds = [other.id];\n        linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true);\n        other.history = new History(null);\n        other.history.done = copyHistoryArray(this.history.done, splitIds);\n        other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n      }\n    },\n    iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n    getMode: function() {return this.mode},\n    getEditor: function() {return this.cm},\n\n    splitLines: function(str) {\n      if (this.lineSep) { return str.split(this.lineSep) }\n      return splitLinesAuto(str)\n    },\n    lineSeparator: function() { return this.lineSep || \"\\n\" },\n\n    setDirection: docMethodOp(function (dir) {\n      if (dir != \"rtl\") { dir = \"ltr\"; }\n      if (dir == this.direction) { return }\n      this.direction = dir;\n      this.iter(function (line) { return line.order = null; });\n      if (this.cm) { directionChanged(this.cm); }\n    })\n  });\n\n  // Public alias.\n  Doc.prototype.eachLine = Doc.prototype.iter;\n\n  // Kludge to work around strange IE behavior where it'll sometimes\n  // re-fire a series of drag-related events right after the drop (#1551)\n  var lastDrop = 0;\n\n  function onDrop(e) {\n    var cm = this;\n    clearDragCursor(cm);\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n      { return }\n    e_preventDefault(e);\n    if (ie) { lastDrop = +new Date; }\n    var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n    if (!pos || cm.isReadOnly()) { return }\n    // Might be a file drop, in which case we simply extract the text\n    // and insert it.\n    if (files && files.length && window.FileReader && window.File) {\n      var n = files.length, text = Array(n), read = 0;\n      var markAsReadAndPasteIfAllFilesAreRead = function () {\n        if (++read == n) {\n          operation(cm, function () {\n            pos = clipPos(cm.doc, pos);\n            var change = {from: pos, to: pos,\n                          text: cm.doc.splitLines(\n                              text.filter(function (t) { return t != null; }).join(cm.doc.lineSeparator())),\n                          origin: \"paste\"};\n            makeChange(cm.doc, change);\n            setSelectionReplaceHistory(cm.doc, simpleSelection(clipPos(cm.doc, pos), clipPos(cm.doc, changeEnd(change))));\n          })();\n        }\n      };\n      var readTextFromFile = function (file, i) {\n        if (cm.options.allowDropFileTypes &&\n            indexOf(cm.options.allowDropFileTypes, file.type) == -1) {\n          markAsReadAndPasteIfAllFilesAreRead();\n          return\n        }\n        var reader = new FileReader;\n        reader.onerror = function () { return markAsReadAndPasteIfAllFilesAreRead(); };\n        reader.onload = function () {\n          var content = reader.result;\n          if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) {\n            markAsReadAndPasteIfAllFilesAreRead();\n            return\n          }\n          text[i] = content;\n          markAsReadAndPasteIfAllFilesAreRead();\n        };\n        reader.readAsText(file);\n      };\n      for (var i = 0; i < files.length; i++) { readTextFromFile(files[i], i); }\n    } else { // Normal drop\n      // Don't do a replace if the drop happened inside of the selected text.\n      if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n        cm.state.draggingText(e);\n        // Ensure the editor is re-focused\n        setTimeout(function () { return cm.display.input.focus(); }, 20);\n        return\n      }\n      try {\n        var text$1 = e.dataTransfer.getData(\"Text\");\n        if (text$1) {\n          var selected;\n          if (cm.state.draggingText && !cm.state.draggingText.copy)\n            { selected = cm.listSelections(); }\n          setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n          if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\n            { replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\"); } }\n          cm.replaceSelection(text$1, \"around\", \"paste\");\n          cm.display.input.focus();\n        }\n      }\n      catch(e){}\n    }\n  }\n\n  function onDragStart(cm, e) {\n    if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\n\n    e.dataTransfer.setData(\"Text\", cm.getSelection());\n    e.dataTransfer.effectAllowed = \"copyMove\";\n\n    // Use dummy image instead of default browsers image.\n    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n    if (e.dataTransfer.setDragImage && !safari) {\n      var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n      img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n      if (presto) {\n        img.width = img.height = 1;\n        cm.display.wrapper.appendChild(img);\n        // Force a relayout, or Opera won't use our image for some obscure reason\n        img._top = img.offsetTop;\n      }\n      e.dataTransfer.setDragImage(img, 0, 0);\n      if (presto) { img.parentNode.removeChild(img); }\n    }\n  }\n\n  function onDragOver(cm, e) {\n    var pos = posFromMouse(cm, e);\n    if (!pos) { return }\n    var frag = document.createDocumentFragment();\n    drawSelectionCursor(cm, pos, frag);\n    if (!cm.display.dragCursor) {\n      cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n      cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n    }\n    removeChildrenAndAdd(cm.display.dragCursor, frag);\n  }\n\n  function clearDragCursor(cm) {\n    if (cm.display.dragCursor) {\n      cm.display.lineSpace.removeChild(cm.display.dragCursor);\n      cm.display.dragCursor = null;\n    }\n  }\n\n  // These must be handled carefully, because naively registering a\n  // handler for each editor will cause the editors to never be\n  // garbage collected.\n\n  function forEachCodeMirror(f) {\n    if (!document.getElementsByClassName) { return }\n    var byClass = document.getElementsByClassName(\"CodeMirror\"), editors = [];\n    for (var i = 0; i < byClass.length; i++) {\n      var cm = byClass[i].CodeMirror;\n      if (cm) { editors.push(cm); }\n    }\n    if (editors.length) { editors[0].operation(function () {\n      for (var i = 0; i < editors.length; i++) { f(editors[i]); }\n    }); }\n  }\n\n  var globalsRegistered = false;\n  function ensureGlobalHandlers() {\n    if (globalsRegistered) { return }\n    registerGlobalHandlers();\n    globalsRegistered = true;\n  }\n  function registerGlobalHandlers() {\n    // When the window resizes, we need to refresh active editors.\n    var resizeTimer;\n    on(window, \"resize\", function () {\n      if (resizeTimer == null) { resizeTimer = setTimeout(function () {\n        resizeTimer = null;\n        forEachCodeMirror(onResize);\n      }, 100); }\n    });\n    // When the window loses focus, we want to show the editor as blurred\n    on(window, \"blur\", function () { return forEachCodeMirror(onBlur); });\n  }\n  // Called when the window resizes\n  function onResize(cm) {\n    var d = cm.display;\n    // Might be a text scaling operation, clear size caches.\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n    d.scrollbarsClipped = false;\n    cm.setSize();\n  }\n\n  var keyNames = {\n    3: \"Pause\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n    19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n    36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n    46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\n    106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 145: \"ScrollLock\",\n    173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n    221: \"]\", 222: \"'\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n    63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\n  };\n\n  // Number keys\n  for (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i); }\n  // Alphabetic keys\n  for (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1); }\n  // Function keys\n  for (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2; }\n\n  var keyMap = {};\n\n  keyMap.basic = {\n    \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n    \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n    \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n    \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n    \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n    \"Esc\": \"singleSelection\"\n  };\n  // Note that the save and find-related commands aren't defined by\n  // default. User code or addons can define them. Unknown commands\n  // are simply ignored.\n  keyMap.pcDefault = {\n    \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n    \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n    \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n    \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n    \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n    \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n    \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n    \"fallthrough\": \"basic\"\n  };\n  // Very basic readline/emacs-style bindings, which are standard on Mac.\n  keyMap.emacsy = {\n    \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n    \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\n    \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\n    \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\",\n    \"Ctrl-O\": \"openLine\"\n  };\n  keyMap.macDefault = {\n    \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n    \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n    \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n    \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n    \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n    \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n    \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n    \"fallthrough\": [\"basic\", \"emacsy\"]\n  };\n  keyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n  // KEYMAP DISPATCH\n\n  function normalizeKeyName(name) {\n    var parts = name.split(/-(?!$)/);\n    name = parts[parts.length - 1];\n    var alt, ctrl, shift, cmd;\n    for (var i = 0; i < parts.length - 1; i++) {\n      var mod = parts[i];\n      if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true; }\n      else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n      else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n      else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n      else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n    }\n    if (alt) { name = \"Alt-\" + name; }\n    if (ctrl) { name = \"Ctrl-\" + name; }\n    if (cmd) { name = \"Cmd-\" + name; }\n    if (shift) { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // This is a kludge to keep keymaps mostly working as raw objects\n  // (backwards compatibility) while at the same time support features\n  // like normalization and multi-stroke key bindings. It compiles a\n  // new normalized keymap, and then updates the old object to reflect\n  // this.\n  function normalizeKeyMap(keymap) {\n    var copy = {};\n    for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\n      var value = keymap[keyname];\n      if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\n      if (value == \"...\") { delete keymap[keyname]; continue }\n\n      var keys = map(keyname.split(\" \"), normalizeKeyName);\n      for (var i = 0; i < keys.length; i++) {\n        var val = (void 0), name = (void 0);\n        if (i == keys.length - 1) {\n          name = keys.join(\" \");\n          val = value;\n        } else {\n          name = keys.slice(0, i + 1).join(\" \");\n          val = \"...\";\n        }\n        var prev = copy[name];\n        if (!prev) { copy[name] = val; }\n        else if (prev != val) { throw new Error(\"Inconsistent bindings for \" + name) }\n      }\n      delete keymap[keyname];\n    } }\n    for (var prop in copy) { keymap[prop] = copy[prop]; }\n    return keymap\n  }\n\n  function lookupKey(key, map, handle, context) {\n    map = getKeyMap(map);\n    var found = map.call ? map.call(key, context) : map[key];\n    if (found === false) { return \"nothing\" }\n    if (found === \"...\") { return \"multi\" }\n    if (found != null && handle(found)) { return \"handled\" }\n\n    if (map.fallthrough) {\n      if (Object.prototype.toString.call(map.fallthrough) != \"[object Array]\")\n        { return lookupKey(key, map.fallthrough, handle, context) }\n      for (var i = 0; i < map.fallthrough.length; i++) {\n        var result = lookupKey(key, map.fallthrough[i], handle, context);\n        if (result) { return result }\n      }\n    }\n  }\n\n  // Modifier key presses don't count as 'real' key presses for the\n  // purpose of keymap fallthrough.\n  function isModifierKey(value) {\n    var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n    return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\"\n  }\n\n  function addModifierNames(name, event, noShift) {\n    var base = name;\n    if (event.altKey && base != \"Alt\") { name = \"Alt-\" + name; }\n    if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") { name = \"Ctrl-\" + name; }\n    if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Cmd\") { name = \"Cmd-\" + name; }\n    if (!noShift && event.shiftKey && base != \"Shift\") { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // Look up the name of a key as indicated by an event object.\n  function keyName(event, noShift) {\n    if (presto && event.keyCode == 34 && event[\"char\"]) { return false }\n    var name = keyNames[event.keyCode];\n    if (name == null || event.altGraphKey) { return false }\n    // Ctrl-ScrollLock has keyCode 3, same as Ctrl-Pause,\n    // so we'll use event.code when available (Chrome 48+, FF 38+, Safari 10.1+)\n    if (event.keyCode == 3 && event.code) { name = event.code; }\n    return addModifierNames(name, event, noShift)\n  }\n\n  function getKeyMap(val) {\n    return typeof val == \"string\" ? keyMap[val] : val\n  }\n\n  // Helper for deleting text near the selection(s), used to implement\n  // backspace, delete, and similar functionality.\n  function deleteNearSelection(cm, compute) {\n    var ranges = cm.doc.sel.ranges, kill = [];\n    // Build up a set of ranges to kill first, merging overlapping\n    // ranges.\n    for (var i = 0; i < ranges.length; i++) {\n      var toKill = compute(ranges[i]);\n      while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n        var replaced = kill.pop();\n        if (cmp(replaced.from, toKill.from) < 0) {\n          toKill.from = replaced.from;\n          break\n        }\n      }\n      kill.push(toKill);\n    }\n    // Next, remove those actual ranges.\n    runInOp(cm, function () {\n      for (var i = kill.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\"); }\n      ensureCursorVisible(cm);\n    });\n  }\n\n  function moveCharLogically(line, ch, dir) {\n    var target = skipExtendingChars(line.text, ch + dir, dir);\n    return target < 0 || target > line.text.length ? null : target\n  }\n\n  function moveLogically(line, start, dir) {\n    var ch = moveCharLogically(line, start.ch, dir);\n    return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\")\n  }\n\n  function endOfLine(visually, cm, lineObj, lineNo, dir) {\n    if (visually) {\n      if (cm.doc.direction == \"rtl\") { dir = -dir; }\n      var order = getOrder(lineObj, cm.doc.direction);\n      if (order) {\n        var part = dir < 0 ? lst(order) : order[0];\n        var moveInStorageOrder = (dir < 0) == (part.level == 1);\n        var sticky = moveInStorageOrder ? \"after\" : \"before\";\n        var ch;\n        // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n        // it could be that the last bidi part is not on the last visual line,\n        // since visual lines contain content order-consecutive chunks.\n        // Thus, in rtl, we are looking for the first (content-order) character\n        // in the rtl chunk that is on the last line (that is, the same line\n        // as the last (content-order) character).\n        if (part.level > 0 || cm.doc.direction == \"rtl\") {\n          var prep = prepareMeasureForLine(cm, lineObj);\n          ch = dir < 0 ? lineObj.text.length - 1 : 0;\n          var targetTop = measureCharPrepared(cm, prep, ch).top;\n          ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch);\n          if (sticky == \"before\") { ch = moveCharLogically(lineObj, ch, 1); }\n        } else { ch = dir < 0 ? part.to : part.from; }\n        return new Pos(lineNo, ch, sticky)\n      }\n    }\n    return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\")\n  }\n\n  function moveVisually(cm, line, start, dir) {\n    var bidi = getOrder(line, cm.doc.direction);\n    if (!bidi) { return moveLogically(line, start, dir) }\n    if (start.ch >= line.text.length) {\n      start.ch = line.text.length;\n      start.sticky = \"before\";\n    } else if (start.ch <= 0) {\n      start.ch = 0;\n      start.sticky = \"after\";\n    }\n    var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos];\n    if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n      // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n      // nothing interesting happens.\n      return moveLogically(line, start, dir)\n    }\n\n    var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); };\n    var prep;\n    var getWrappedLineExtent = function (ch) {\n      if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\n      prep = prep || prepareMeasureForLine(cm, line);\n      return wrappedLineExtentChar(cm, line, prep, ch)\n    };\n    var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n    if (cm.doc.direction == \"rtl\" || part.level == 1) {\n      var moveInStorageOrder = (part.level == 1) == (dir < 0);\n      var ch = mv(start, moveInStorageOrder ? 1 : -1);\n      if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n        // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n        var sticky = moveInStorageOrder ? \"before\" : \"after\";\n        return new Pos(start.line, ch, sticky)\n      }\n    }\n\n    // Case 3: Could not move within this bidi part in this visual line, so leave\n    // the current bidi part\n\n    var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\n      var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\n        ? new Pos(start.line, mv(ch, 1), \"before\")\n        : new Pos(start.line, ch, \"after\"); };\n\n      for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n        var part = bidi[partPos];\n        var moveInStorageOrder = (dir > 0) == (part.level != 1);\n        var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n        if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\n        ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n        if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\n      }\n    };\n\n    // Case 3a: Look for other bidi parts on the same visual line\n    var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n    if (res) { return res }\n\n    // Case 3b: Look for other bidi parts on the next visual line\n    var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n    if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n      res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n      if (res) { return res }\n    }\n\n    // Case 4: Nowhere to move\n    return null\n  }\n\n  // Commands are parameter-less actions that can be performed on an\n  // editor, mostly used for keybindings.\n  var commands = {\n    selectAll: selectAll,\n    singleSelection: function (cm) { return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll); },\n    killLine: function (cm) { return deleteNearSelection(cm, function (range) {\n      if (range.empty()) {\n        var len = getLine(cm.doc, range.head.line).text.length;\n        if (range.head.ch == len && range.head.line < cm.lastLine())\n          { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\n        else\n          { return {from: range.head, to: Pos(range.head.line, len)} }\n      } else {\n        return {from: range.from(), to: range.to()}\n      }\n    }); },\n    deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0),\n      to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\n    }); }); },\n    delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0), to: range.from()\n    }); }); },\n    delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n      return {from: leftPos, to: range.from()}\n    }); },\n    delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n      return {from: range.from(), to: rightPos }\n    }); },\n    undo: function (cm) { return cm.undo(); },\n    redo: function (cm) { return cm.redo(); },\n    undoSelection: function (cm) { return cm.undoSelection(); },\n    redoSelection: function (cm) { return cm.redoSelection(); },\n    goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\n    goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\n    goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\n      {origin: \"+move\", bias: -1}\n    ); },\n    goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: 0, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n      if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\n      return pos\n    }, sel_move); },\n    goLineUp: function (cm) { return cm.moveV(-1, \"line\"); },\n    goLineDown: function (cm) { return cm.moveV(1, \"line\"); },\n    goPageUp: function (cm) { return cm.moveV(-1, \"page\"); },\n    goPageDown: function (cm) { return cm.moveV(1, \"page\"); },\n    goCharLeft: function (cm) { return cm.moveH(-1, \"char\"); },\n    goCharRight: function (cm) { return cm.moveH(1, \"char\"); },\n    goColumnLeft: function (cm) { return cm.moveH(-1, \"column\"); },\n    goColumnRight: function (cm) { return cm.moveH(1, \"column\"); },\n    goWordLeft: function (cm) { return cm.moveH(-1, \"word\"); },\n    goGroupRight: function (cm) { return cm.moveH(1, \"group\"); },\n    goGroupLeft: function (cm) { return cm.moveH(-1, \"group\"); },\n    goWordRight: function (cm) { return cm.moveH(1, \"word\"); },\n    delCharBefore: function (cm) { return cm.deleteH(-1, \"char\"); },\n    delCharAfter: function (cm) { return cm.deleteH(1, \"char\"); },\n    delWordBefore: function (cm) { return cm.deleteH(-1, \"word\"); },\n    delWordAfter: function (cm) { return cm.deleteH(1, \"word\"); },\n    delGroupBefore: function (cm) { return cm.deleteH(-1, \"group\"); },\n    delGroupAfter: function (cm) { return cm.deleteH(1, \"group\"); },\n    indentAuto: function (cm) { return cm.indentSelection(\"smart\"); },\n    indentMore: function (cm) { return cm.indentSelection(\"add\"); },\n    indentLess: function (cm) { return cm.indentSelection(\"subtract\"); },\n    insertTab: function (cm) { return cm.replaceSelection(\"\\t\"); },\n    insertSoftTab: function (cm) {\n      var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n      for (var i = 0; i < ranges.length; i++) {\n        var pos = ranges[i].from();\n        var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n        spaces.push(spaceStr(tabSize - col % tabSize));\n      }\n      cm.replaceSelections(spaces);\n    },\n    defaultTab: function (cm) {\n      if (cm.somethingSelected()) { cm.indentSelection(\"add\"); }\n      else { cm.execCommand(\"insertTab\"); }\n    },\n    // Swap the two chars left and right of each selection's head.\n    // Move cursor behind the two swapped characters afterwards.\n    //\n    // Doesn't consider line feeds a character.\n    // Doesn't scan more than one line above to find a character.\n    // Doesn't do anything on an empty line.\n    // Doesn't do anything with non-empty selections.\n    transposeChars: function (cm) { return runInOp(cm, function () {\n      var ranges = cm.listSelections(), newSel = [];\n      for (var i = 0; i < ranges.length; i++) {\n        if (!ranges[i].empty()) { continue }\n        var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n        if (line) {\n          if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1); }\n          if (cur.ch > 0) {\n            cur = new Pos(cur.line, cur.ch + 1);\n            cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                            Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n          } else if (cur.line > cm.doc.first) {\n            var prev = getLine(cm.doc, cur.line - 1).text;\n            if (prev) {\n              cur = new Pos(cur.line, 1);\n              cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\n                              prev.charAt(prev.length - 1),\n                              Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n            }\n          }\n        }\n        newSel.push(new Range(cur, cur));\n      }\n      cm.setSelections(newSel);\n    }); },\n    newlineAndIndent: function (cm) { return runInOp(cm, function () {\n      var sels = cm.listSelections();\n      for (var i = sels.length - 1; i >= 0; i--)\n        { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\"); }\n      sels = cm.listSelections();\n      for (var i$1 = 0; i$1 < sels.length; i$1++)\n        { cm.indentLine(sels[i$1].from().line, null, true); }\n      ensureCursorVisible(cm);\n    }); },\n    openLine: function (cm) { return cm.replaceSelection(\"\\n\", \"start\"); },\n    toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\n  };\n\n\n  function lineStart(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLine(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, visual, lineN, 1)\n  }\n  function lineEnd(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLineEnd(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, line, lineN, -1)\n  }\n  function lineStartSmart(cm, pos) {\n    var start = lineStart(cm, pos.line);\n    var line = getLine(cm.doc, start.line);\n    var order = getOrder(line, cm.doc.direction);\n    if (!order || order[0].level == 0) {\n      var firstNonWS = Math.max(start.ch, line.text.search(/\\S/));\n      var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n      return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\n    }\n    return start\n  }\n\n  // Run a handler that was bound to a key.\n  function doHandleBinding(cm, bound, dropShift) {\n    if (typeof bound == \"string\") {\n      bound = commands[bound];\n      if (!bound) { return false }\n    }\n    // Ensure previous input has been read, so that the handler sees a\n    // consistent view of the document\n    cm.display.input.ensurePolled();\n    var prevShift = cm.display.shift, done = false;\n    try {\n      if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n      if (dropShift) { cm.display.shift = false; }\n      done = bound(cm) != Pass;\n    } finally {\n      cm.display.shift = prevShift;\n      cm.state.suppressEdits = false;\n    }\n    return done\n  }\n\n  function lookupKeyForEditor(cm, name, handle) {\n    for (var i = 0; i < cm.state.keyMaps.length; i++) {\n      var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n      if (result) { return result }\n    }\n    return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\n      || lookupKey(name, cm.options.keyMap, handle, cm)\n  }\n\n  // Note that, despite the name, this function is also used to check\n  // for bound mouse clicks.\n\n  var stopSeq = new Delayed;\n\n  function dispatchKey(cm, name, e, handle) {\n    var seq = cm.state.keySeq;\n    if (seq) {\n      if (isModifierKey(name)) { return \"handled\" }\n      if (/\\'$/.test(name))\n        { cm.state.keySeq = null; }\n      else\n        { stopSeq.set(50, function () {\n          if (cm.state.keySeq == seq) {\n            cm.state.keySeq = null;\n            cm.display.input.reset();\n          }\n        }); }\n      if (dispatchKeyInner(cm, seq + \" \" + name, e, handle)) { return true }\n    }\n    return dispatchKeyInner(cm, name, e, handle)\n  }\n\n  function dispatchKeyInner(cm, name, e, handle) {\n    var result = lookupKeyForEditor(cm, name, handle);\n\n    if (result == \"multi\")\n      { cm.state.keySeq = name; }\n    if (result == \"handled\")\n      { signalLater(cm, \"keyHandled\", cm, name, e); }\n\n    if (result == \"handled\" || result == \"multi\") {\n      e_preventDefault(e);\n      restartBlink(cm);\n    }\n\n    return !!result\n  }\n\n  // Handle a key from the keydown event.\n  function handleKeyBinding(cm, e) {\n    var name = keyName(e, true);\n    if (!name) { return false }\n\n    if (e.shiftKey && !cm.state.keySeq) {\n      // First try to resolve full name (including 'Shift-'). Failing\n      // that, see if there is a cursor-motion command (starting with\n      // 'go') bound to the keyname without 'Shift-'.\n      return dispatchKey(cm, \"Shift-\" + name, e, function (b) { return doHandleBinding(cm, b, true); })\n          || dispatchKey(cm, name, e, function (b) {\n               if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n                 { return doHandleBinding(cm, b) }\n             })\n    } else {\n      return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\n    }\n  }\n\n  // Handle a key from the keypress event\n  function handleCharBinding(cm, e, ch) {\n    return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) { return doHandleBinding(cm, b, true); })\n  }\n\n  var lastStoppedKey = null;\n  function onKeyDown(e) {\n    var cm = this;\n    cm.curOp.focus = activeElt();\n    if (signalDOMEvent(cm, e)) { return }\n    // IE does strange things with escape.\n    if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false; }\n    var code = e.keyCode;\n    cm.display.shift = code == 16 || e.shiftKey;\n    var handled = handleKeyBinding(cm, e);\n    if (presto) {\n      lastStoppedKey = handled ? code : null;\n      // Opera has no cut event... we try to at least catch the key combo\n      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n        { cm.replaceSelection(\"\", null, \"cut\"); }\n    }\n    if (gecko && !mac && !handled && code == 46 && e.shiftKey && !e.ctrlKey && document.execCommand)\n      { document.execCommand(\"cut\"); }\n\n    // Turn mouse into crosshair when Alt is held on Mac.\n    if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n      { showCrossHair(cm); }\n  }\n\n  function showCrossHair(cm) {\n    var lineDiv = cm.display.lineDiv;\n    addClass(lineDiv, \"CodeMirror-crosshair\");\n\n    function up(e) {\n      if (e.keyCode == 18 || !e.altKey) {\n        rmClass(lineDiv, \"CodeMirror-crosshair\");\n        off(document, \"keyup\", up);\n        off(document, \"mouseover\", up);\n      }\n    }\n    on(document, \"keyup\", up);\n    on(document, \"mouseover\", up);\n  }\n\n  function onKeyUp(e) {\n    if (e.keyCode == 16) { this.doc.sel.shift = false; }\n    signalDOMEvent(this, e);\n  }\n\n  function onKeyPress(e) {\n    var cm = this;\n    if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\n    var keyCode = e.keyCode, charCode = e.charCode;\n    if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\n    if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\n    var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n    // Some browsers fire keypress events for backspace\n    if (ch == \"\\x08\") { return }\n    if (handleCharBinding(cm, e, ch)) { return }\n    cm.display.input.onKeyPress(e);\n  }\n\n  var DOUBLECLICK_DELAY = 400;\n\n  var PastClick = function(time, pos, button) {\n    this.time = time;\n    this.pos = pos;\n    this.button = button;\n  };\n\n  PastClick.prototype.compare = function (time, pos, button) {\n    return this.time + DOUBLECLICK_DELAY > time &&\n      cmp(pos, this.pos) == 0 && button == this.button\n  };\n\n  var lastClick, lastDoubleClick;\n  function clickRepeat(pos, button) {\n    var now = +new Date;\n    if (lastDoubleClick && lastDoubleClick.compare(now, pos, button)) {\n      lastClick = lastDoubleClick = null;\n      return \"triple\"\n    } else if (lastClick && lastClick.compare(now, pos, button)) {\n      lastDoubleClick = new PastClick(now, pos, button);\n      lastClick = null;\n      return \"double\"\n    } else {\n      lastClick = new PastClick(now, pos, button);\n      lastDoubleClick = null;\n      return \"single\"\n    }\n  }\n\n  // A mouse down can be a single click, double click, triple click,\n  // start of selection drag, start of text drag, new cursor\n  // (ctrl-click), rectangle drag (alt-drag), or xwin\n  // middle-click-paste. Or it might be a click on something we should\n  // not interfere with, such as a scrollbar or widget.\n  function onMouseDown(e) {\n    var cm = this, display = cm.display;\n    if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\n    display.input.ensurePolled();\n    display.shift = e.shiftKey;\n\n    if (eventInWidget(display, e)) {\n      if (!webkit) {\n        // Briefly turn off draggability, to allow widgets to do\n        // normal dragging things.\n        display.scroller.draggable = false;\n        setTimeout(function () { return display.scroller.draggable = true; }, 100);\n      }\n      return\n    }\n    if (clickInGutter(cm, e)) { return }\n    var pos = posFromMouse(cm, e), button = e_button(e), repeat = pos ? clickRepeat(pos, button) : \"single\";\n    window.focus();\n\n    // #3261: make sure, that we're not starting a second selection\n    if (button == 1 && cm.state.selectingText)\n      { cm.state.selectingText(e); }\n\n    if (pos && handleMappedButton(cm, button, pos, repeat, e)) { return }\n\n    if (button == 1) {\n      if (pos) { leftButtonDown(cm, pos, repeat, e); }\n      else if (e_target(e) == display.scroller) { e_preventDefault(e); }\n    } else if (button == 2) {\n      if (pos) { extendSelection(cm.doc, pos); }\n      setTimeout(function () { return display.input.focus(); }, 20);\n    } else if (button == 3) {\n      if (captureRightClick) { cm.display.input.onContextMenu(e); }\n      else { delayBlurEvent(cm); }\n    }\n  }\n\n  function handleMappedButton(cm, button, pos, repeat, event) {\n    var name = \"Click\";\n    if (repeat == \"double\") { name = \"Double\" + name; }\n    else if (repeat == \"triple\") { name = \"Triple\" + name; }\n    name = (button == 1 ? \"Left\" : button == 2 ? \"Middle\" : \"Right\") + name;\n\n    return dispatchKey(cm,  addModifierNames(name, event), event, function (bound) {\n      if (typeof bound == \"string\") { bound = commands[bound]; }\n      if (!bound) { return false }\n      var done = false;\n      try {\n        if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n        done = bound(cm, pos) != Pass;\n      } finally {\n        cm.state.suppressEdits = false;\n      }\n      return done\n    })\n  }\n\n  function configureMouse(cm, repeat, event) {\n    var option = cm.getOption(\"configureMouse\");\n    var value = option ? option(cm, repeat, event) : {};\n    if (value.unit == null) {\n      var rect = chromeOS ? event.shiftKey && event.metaKey : event.altKey;\n      value.unit = rect ? \"rectangle\" : repeat == \"single\" ? \"char\" : repeat == \"double\" ? \"word\" : \"line\";\n    }\n    if (value.extend == null || cm.doc.extend) { value.extend = cm.doc.extend || event.shiftKey; }\n    if (value.addNew == null) { value.addNew = mac ? event.metaKey : event.ctrlKey; }\n    if (value.moveOnDrag == null) { value.moveOnDrag = !(mac ? event.altKey : event.ctrlKey); }\n    return value\n  }\n\n  function leftButtonDown(cm, pos, repeat, event) {\n    if (ie) { setTimeout(bind(ensureFocus, cm), 0); }\n    else { cm.curOp.focus = activeElt(); }\n\n    var behavior = configureMouse(cm, repeat, event);\n\n    var sel = cm.doc.sel, contained;\n    if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\n        repeat == \"single\" && (contained = sel.contains(pos)) > -1 &&\n        (cmp((contained = sel.ranges[contained]).from(), pos) < 0 || pos.xRel > 0) &&\n        (cmp(contained.to(), pos) > 0 || pos.xRel < 0))\n      { leftButtonStartDrag(cm, event, pos, behavior); }\n    else\n      { leftButtonSelect(cm, event, pos, behavior); }\n  }\n\n  // Start a text drag. When it ends, see if any dragging actually\n  // happen, and treat as a click if it didn't.\n  function leftButtonStartDrag(cm, event, pos, behavior) {\n    var display = cm.display, moved = false;\n    var dragEnd = operation(cm, function (e) {\n      if (webkit) { display.scroller.draggable = false; }\n      cm.state.draggingText = false;\n      off(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n      off(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n      off(display.scroller, \"dragstart\", dragStart);\n      off(display.scroller, \"drop\", dragEnd);\n      if (!moved) {\n        e_preventDefault(e);\n        if (!behavior.addNew)\n          { extendSelection(cm.doc, pos, null, null, behavior.extend); }\n        // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n        if (webkit || ie && ie_version == 9)\n          { setTimeout(function () {display.wrapper.ownerDocument.body.focus(); display.input.focus();}, 20); }\n        else\n          { display.input.focus(); }\n      }\n    });\n    var mouseMove = function(e2) {\n      moved = moved || Math.abs(event.clientX - e2.clientX) + Math.abs(event.clientY - e2.clientY) >= 10;\n    };\n    var dragStart = function () { return moved = true; };\n    // Let the drag handler handle this.\n    if (webkit) { display.scroller.draggable = true; }\n    cm.state.draggingText = dragEnd;\n    dragEnd.copy = !behavior.moveOnDrag;\n    // IE's approach to draggable\n    if (display.scroller.dragDrop) { display.scroller.dragDrop(); }\n    on(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n    on(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n    on(display.scroller, \"dragstart\", dragStart);\n    on(display.scroller, \"drop\", dragEnd);\n\n    delayBlurEvent(cm);\n    setTimeout(function () { return display.input.focus(); }, 20);\n  }\n\n  function rangeForUnit(cm, pos, unit) {\n    if (unit == \"char\") { return new Range(pos, pos) }\n    if (unit == \"word\") { return cm.findWordAt(pos) }\n    if (unit == \"line\") { return new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))) }\n    var result = unit(cm, pos);\n    return new Range(result.from, result.to)\n  }\n\n  // Normal selection, as opposed to text dragging.\n  function leftButtonSelect(cm, event, start, behavior) {\n    var display = cm.display, doc = cm.doc;\n    e_preventDefault(event);\n\n    var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\n    if (behavior.addNew && !behavior.extend) {\n      ourIndex = doc.sel.contains(start);\n      if (ourIndex > -1)\n        { ourRange = ranges[ourIndex]; }\n      else\n        { ourRange = new Range(start, start); }\n    } else {\n      ourRange = doc.sel.primary();\n      ourIndex = doc.sel.primIndex;\n    }\n\n    if (behavior.unit == \"rectangle\") {\n      if (!behavior.addNew) { ourRange = new Range(start, start); }\n      start = posFromMouse(cm, event, true, true);\n      ourIndex = -1;\n    } else {\n      var range = rangeForUnit(cm, start, behavior.unit);\n      if (behavior.extend)\n        { ourRange = extendRange(ourRange, range.anchor, range.head, behavior.extend); }\n      else\n        { ourRange = range; }\n    }\n\n    if (!behavior.addNew) {\n      ourIndex = 0;\n      setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n      startSel = doc.sel;\n    } else if (ourIndex == -1) {\n      ourIndex = ranges.length;\n      setSelection(doc, normalizeSelection(cm, ranges.concat([ourRange]), ourIndex),\n                   {scroll: false, origin: \"*mouse\"});\n    } else if (ranges.length > 1 && ranges[ourIndex].empty() && behavior.unit == \"char\" && !behavior.extend) {\n      setSelection(doc, normalizeSelection(cm, ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\n                   {scroll: false, origin: \"*mouse\"});\n      startSel = doc.sel;\n    } else {\n      replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n    }\n\n    var lastPos = start;\n    function extendTo(pos) {\n      if (cmp(lastPos, pos) == 0) { return }\n      lastPos = pos;\n\n      if (behavior.unit == \"rectangle\") {\n        var ranges = [], tabSize = cm.options.tabSize;\n        var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n        var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n        var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n        for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n             line <= end; line++) {\n          var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n          if (left == right)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))); }\n          else if (text.length > leftPos)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))); }\n        }\n        if (!ranges.length) { ranges.push(new Range(start, start)); }\n        setSelection(doc, normalizeSelection(cm, startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                     {origin: \"*mouse\", scroll: false});\n        cm.scrollIntoView(pos);\n      } else {\n        var oldRange = ourRange;\n        var range = rangeForUnit(cm, pos, behavior.unit);\n        var anchor = oldRange.anchor, head;\n        if (cmp(range.anchor, anchor) > 0) {\n          head = range.head;\n          anchor = minPos(oldRange.from(), range.anchor);\n        } else {\n          head = range.anchor;\n          anchor = maxPos(oldRange.to(), range.head);\n        }\n        var ranges$1 = startSel.ranges.slice(0);\n        ranges$1[ourIndex] = bidiSimplify(cm, new Range(clipPos(doc, anchor), head));\n        setSelection(doc, normalizeSelection(cm, ranges$1, ourIndex), sel_mouse);\n      }\n    }\n\n    var editorSize = display.wrapper.getBoundingClientRect();\n    // Used to ensure timeout re-tries don't fire when another extend\n    // happened in the meantime (clearTimeout isn't reliable -- at\n    // least on Chrome, the timeouts still happen even when cleared,\n    // if the clear happens after their scheduled firing time).\n    var counter = 0;\n\n    function extend(e) {\n      var curCount = ++counter;\n      var cur = posFromMouse(cm, e, true, behavior.unit == \"rectangle\");\n      if (!cur) { return }\n      if (cmp(cur, lastPos) != 0) {\n        cm.curOp.focus = activeElt();\n        extendTo(cur);\n        var visible = visibleLines(display, doc);\n        if (cur.line >= visible.to || cur.line < visible.from)\n          { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e); }}), 150); }\n      } else {\n        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n        if (outside) { setTimeout(operation(cm, function () {\n          if (counter != curCount) { return }\n          display.scroller.scrollTop += outside;\n          extend(e);\n        }), 50); }\n      }\n    }\n\n    function done(e) {\n      cm.state.selectingText = false;\n      counter = Infinity;\n      // If e is null or undefined we interpret this as someone trying\n      // to explicitly cancel the selection rather than the user\n      // letting go of the mouse button.\n      if (e) {\n        e_preventDefault(e);\n        display.input.focus();\n      }\n      off(display.wrapper.ownerDocument, \"mousemove\", move);\n      off(display.wrapper.ownerDocument, \"mouseup\", up);\n      doc.history.lastSelOrigin = null;\n    }\n\n    var move = operation(cm, function (e) {\n      if (e.buttons === 0 || !e_button(e)) { done(e); }\n      else { extend(e); }\n    });\n    var up = operation(cm, done);\n    cm.state.selectingText = up;\n    on(display.wrapper.ownerDocument, \"mousemove\", move);\n    on(display.wrapper.ownerDocument, \"mouseup\", up);\n  }\n\n  // Used when mouse-selecting to adjust the anchor to the proper side\n  // of a bidi jump depending on the visual position of the head.\n  function bidiSimplify(cm, range) {\n    var anchor = range.anchor;\n    var head = range.head;\n    var anchorLine = getLine(cm.doc, anchor.line);\n    if (cmp(anchor, head) == 0 && anchor.sticky == head.sticky) { return range }\n    var order = getOrder(anchorLine);\n    if (!order) { return range }\n    var index = getBidiPartAt(order, anchor.ch, anchor.sticky), part = order[index];\n    if (part.from != anchor.ch && part.to != anchor.ch) { return range }\n    var boundary = index + ((part.from == anchor.ch) == (part.level != 1) ? 0 : 1);\n    if (boundary == 0 || boundary == order.length) { return range }\n\n    // Compute the relative visual position of the head compared to the\n    // anchor (<0 is to the left, >0 to the right)\n    var leftSide;\n    if (head.line != anchor.line) {\n      leftSide = (head.line - anchor.line) * (cm.doc.direction == \"ltr\" ? 1 : -1) > 0;\n    } else {\n      var headIndex = getBidiPartAt(order, head.ch, head.sticky);\n      var dir = headIndex - index || (head.ch - anchor.ch) * (part.level == 1 ? -1 : 1);\n      if (headIndex == boundary - 1 || headIndex == boundary)\n        { leftSide = dir < 0; }\n      else\n        { leftSide = dir > 0; }\n    }\n\n    var usePart = order[boundary + (leftSide ? -1 : 0)];\n    var from = leftSide == (usePart.level == 1);\n    var ch = from ? usePart.from : usePart.to, sticky = from ? \"after\" : \"before\";\n    return anchor.ch == ch && anchor.sticky == sticky ? range : new Range(new Pos(anchor.line, ch, sticky), head)\n  }\n\n\n  // Determines whether an event happened in the gutter, and fires the\n  // handlers for the corresponding event.\n  function gutterEvent(cm, e, type, prevent) {\n    var mX, mY;\n    if (e.touches) {\n      mX = e.touches[0].clientX;\n      mY = e.touches[0].clientY;\n    } else {\n      try { mX = e.clientX; mY = e.clientY; }\n      catch(e) { return false }\n    }\n    if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\n    if (prevent) { e_preventDefault(e); }\n\n    var display = cm.display;\n    var lineBox = display.lineDiv.getBoundingClientRect();\n\n    if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\n    mY -= lineBox.top - display.viewOffset;\n\n    for (var i = 0; i < cm.display.gutterSpecs.length; ++i) {\n      var g = display.gutters.childNodes[i];\n      if (g && g.getBoundingClientRect().right >= mX) {\n        var line = lineAtHeight(cm.doc, mY);\n        var gutter = cm.display.gutterSpecs[i];\n        signal(cm, type, cm, line, gutter.className, e);\n        return e_defaultPrevented(e)\n      }\n    }\n  }\n\n  function clickInGutter(cm, e) {\n    return gutterEvent(cm, e, \"gutterClick\", true)\n  }\n\n  // CONTEXT MENU HANDLING\n\n  // To make the context menu work, we need to briefly unhide the\n  // textarea (making it as unobtrusive as possible) to let the\n  // right-click take effect on it.\n  function onContextMenu(cm, e) {\n    if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\n    if (signalDOMEvent(cm, e, \"contextmenu\")) { return }\n    if (!captureRightClick) { cm.display.input.onContextMenu(e); }\n  }\n\n  function contextMenuInGutter(cm, e) {\n    if (!hasHandler(cm, \"gutterContextMenu\")) { return false }\n    return gutterEvent(cm, e, \"gutterContextMenu\", false)\n  }\n\n  function themeChanged(cm) {\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n      cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n    clearCaches(cm);\n  }\n\n  var Init = {toString: function(){return \"CodeMirror.Init\"}};\n\n  var defaults = {};\n  var optionHandlers = {};\n\n  function defineOptions(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    function option(name, deflt, handle, notOnInit) {\n      CodeMirror.defaults[name] = deflt;\n      if (handle) { optionHandlers[name] =\n        notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old); }} : handle; }\n    }\n\n    CodeMirror.defineOption = option;\n\n    // Passed to option handlers when there is no old value.\n    CodeMirror.Init = Init;\n\n    // These two are, on init, called from the constructor because they\n    // have to be initialized before the editor can start at all.\n    option(\"value\", \"\", function (cm, val) { return cm.setValue(val); }, true);\n    option(\"mode\", null, function (cm, val) {\n      cm.doc.modeOption = val;\n      loadMode(cm);\n    }, true);\n\n    option(\"indentUnit\", 2, loadMode, true);\n    option(\"indentWithTabs\", false);\n    option(\"smartIndent\", true);\n    option(\"tabSize\", 4, function (cm) {\n      resetModeState(cm);\n      clearCaches(cm);\n      regChange(cm);\n    }, true);\n\n    option(\"lineSeparator\", null, function (cm, val) {\n      cm.doc.lineSep = val;\n      if (!val) { return }\n      var newBreaks = [], lineNo = cm.doc.first;\n      cm.doc.iter(function (line) {\n        for (var pos = 0;;) {\n          var found = line.text.indexOf(val, pos);\n          if (found == -1) { break }\n          pos = found + val.length;\n          newBreaks.push(Pos(lineNo, found));\n        }\n        lineNo++;\n      });\n      for (var i = newBreaks.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)); }\n    });\n    option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200f\\u2028\\u2029\\ufeff\\ufff9-\\ufffc]/g, function (cm, val, old) {\n      cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n      if (old != Init) { cm.refresh(); }\n    });\n    option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true);\n    option(\"electricChars\", true);\n    option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n      throw new Error(\"inputStyle can not (yet) be changed in a running editor\") // FIXME\n    }, true);\n    option(\"spellcheck\", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true);\n    option(\"autocorrect\", false, function (cm, val) { return cm.getInputField().autocorrect = val; }, true);\n    option(\"autocapitalize\", false, function (cm, val) { return cm.getInputField().autocapitalize = val; }, true);\n    option(\"rtlMoveVisually\", !windows);\n    option(\"wholeLineUpdateBefore\", true);\n\n    option(\"theme\", \"default\", function (cm) {\n      themeChanged(cm);\n      updateGutters(cm);\n    }, true);\n    option(\"keyMap\", \"default\", function (cm, val, old) {\n      var next = getKeyMap(val);\n      var prev = old != Init && getKeyMap(old);\n      if (prev && prev.detach) { prev.detach(cm, next); }\n      if (next.attach) { next.attach(cm, prev || null); }\n    });\n    option(\"extraKeys\", null);\n    option(\"configureMouse\", null);\n\n    option(\"lineWrapping\", false, wrappingChanged, true);\n    option(\"gutters\", [], function (cm, val) {\n      cm.display.gutterSpecs = getGutters(val, cm.options.lineNumbers);\n      updateGutters(cm);\n    }, true);\n    option(\"fixedGutter\", true, function (cm, val) {\n      cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n      cm.refresh();\n    }, true);\n    option(\"coverGutterNextToScrollbar\", false, function (cm) { return updateScrollbars(cm); }, true);\n    option(\"scrollbarStyle\", \"native\", function (cm) {\n      initScrollbars(cm);\n      updateScrollbars(cm);\n      cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n      cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n    }, true);\n    option(\"lineNumbers\", false, function (cm, val) {\n      cm.display.gutterSpecs = getGutters(cm.options.gutters, val);\n      updateGutters(cm);\n    }, true);\n    option(\"firstLineNumber\", 1, updateGutters, true);\n    option(\"lineNumberFormatter\", function (integer) { return integer; }, updateGutters, true);\n    option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n    option(\"resetSelectionOnContextMenu\", true);\n    option(\"lineWiseCopyCut\", true);\n    option(\"pasteLinesPerSelection\", true);\n    option(\"selectionsMayTouch\", false);\n\n    option(\"readOnly\", false, function (cm, val) {\n      if (val == \"nocursor\") {\n        onBlur(cm);\n        cm.display.input.blur();\n      }\n      cm.display.input.readOnlyChanged(val);\n    });\n    option(\"disableInput\", false, function (cm, val) {if (!val) { cm.display.input.reset(); }}, true);\n    option(\"dragDrop\", true, dragDropChanged);\n    option(\"allowDropFileTypes\", null);\n\n    option(\"cursorBlinkRate\", 530);\n    option(\"cursorScrollMargin\", 0);\n    option(\"cursorHeight\", 1, updateSelection, true);\n    option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n    option(\"workTime\", 100);\n    option(\"workDelay\", 100);\n    option(\"flattenSpans\", true, resetModeState, true);\n    option(\"addModeClass\", false, resetModeState, true);\n    option(\"pollInterval\", 100);\n    option(\"undoDepth\", 200, function (cm, val) { return cm.doc.history.undoDepth = val; });\n    option(\"historyEventDelay\", 1250);\n    option(\"viewportMargin\", 10, function (cm) { return cm.refresh(); }, true);\n    option(\"maxHighlightLength\", 10000, resetModeState, true);\n    option(\"moveInputWithCursor\", true, function (cm, val) {\n      if (!val) { cm.display.input.resetPosition(); }\n    });\n\n    option(\"tabindex\", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || \"\"; });\n    option(\"autofocus\", null);\n    option(\"direction\", \"ltr\", function (cm, val) { return cm.doc.setDirection(val); }, true);\n    option(\"phrases\", null);\n  }\n\n  function dragDropChanged(cm, value, old) {\n    var wasOn = old && old != Init;\n    if (!value != !wasOn) {\n      var funcs = cm.display.dragFunctions;\n      var toggle = value ? on : off;\n      toggle(cm.display.scroller, \"dragstart\", funcs.start);\n      toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n      toggle(cm.display.scroller, \"dragover\", funcs.over);\n      toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n      toggle(cm.display.scroller, \"drop\", funcs.drop);\n    }\n  }\n\n  function wrappingChanged(cm) {\n    if (cm.options.lineWrapping) {\n      addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      cm.display.sizer.style.minWidth = \"\";\n      cm.display.sizerWidth = null;\n    } else {\n      rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      findMaxLine(cm);\n    }\n    estimateLineHeights(cm);\n    regChange(cm);\n    clearCaches(cm);\n    setTimeout(function () { return updateScrollbars(cm); }, 100);\n  }\n\n  // A CodeMirror instance represents an editor. This is the object\n  // that user code is usually dealing with.\n\n  function CodeMirror(place, options) {\n    var this$1 = this;\n\n    if (!(this instanceof CodeMirror)) { return new CodeMirror(place, options) }\n\n    this.options = options = options ? copyObj(options) : {};\n    // Determine effective options based on given values and defaults.\n    copyObj(defaults, options, false);\n\n    var doc = options.value;\n    if (typeof doc == \"string\") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction); }\n    else if (options.mode) { doc.modeOption = options.mode; }\n    this.doc = doc;\n\n    var input = new CodeMirror.inputStyles[options.inputStyle](this);\n    var display = this.display = new Display(place, doc, input, options);\n    display.wrapper.CodeMirror = this;\n    themeChanged(this);\n    if (options.lineWrapping)\n      { this.display.wrapper.className += \" CodeMirror-wrap\"; }\n    initScrollbars(this);\n\n    this.state = {\n      keyMaps: [],  // stores maps added by addKeyMap\n      overlays: [], // highlighting overlays, as added by addOverlay\n      modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n      overwrite: false,\n      delayingBlurEvent: false,\n      focused: false,\n      suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n      pasteIncoming: -1, cutIncoming: -1, // help recognize paste/cut edits in input.poll\n      selectingText: false,\n      draggingText: false,\n      highlight: new Delayed(), // stores highlight worker timeout\n      keySeq: null,  // Unfinished key sequence\n      specialChars: null\n    };\n\n    if (options.autofocus && !mobile) { display.input.focus(); }\n\n    // Override magic textarea content restore that IE sometimes does\n    // on our hidden textarea on reload\n    if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20); }\n\n    registerEventHandlers(this);\n    ensureGlobalHandlers();\n\n    startOperation(this);\n    this.curOp.forceUpdate = true;\n    attachDoc(this, doc);\n\n    if ((options.autofocus && !mobile) || this.hasFocus())\n      { setTimeout(bind(onFocus, this), 20); }\n    else\n      { onBlur(this); }\n\n    for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\n      { optionHandlers[opt](this, options[opt], Init); } }\n    maybeUpdateLineNumberWidth(this);\n    if (options.finishInit) { options.finishInit(this); }\n    for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this); }\n    endOperation(this);\n    // Suppress optimizelegibility in Webkit, since it breaks text\n    // measuring on line wrapping boundaries.\n    if (webkit && options.lineWrapping &&\n        getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n      { display.lineDiv.style.textRendering = \"auto\"; }\n  }\n\n  // The default configuration options.\n  CodeMirror.defaults = defaults;\n  // Functions to run when options are changed.\n  CodeMirror.optionHandlers = optionHandlers;\n\n  // Attach the necessary event handlers when initializing the editor\n  function registerEventHandlers(cm) {\n    var d = cm.display;\n    on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n    // Older IE's will not fire a second mousedown for a double click\n    if (ie && ie_version < 11)\n      { on(d.scroller, \"dblclick\", operation(cm, function (e) {\n        if (signalDOMEvent(cm, e)) { return }\n        var pos = posFromMouse(cm, e);\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\n        e_preventDefault(e);\n        var word = cm.findWordAt(pos);\n        extendSelection(cm.doc, word.anchor, word.head);\n      })); }\n    else\n      { on(d.scroller, \"dblclick\", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }); }\n    // Some browsers fire contextmenu *after* opening the menu, at\n    // which point we can't mess with it anymore. Context menu is\n    // handled in onMouseDown for these browsers.\n    on(d.scroller, \"contextmenu\", function (e) { return onContextMenu(cm, e); });\n    on(d.input.getField(), \"contextmenu\", function (e) {\n      if (!d.scroller.contains(e.target)) { onContextMenu(cm, e); }\n    });\n\n    // Used to suppress mouse event handling when a touch happens\n    var touchFinished, prevTouch = {end: 0};\n    function finishTouch() {\n      if (d.activeTouch) {\n        touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000);\n        prevTouch = d.activeTouch;\n        prevTouch.end = +new Date;\n      }\n    }\n    function isMouseLikeTouchEvent(e) {\n      if (e.touches.length != 1) { return false }\n      var touch = e.touches[0];\n      return touch.radiusX <= 1 && touch.radiusY <= 1\n    }\n    function farAway(touch, other) {\n      if (other.left == null) { return true }\n      var dx = other.left - touch.left, dy = other.top - touch.top;\n      return dx * dx + dy * dy > 20 * 20\n    }\n    on(d.scroller, \"touchstart\", function (e) {\n      if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e) && !clickInGutter(cm, e)) {\n        d.input.ensurePolled();\n        clearTimeout(touchFinished);\n        var now = +new Date;\n        d.activeTouch = {start: now, moved: false,\n                         prev: now - prevTouch.end <= 300 ? prevTouch : null};\n        if (e.touches.length == 1) {\n          d.activeTouch.left = e.touches[0].pageX;\n          d.activeTouch.top = e.touches[0].pageY;\n        }\n      }\n    });\n    on(d.scroller, \"touchmove\", function () {\n      if (d.activeTouch) { d.activeTouch.moved = true; }\n    });\n    on(d.scroller, \"touchend\", function (e) {\n      var touch = d.activeTouch;\n      if (touch && !eventInWidget(d, e) && touch.left != null &&\n          !touch.moved && new Date - touch.start < 300) {\n        var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n        if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n          { range = new Range(pos, pos); }\n        else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n          { range = cm.findWordAt(pos); }\n        else // Triple tap\n          { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))); }\n        cm.setSelection(range.anchor, range.head);\n        cm.focus();\n        e_preventDefault(e);\n      }\n      finishTouch();\n    });\n    on(d.scroller, \"touchcancel\", finishTouch);\n\n    // Sync scrolling between fake scrollbars and real scrollable\n    // area, ensure viewport is updated when scrolling.\n    on(d.scroller, \"scroll\", function () {\n      if (d.scroller.clientHeight) {\n        updateScrollTop(cm, d.scroller.scrollTop);\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\n        signal(cm, \"scroll\", cm);\n      }\n    });\n\n    // Listen to wheel events in order to try and update the viewport on time.\n    on(d.scroller, \"mousewheel\", function (e) { return onScrollWheel(cm, e); });\n    on(d.scroller, \"DOMMouseScroll\", function (e) { return onScrollWheel(cm, e); });\n\n    // Prevent wrapper from ever scrolling\n    on(d.wrapper, \"scroll\", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n    d.dragFunctions = {\n      enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e); }},\n      over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n      start: function (e) { return onDragStart(cm, e); },\n      drop: operation(cm, onDrop),\n      leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\n    };\n\n    var inp = d.input.getField();\n    on(inp, \"keyup\", function (e) { return onKeyUp.call(cm, e); });\n    on(inp, \"keydown\", operation(cm, onKeyDown));\n    on(inp, \"keypress\", operation(cm, onKeyPress));\n    on(inp, \"focus\", function (e) { return onFocus(cm, e); });\n    on(inp, \"blur\", function (e) { return onBlur(cm, e); });\n  }\n\n  var initHooks = [];\n  CodeMirror.defineInitHook = function (f) { return initHooks.push(f); };\n\n  // Indent the given line. The how parameter can be \"smart\",\n  // \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n  // (typically set to true for forced single-line indents), empty\n  // lines are not indented, and places where the mode returns Pass\n  // are left alone.\n  function indentLine(cm, n, how, aggressive) {\n    var doc = cm.doc, state;\n    if (how == null) { how = \"add\"; }\n    if (how == \"smart\") {\n      // Fall back to \"prev\" when the mode doesn't have an indentation\n      // method.\n      if (!doc.mode.indent) { how = \"prev\"; }\n      else { state = getContextBefore(cm, n).state; }\n    }\n\n    var tabSize = cm.options.tabSize;\n    var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n    if (line.stateAfter) { line.stateAfter = null; }\n    var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n    if (!aggressive && !/\\S/.test(line.text)) {\n      indentation = 0;\n      how = \"not\";\n    } else if (how == \"smart\") {\n      indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n      if (indentation == Pass || indentation > 150) {\n        if (!aggressive) { return }\n        how = \"prev\";\n      }\n    }\n    if (how == \"prev\") {\n      if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize); }\n      else { indentation = 0; }\n    } else if (how == \"add\") {\n      indentation = curSpace + cm.options.indentUnit;\n    } else if (how == \"subtract\") {\n      indentation = curSpace - cm.options.indentUnit;\n    } else if (typeof how == \"number\") {\n      indentation = curSpace + how;\n    }\n    indentation = Math.max(0, indentation);\n\n    var indentString = \"\", pos = 0;\n    if (cm.options.indentWithTabs)\n      { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";} }\n    if (pos < indentation) { indentString += spaceStr(indentation - pos); }\n\n    if (indentString != curSpaceString) {\n      replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n      line.stateAfter = null;\n      return true\n    } else {\n      // Ensure that, if the cursor was in the whitespace at the start\n      // of the line, it is moved to the end of that space.\n      for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n        var range = doc.sel.ranges[i$1];\n        if (range.head.line == n && range.head.ch < curSpaceString.length) {\n          var pos$1 = Pos(n, curSpaceString.length);\n          replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n          break\n        }\n      }\n    }\n  }\n\n  // This will be set to a {lineWise: bool, text: [string]} object, so\n  // that, when pasting, we know what kind of selections the copied\n  // text was made out of.\n  var lastCopied = null;\n\n  function setLastCopied(newLastCopied) {\n    lastCopied = newLastCopied;\n  }\n\n  function applyTextInput(cm, inserted, deleted, sel, origin) {\n    var doc = cm.doc;\n    cm.display.shift = false;\n    if (!sel) { sel = doc.sel; }\n\n    var recent = +new Date - 200;\n    var paste = origin == \"paste\" || cm.state.pasteIncoming > recent;\n    var textLines = splitLinesAuto(inserted), multiPaste = null;\n    // When pasting N lines into N selections, insert one line per selection\n    if (paste && sel.ranges.length > 1) {\n      if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n        if (sel.ranges.length % lastCopied.text.length == 0) {\n          multiPaste = [];\n          for (var i = 0; i < lastCopied.text.length; i++)\n            { multiPaste.push(doc.splitLines(lastCopied.text[i])); }\n        }\n      } else if (textLines.length == sel.ranges.length && cm.options.pasteLinesPerSelection) {\n        multiPaste = map(textLines, function (l) { return [l]; });\n      }\n    }\n\n    var updateInput = cm.curOp.updateInput;\n    // Normal behavior is to insert the new text into every selection\n    for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n      var range = sel.ranges[i$1];\n      var from = range.from(), to = range.to();\n      if (range.empty()) {\n        if (deleted && deleted > 0) // Handle deletion\n          { from = Pos(from.line, from.ch - deleted); }\n        else if (cm.state.overwrite && !paste) // Handle overwrite\n          { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)); }\n        else if (paste && lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == inserted)\n          { from = to = Pos(from.line, 0); }\n      }\n      var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n                         origin: origin || (paste ? \"paste\" : cm.state.cutIncoming > recent ? \"cut\" : \"+input\")};\n      makeChange(cm.doc, changeEvent);\n      signalLater(cm, \"inputRead\", cm, changeEvent);\n    }\n    if (inserted && !paste)\n      { triggerElectric(cm, inserted); }\n\n    ensureCursorVisible(cm);\n    if (cm.curOp.updateInput < 2) { cm.curOp.updateInput = updateInput; }\n    cm.curOp.typing = true;\n    cm.state.pasteIncoming = cm.state.cutIncoming = -1;\n  }\n\n  function handlePaste(e, cm) {\n    var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n    if (pasted) {\n      e.preventDefault();\n      if (!cm.isReadOnly() && !cm.options.disableInput)\n        { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, \"paste\"); }); }\n      return true\n    }\n  }\n\n  function triggerElectric(cm, inserted) {\n    // When an 'electric' character is inserted, immediately trigger a reindent\n    if (!cm.options.electricChars || !cm.options.smartIndent) { return }\n    var sel = cm.doc.sel;\n\n    for (var i = sel.ranges.length - 1; i >= 0; i--) {\n      var range = sel.ranges[i];\n      if (range.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range.head.line)) { continue }\n      var mode = cm.getModeAt(range.head);\n      var indented = false;\n      if (mode.electricChars) {\n        for (var j = 0; j < mode.electricChars.length; j++)\n          { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n            indented = indentLine(cm, range.head.line, \"smart\");\n            break\n          } }\n      } else if (mode.electricInput) {\n        if (mode.electricInput.test(getLine(cm.doc, range.head.line).text.slice(0, range.head.ch)))\n          { indented = indentLine(cm, range.head.line, \"smart\"); }\n      }\n      if (indented) { signalLater(cm, \"electricInput\", cm, range.head.line); }\n    }\n  }\n\n  function copyableRanges(cm) {\n    var text = [], ranges = [];\n    for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n      var line = cm.doc.sel.ranges[i].head.line;\n      var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n      ranges.push(lineRange);\n      text.push(cm.getRange(lineRange.anchor, lineRange.head));\n    }\n    return {text: text, ranges: ranges}\n  }\n\n  function disableBrowserMagic(field, spellcheck, autocorrect, autocapitalize) {\n    field.setAttribute(\"autocorrect\", autocorrect ? \"\" : \"off\");\n    field.setAttribute(\"autocapitalize\", autocapitalize ? \"\" : \"off\");\n    field.setAttribute(\"spellcheck\", !!spellcheck);\n  }\n\n  function hiddenTextarea() {\n    var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\");\n    var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n    // The textarea is kept positioned near the cursor to prevent the\n    // fact that it'll be scrolled into view on input from scrolling\n    // our fake cursor out of view. On webkit, when wrap=off, paste is\n    // very slow. So make the area wide instead.\n    if (webkit) { te.style.width = \"1000px\"; }\n    else { te.setAttribute(\"wrap\", \"off\"); }\n    // If border: 0; -- iOS fails to open keyboard (issue #1287)\n    if (ios) { te.style.border = \"1px solid black\"; }\n    disableBrowserMagic(te);\n    return div\n  }\n\n  // The publicly visible API. Note that methodOp(f) means\n  // 'wrap f in an operation, performed on its `this` parameter'.\n\n  // This is not the complete set of editor methods. Most of the\n  // methods defined on the Doc type are also injected into\n  // CodeMirror.prototype, for backwards compatibility and\n  // convenience.\n\n  function addEditorMethods(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    var helpers = CodeMirror.helpers = {};\n\n    CodeMirror.prototype = {\n      constructor: CodeMirror,\n      focus: function(){window.focus(); this.display.input.focus();},\n\n      setOption: function(option, value) {\n        var options = this.options, old = options[option];\n        if (options[option] == value && option != \"mode\") { return }\n        options[option] = value;\n        if (optionHandlers.hasOwnProperty(option))\n          { operation(this, optionHandlers[option])(this, value, old); }\n        signal(this, \"optionChange\", this, option);\n      },\n\n      getOption: function(option) {return this.options[option]},\n      getDoc: function() {return this.doc},\n\n      addKeyMap: function(map, bottom) {\n        this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map));\n      },\n      removeKeyMap: function(map) {\n        var maps = this.state.keyMaps;\n        for (var i = 0; i < maps.length; ++i)\n          { if (maps[i] == map || maps[i].name == map) {\n            maps.splice(i, 1);\n            return true\n          } }\n      },\n\n      addOverlay: methodOp(function(spec, options) {\n        var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n        if (mode.startState) { throw new Error(\"Overlays may not be stateful.\") }\n        insertSorted(this.state.overlays,\n                     {mode: mode, modeSpec: spec, opaque: options && options.opaque,\n                      priority: (options && options.priority) || 0},\n                     function (overlay) { return overlay.priority; });\n        this.state.modeGen++;\n        regChange(this);\n      }),\n      removeOverlay: methodOp(function(spec) {\n        var overlays = this.state.overlays;\n        for (var i = 0; i < overlays.length; ++i) {\n          var cur = overlays[i].modeSpec;\n          if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n            overlays.splice(i, 1);\n            this.state.modeGen++;\n            regChange(this);\n            return\n          }\n        }\n      }),\n\n      indentLine: methodOp(function(n, dir, aggressive) {\n        if (typeof dir != \"string\" && typeof dir != \"number\") {\n          if (dir == null) { dir = this.options.smartIndent ? \"smart\" : \"prev\"; }\n          else { dir = dir ? \"add\" : \"subtract\"; }\n        }\n        if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive); }\n      }),\n      indentSelection: methodOp(function(how) {\n        var ranges = this.doc.sel.ranges, end = -1;\n        for (var i = 0; i < ranges.length; i++) {\n          var range = ranges[i];\n          if (!range.empty()) {\n            var from = range.from(), to = range.to();\n            var start = Math.max(end, from.line);\n            end = Math.min(this.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n            for (var j = start; j < end; ++j)\n              { indentLine(this, j, how); }\n            var newRanges = this.doc.sel.ranges;\n            if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n              { replaceOneSelection(this.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll); }\n          } else if (range.head.line > end) {\n            indentLine(this, range.head.line, how, true);\n            end = range.head.line;\n            if (i == this.doc.sel.primIndex) { ensureCursorVisible(this); }\n          }\n        }\n      }),\n\n      // Fetch the parser token for a given character. Useful for hacks\n      // that want to inspect the mode state (say, for completion).\n      getTokenAt: function(pos, precise) {\n        return takeToken(this, pos, precise)\n      },\n\n      getLineTokens: function(line, precise) {\n        return takeToken(this, Pos(line), precise, true)\n      },\n\n      getTokenTypeAt: function(pos) {\n        pos = clipPos(this.doc, pos);\n        var styles = getLineStyles(this, getLine(this.doc, pos.line));\n        var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n        var type;\n        if (ch == 0) { type = styles[2]; }\n        else { for (;;) {\n          var mid = (before + after) >> 1;\n          if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid; }\n          else if (styles[mid * 2 + 1] < ch) { before = mid + 1; }\n          else { type = styles[mid * 2 + 2]; break }\n        } }\n        var cut = type ? type.indexOf(\"overlay \") : -1;\n        return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\n      },\n\n      getModeAt: function(pos) {\n        var mode = this.doc.mode;\n        if (!mode.innerMode) { return mode }\n        return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\n      },\n\n      getHelper: function(pos, type) {\n        return this.getHelpers(pos, type)[0]\n      },\n\n      getHelpers: function(pos, type) {\n        var found = [];\n        if (!helpers.hasOwnProperty(type)) { return found }\n        var help = helpers[type], mode = this.getModeAt(pos);\n        if (typeof mode[type] == \"string\") {\n          if (help[mode[type]]) { found.push(help[mode[type]]); }\n        } else if (mode[type]) {\n          for (var i = 0; i < mode[type].length; i++) {\n            var val = help[mode[type][i]];\n            if (val) { found.push(val); }\n          }\n        } else if (mode.helperType && help[mode.helperType]) {\n          found.push(help[mode.helperType]);\n        } else if (help[mode.name]) {\n          found.push(help[mode.name]);\n        }\n        for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n          var cur = help._global[i$1];\n          if (cur.pred(mode, this) && indexOf(found, cur.val) == -1)\n            { found.push(cur.val); }\n        }\n        return found\n      },\n\n      getStateAfter: function(line, precise) {\n        var doc = this.doc;\n        line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n        return getContextBefore(this, line + 1, precise).state\n      },\n\n      cursorCoords: function(start, mode) {\n        var pos, range = this.doc.sel.primary();\n        if (start == null) { pos = range.head; }\n        else if (typeof start == \"object\") { pos = clipPos(this.doc, start); }\n        else { pos = start ? range.from() : range.to(); }\n        return cursorCoords(this, pos, mode || \"page\")\n      },\n\n      charCoords: function(pos, mode) {\n        return charCoords(this, clipPos(this.doc, pos), mode || \"page\")\n      },\n\n      coordsChar: function(coords, mode) {\n        coords = fromCoordSystem(this, coords, mode || \"page\");\n        return coordsChar(this, coords.left, coords.top)\n      },\n\n      lineAtHeight: function(height, mode) {\n        height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n        return lineAtHeight(this.doc, height + this.display.viewOffset)\n      },\n      heightAtLine: function(line, mode, includeWidgets) {\n        var end = false, lineObj;\n        if (typeof line == \"number\") {\n          var last = this.doc.first + this.doc.size - 1;\n          if (line < this.doc.first) { line = this.doc.first; }\n          else if (line > last) { line = last; end = true; }\n          lineObj = getLine(this.doc, line);\n        } else {\n          lineObj = line;\n        }\n        return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\", includeWidgets || end).top +\n          (end ? this.doc.height - heightAtLine(lineObj) : 0)\n      },\n\n      defaultTextHeight: function() { return textHeight(this.display) },\n      defaultCharWidth: function() { return charWidth(this.display) },\n\n      getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\n\n      addWidget: function(pos, node, scroll, vert, horiz) {\n        var display = this.display;\n        pos = cursorCoords(this, clipPos(this.doc, pos));\n        var top = pos.bottom, left = pos.left;\n        node.style.position = \"absolute\";\n        node.setAttribute(\"cm-ignore-events\", \"true\");\n        this.display.input.setUneditable(node);\n        display.sizer.appendChild(node);\n        if (vert == \"over\") {\n          top = pos.top;\n        } else if (vert == \"above\" || vert == \"near\") {\n          var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n          hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n          // Default to positioning above (if specified and possible); otherwise default to positioning below\n          if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n            { top = pos.top - node.offsetHeight; }\n          else if (pos.bottom + node.offsetHeight <= vspace)\n            { top = pos.bottom; }\n          if (left + node.offsetWidth > hspace)\n            { left = hspace - node.offsetWidth; }\n        }\n        node.style.top = top + \"px\";\n        node.style.left = node.style.right = \"\";\n        if (horiz == \"right\") {\n          left = display.sizer.clientWidth - node.offsetWidth;\n          node.style.right = \"0px\";\n        } else {\n          if (horiz == \"left\") { left = 0; }\n          else if (horiz == \"middle\") { left = (display.sizer.clientWidth - node.offsetWidth) / 2; }\n          node.style.left = left + \"px\";\n        }\n        if (scroll)\n          { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}); }\n      },\n\n      triggerOnKeyDown: methodOp(onKeyDown),\n      triggerOnKeyPress: methodOp(onKeyPress),\n      triggerOnKeyUp: onKeyUp,\n      triggerOnMouseDown: methodOp(onMouseDown),\n\n      execCommand: function(cmd) {\n        if (commands.hasOwnProperty(cmd))\n          { return commands[cmd].call(null, this) }\n      },\n\n      triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n      findPosH: function(from, amount, unit, visually) {\n        var dir = 1;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          cur = findPosH(this.doc, cur, dir, unit, visually);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveH: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        this.extendSelectionsBy(function (range) {\n          if (this$1.display.shift || this$1.doc.extend || range.empty())\n            { return findPosH(this$1.doc, range.head, dir, unit, this$1.options.rtlMoveVisually) }\n          else\n            { return dir < 0 ? range.from() : range.to() }\n        }, sel_move);\n      }),\n\n      deleteH: methodOp(function(dir, unit) {\n        var sel = this.doc.sel, doc = this.doc;\n        if (sel.somethingSelected())\n          { doc.replaceSelection(\"\", null, \"+delete\"); }\n        else\n          { deleteNearSelection(this, function (range) {\n            var other = findPosH(doc, range.head, dir, unit, false);\n            return dir < 0 ? {from: other, to: range.head} : {from: range.head, to: other}\n          }); }\n      }),\n\n      findPosV: function(from, amount, unit, goalColumn) {\n        var dir = 1, x = goalColumn;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          var coords = cursorCoords(this, cur, \"div\");\n          if (x == null) { x = coords.left; }\n          else { coords.left = x; }\n          cur = findPosV(this, coords, dir, unit);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveV: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        var doc = this.doc, goals = [];\n        var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n        doc.extendSelectionsBy(function (range) {\n          if (collapse)\n            { return dir < 0 ? range.from() : range.to() }\n          var headPos = cursorCoords(this$1, range.head, \"div\");\n          if (range.goalColumn != null) { headPos.left = range.goalColumn; }\n          goals.push(headPos.left);\n          var pos = findPosV(this$1, headPos, dir, unit);\n          if (unit == \"page\" && range == doc.sel.primary())\n            { addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top); }\n          return pos\n        }, sel_move);\n        if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\n          { doc.sel.ranges[i].goalColumn = goals[i]; } }\n      }),\n\n      // Find the word at the given position (as returned by coordsChar).\n      findWordAt: function(pos) {\n        var doc = this.doc, line = getLine(doc, pos.line).text;\n        var start = pos.ch, end = pos.ch;\n        if (line) {\n          var helper = this.getHelper(pos, \"wordChars\");\n          if ((pos.sticky == \"before\" || end == line.length) && start) { --start; } else { ++end; }\n          var startChar = line.charAt(start);\n          var check = isWordChar(startChar, helper)\n            ? function (ch) { return isWordChar(ch, helper); }\n            : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\n            : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); };\n          while (start > 0 && check(line.charAt(start - 1))) { --start; }\n          while (end < line.length && check(line.charAt(end))) { ++end; }\n        }\n        return new Range(Pos(pos.line, start), Pos(pos.line, end))\n      },\n\n      toggleOverwrite: function(value) {\n        if (value != null && value == this.state.overwrite) { return }\n        if (this.state.overwrite = !this.state.overwrite)\n          { addClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n        else\n          { rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n\n        signal(this, \"overwriteToggle\", this, this.state.overwrite);\n      },\n      hasFocus: function() { return this.display.input.getField() == activeElt() },\n      isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\n\n      scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y); }),\n      getScrollInfo: function() {\n        var scroller = this.display.scroller;\n        return {left: scroller.scrollLeft, top: scroller.scrollTop,\n                height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n                width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n                clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\n      },\n\n      scrollIntoView: methodOp(function(range, margin) {\n        if (range == null) {\n          range = {from: this.doc.sel.primary().head, to: null};\n          if (margin == null) { margin = this.options.cursorScrollMargin; }\n        } else if (typeof range == \"number\") {\n          range = {from: Pos(range, 0), to: null};\n        } else if (range.from == null) {\n          range = {from: range, to: null};\n        }\n        if (!range.to) { range.to = range.from; }\n        range.margin = margin || 0;\n\n        if (range.from.line != null) {\n          scrollToRange(this, range);\n        } else {\n          scrollToCoordsRange(this, range.from, range.to, range.margin);\n        }\n      }),\n\n      setSize: methodOp(function(width, height) {\n        var this$1 = this;\n\n        var interpret = function (val) { return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val; };\n        if (width != null) { this.display.wrapper.style.width = interpret(width); }\n        if (height != null) { this.display.wrapper.style.height = interpret(height); }\n        if (this.options.lineWrapping) { clearLineMeasurementCache(this); }\n        var lineNo = this.display.viewFrom;\n        this.doc.iter(lineNo, this.display.viewTo, function (line) {\n          if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\n            { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo, \"widget\"); break } } }\n          ++lineNo;\n        });\n        this.curOp.forceUpdate = true;\n        signal(this, \"refresh\", this);\n      }),\n\n      operation: function(f){return runInOp(this, f)},\n      startOperation: function(){return startOperation(this)},\n      endOperation: function(){return endOperation(this)},\n\n      refresh: methodOp(function() {\n        var oldHeight = this.display.cachedTextHeight;\n        regChange(this);\n        this.curOp.forceUpdate = true;\n        clearCaches(this);\n        scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n        updateGutterSpace(this.display);\n        if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5)\n          { estimateLineHeights(this); }\n        signal(this, \"refresh\", this);\n      }),\n\n      swapDoc: methodOp(function(doc) {\n        var old = this.doc;\n        old.cm = null;\n        // Cancel the current text selection if any (#5821)\n        if (this.state.selectingText) { this.state.selectingText(); }\n        attachDoc(this, doc);\n        clearCaches(this);\n        this.display.input.reset();\n        scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n        this.curOp.forceScroll = true;\n        signalLater(this, \"swapDoc\", this, old);\n        return old\n      }),\n\n      phrase: function(phraseText) {\n        var phrases = this.options.phrases;\n        return phrases && Object.prototype.hasOwnProperty.call(phrases, phraseText) ? phrases[phraseText] : phraseText\n      },\n\n      getInputField: function(){return this.display.input.getField()},\n      getWrapperElement: function(){return this.display.wrapper},\n      getScrollerElement: function(){return this.display.scroller},\n      getGutterElement: function(){return this.display.gutters}\n    };\n    eventMixin(CodeMirror);\n\n    CodeMirror.registerHelper = function(type, name, value) {\n      if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []}; }\n      helpers[type][name] = value;\n    };\n    CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n      CodeMirror.registerHelper(type, name, value);\n      helpers[type]._global.push({pred: predicate, val: value});\n    };\n  }\n\n  // Used for horizontal relative motion. Dir is -1 or 1 (left or\n  // right), unit can be \"char\", \"column\" (like char, but doesn't\n  // cross line boundaries), \"word\" (across next word), or \"group\" (to\n  // the start of next group of word or non-word-non-whitespace\n  // chars). The visually param controls whether, in right-to-left\n  // text, direction 1 means to move towards the next index in the\n  // string, or towards the character to the right of the current\n  // position. The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosH(doc, pos, dir, unit, visually) {\n    var oldPos = pos;\n    var origDir = dir;\n    var lineObj = getLine(doc, pos.line);\n    var lineDir = visually && doc.direction == \"rtl\" ? -dir : dir;\n    function findNextLine() {\n      var l = pos.line + lineDir;\n      if (l < doc.first || l >= doc.first + doc.size) { return false }\n      pos = new Pos(l, pos.ch, pos.sticky);\n      return lineObj = getLine(doc, l)\n    }\n    function moveOnce(boundToLine) {\n      var next;\n      if (visually) {\n        next = moveVisually(doc.cm, lineObj, pos, dir);\n      } else {\n        next = moveLogically(lineObj, pos, dir);\n      }\n      if (next == null) {\n        if (!boundToLine && findNextLine())\n          { pos = endOfLine(visually, doc.cm, lineObj, pos.line, lineDir); }\n        else\n          { return false }\n      } else {\n        pos = next;\n      }\n      return true\n    }\n\n    if (unit == \"char\") {\n      moveOnce();\n    } else if (unit == \"column\") {\n      moveOnce(true);\n    } else if (unit == \"word\" || unit == \"group\") {\n      var sawType = null, group = unit == \"group\";\n      var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n      for (var first = true;; first = false) {\n        if (dir < 0 && !moveOnce(!first)) { break }\n        var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n        var type = isWordChar(cur, helper) ? \"w\"\n          : group && cur == \"\\n\" ? \"n\"\n          : !group || /\\s/.test(cur) ? null\n          : \"p\";\n        if (group && !first && !type) { type = \"s\"; }\n        if (sawType && sawType != type) {\n          if (dir < 0) {dir = 1; moveOnce(); pos.sticky = \"after\";}\n          break\n        }\n\n        if (type) { sawType = type; }\n        if (dir > 0 && !moveOnce(!first)) { break }\n      }\n    }\n    var result = skipAtomic(doc, pos, oldPos, origDir, true);\n    if (equalCursorPos(oldPos, result)) { result.hitSide = true; }\n    return result\n  }\n\n  // For relative vertical movement. Dir may be -1 or 1. Unit can be\n  // \"page\" or \"line\". The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosV(cm, pos, dir, unit) {\n    var doc = cm.doc, x = pos.left, y;\n    if (unit == \"page\") {\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n      var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n      y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n\n    } else if (unit == \"line\") {\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n    }\n    var target;\n    for (;;) {\n      target = coordsChar(cm, x, y);\n      if (!target.outside) { break }\n      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\n      y += dir * 5;\n    }\n    return target\n  }\n\n  // CONTENTEDITABLE INPUT STYLE\n\n  var ContentEditableInput = function(cm) {\n    this.cm = cm;\n    this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n    this.polling = new Delayed();\n    this.composing = null;\n    this.gracePeriod = false;\n    this.readDOMTimeout = null;\n  };\n\n  ContentEditableInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = input.cm;\n    var div = input.div = display.lineDiv;\n    disableBrowserMagic(div, cm.options.spellcheck, cm.options.autocorrect, cm.options.autocapitalize);\n\n    on(div, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n      // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n      if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20); }\n    });\n\n    on(div, \"compositionstart\", function (e) {\n      this$1.composing = {data: e.data, done: false};\n    });\n    on(div, \"compositionupdate\", function (e) {\n      if (!this$1.composing) { this$1.composing = {data: e.data, done: false}; }\n    });\n    on(div, \"compositionend\", function (e) {\n      if (this$1.composing) {\n        if (e.data != this$1.composing.data) { this$1.readFromDOMSoon(); }\n        this$1.composing.done = true;\n      }\n    });\n\n    on(div, \"touchstart\", function () { return input.forceCompositionEnd(); });\n\n    on(div, \"input\", function () {\n      if (!this$1.composing) { this$1.readFromDOMSoon(); }\n    });\n\n    function onCopyCut(e) {\n      if (signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n        if (e.type == \"cut\") { cm.replaceSelection(\"\", null, \"cut\"); }\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.operation(function () {\n            cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n            cm.replaceSelection(\"\", null, \"cut\");\n          });\n        }\n      }\n      if (e.clipboardData) {\n        e.clipboardData.clearData();\n        var content = lastCopied.text.join(\"\\n\");\n        // iOS exposes the clipboard API, but seems to discard content inserted into it\n        e.clipboardData.setData(\"Text\", content);\n        if (e.clipboardData.getData(\"Text\") == content) {\n          e.preventDefault();\n          return\n        }\n      }\n      // Old-fashioned briefly-focus-a-textarea hack\n      var kludge = hiddenTextarea(), te = kludge.firstChild;\n      cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n      te.value = lastCopied.text.join(\"\\n\");\n      var hadFocus = document.activeElement;\n      selectInput(te);\n      setTimeout(function () {\n        cm.display.lineSpace.removeChild(kludge);\n        hadFocus.focus();\n        if (hadFocus == div) { input.showPrimarySelection(); }\n      }, 50);\n    }\n    on(div, \"copy\", onCopyCut);\n    on(div, \"cut\", onCopyCut);\n  };\n\n  ContentEditableInput.prototype.prepareSelection = function () {\n    var result = prepareSelection(this.cm, false);\n    result.focus = document.activeElement == this.div;\n    return result\n  };\n\n  ContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n    if (!info || !this.cm.display.view.length) { return }\n    if (info.focus || takeFocus) { this.showPrimarySelection(); }\n    this.showMultipleSelections(info);\n  };\n\n  ContentEditableInput.prototype.getSelection = function () {\n    return this.cm.display.wrapper.ownerDocument.getSelection()\n  };\n\n  ContentEditableInput.prototype.showPrimarySelection = function () {\n    var sel = this.getSelection(), cm = this.cm, prim = cm.doc.sel.primary();\n    var from = prim.from(), to = prim.to();\n\n    if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\n        cmp(minPos(curAnchor, curFocus), from) == 0 &&\n        cmp(maxPos(curAnchor, curFocus), to) == 0)\n      { return }\n\n    var view = cm.display.view;\n    var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\n        {node: view[0].measure.map[2], offset: 0};\n    var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n    if (!end) {\n      var measure = view[view.length - 1].measure;\n      var map = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n      end = {node: map[map.length - 1], offset: map[map.length - 2] - map[map.length - 3]};\n    }\n\n    if (!start || !end) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var old = sel.rangeCount && sel.getRangeAt(0), rng;\n    try { rng = range(start.node, start.offset, end.offset, end.node); }\n    catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n    if (rng) {\n      if (!gecko && cm.state.focused) {\n        sel.collapse(start.node, start.offset);\n        if (!rng.collapsed) {\n          sel.removeAllRanges();\n          sel.addRange(rng);\n        }\n      } else {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n      }\n      if (old && sel.anchorNode == null) { sel.addRange(old); }\n      else if (gecko) { this.startGracePeriod(); }\n    }\n    this.rememberSelection();\n  };\n\n  ContentEditableInput.prototype.startGracePeriod = function () {\n      var this$1 = this;\n\n    clearTimeout(this.gracePeriod);\n    this.gracePeriod = setTimeout(function () {\n      this$1.gracePeriod = false;\n      if (this$1.selectionChanged())\n        { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }); }\n    }, 20);\n  };\n\n  ContentEditableInput.prototype.showMultipleSelections = function (info) {\n    removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n    removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n  };\n\n  ContentEditableInput.prototype.rememberSelection = function () {\n    var sel = this.getSelection();\n    this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\n    this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\n  };\n\n  ContentEditableInput.prototype.selectionInEditor = function () {\n    var sel = this.getSelection();\n    if (!sel.rangeCount) { return false }\n    var node = sel.getRangeAt(0).commonAncestorContainer;\n    return contains(this.div, node)\n  };\n\n  ContentEditableInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\") {\n      if (!this.selectionInEditor() || document.activeElement != this.div)\n        { this.showSelection(this.prepareSelection(), true); }\n      this.div.focus();\n    }\n  };\n  ContentEditableInput.prototype.blur = function () { this.div.blur(); };\n  ContentEditableInput.prototype.getField = function () { return this.div };\n\n  ContentEditableInput.prototype.supportsTouch = function () { return true };\n\n  ContentEditableInput.prototype.receivedFocus = function () {\n    var input = this;\n    if (this.selectionInEditor())\n      { this.pollSelection(); }\n    else\n      { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }); }\n\n    function poll() {\n      if (input.cm.state.focused) {\n        input.pollSelection();\n        input.polling.set(input.cm.options.pollInterval, poll);\n      }\n    }\n    this.polling.set(this.cm.options.pollInterval, poll);\n  };\n\n  ContentEditableInput.prototype.selectionChanged = function () {\n    var sel = this.getSelection();\n    return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\n      sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\n  };\n\n  ContentEditableInput.prototype.pollSelection = function () {\n    if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\n    var sel = this.getSelection(), cm = this.cm;\n    // On Android Chrome (version 56, at least), backspacing into an\n    // uneditable block element will put the cursor in that element,\n    // and then, because it's not editable, hide the virtual keyboard.\n    // Because Android doesn't allow us to actually detect backspace\n    // presses in a sane way, this code checks for when that happens\n    // and simulates a backspace press in this case.\n    if (android && chrome && this.cm.display.gutterSpecs.length && isInGutter(sel.anchorNode)) {\n      this.cm.triggerOnKeyDown({type: \"keydown\", keyCode: 8, preventDefault: Math.abs});\n      this.blur();\n      this.focus();\n      return\n    }\n    if (this.composing) { return }\n    this.rememberSelection();\n    var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (anchor && head) { runInOp(cm, function () {\n      setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n      if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true; }\n    }); }\n  };\n\n  ContentEditableInput.prototype.pollContent = function () {\n    if (this.readDOMTimeout != null) {\n      clearTimeout(this.readDOMTimeout);\n      this.readDOMTimeout = null;\n    }\n\n    var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\n    var from = sel.from(), to = sel.to();\n    if (from.ch == 0 && from.line > cm.firstLine())\n      { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length); }\n    if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\n      { to = Pos(to.line + 1, 0); }\n    if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\n\n    var fromIndex, fromLine, fromNode;\n    if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n      fromLine = lineNo(display.view[0].line);\n      fromNode = display.view[0].node;\n    } else {\n      fromLine = lineNo(display.view[fromIndex].line);\n      fromNode = display.view[fromIndex - 1].node.nextSibling;\n    }\n    var toIndex = findViewIndex(cm, to.line);\n    var toLine, toNode;\n    if (toIndex == display.view.length - 1) {\n      toLine = display.viewTo - 1;\n      toNode = display.lineDiv.lastChild;\n    } else {\n      toLine = lineNo(display.view[toIndex + 1].line) - 1;\n      toNode = display.view[toIndex + 1].node.previousSibling;\n    }\n\n    if (!fromNode) { return false }\n    var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n    var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n    while (newText.length > 1 && oldText.length > 1) {\n      if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\n      else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\n      else { break }\n    }\n\n    var cutFront = 0, cutEnd = 0;\n    var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\n    while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\n      { ++cutFront; }\n    var newBot = lst(newText), oldBot = lst(oldText);\n    var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\n                             oldBot.length - (oldText.length == 1 ? cutFront : 0));\n    while (cutEnd < maxCutEnd &&\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\n      { ++cutEnd; }\n    // Try to move start of change to start of selection if ambiguous\n    if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n      while (cutFront && cutFront > from.ch &&\n             newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n        cutFront--;\n        cutEnd++;\n      }\n    }\n\n    newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n    newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n\n    var chFrom = Pos(fromLine, cutFront);\n    var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n    if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n      replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n      return true\n    }\n  };\n\n  ContentEditableInput.prototype.ensurePolled = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.reset = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.forceCompositionEnd = function () {\n    if (!this.composing) { return }\n    clearTimeout(this.readDOMTimeout);\n    this.composing = null;\n    this.updateFromDOM();\n    this.div.blur();\n    this.div.focus();\n  };\n  ContentEditableInput.prototype.readFromDOMSoon = function () {\n      var this$1 = this;\n\n    if (this.readDOMTimeout != null) { return }\n    this.readDOMTimeout = setTimeout(function () {\n      this$1.readDOMTimeout = null;\n      if (this$1.composing) {\n        if (this$1.composing.done) { this$1.composing = null; }\n        else { return }\n      }\n      this$1.updateFromDOM();\n    }, 80);\n  };\n\n  ContentEditableInput.prototype.updateFromDOM = function () {\n      var this$1 = this;\n\n    if (this.cm.isReadOnly() || !this.pollContent())\n      { runInOp(this.cm, function () { return regChange(this$1.cm); }); }\n  };\n\n  ContentEditableInput.prototype.setUneditable = function (node) {\n    node.contentEditable = \"false\";\n  };\n\n  ContentEditableInput.prototype.onKeyPress = function (e) {\n    if (e.charCode == 0 || this.composing) { return }\n    e.preventDefault();\n    if (!this.cm.isReadOnly())\n      { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0); }\n  };\n\n  ContentEditableInput.prototype.readOnlyChanged = function (val) {\n    this.div.contentEditable = String(val != \"nocursor\");\n  };\n\n  ContentEditableInput.prototype.onContextMenu = function () {};\n  ContentEditableInput.prototype.resetPosition = function () {};\n\n  ContentEditableInput.prototype.needsContentAttribute = true;\n\n  function posToDOM(cm, pos) {\n    var view = findViewForLine(cm, pos.line);\n    if (!view || view.hidden) { return null }\n    var line = getLine(cm.doc, pos.line);\n    var info = mapFromLineView(view, line, pos.line);\n\n    var order = getOrder(line, cm.doc.direction), side = \"left\";\n    if (order) {\n      var partPos = getBidiPartAt(order, pos.ch);\n      side = partPos % 2 ? \"right\" : \"left\";\n    }\n    var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n    result.offset = result.collapse == \"right\" ? result.end : result.start;\n    return result\n  }\n\n  function isInGutter(node) {\n    for (var scan = node; scan; scan = scan.parentNode)\n      { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\n    return false\n  }\n\n  function badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\n\n  function domTextBetween(cm, from, to, fromLine, toLine) {\n    var text = \"\", closing = false, lineSep = cm.doc.lineSeparator(), extraLinebreak = false;\n    function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\n    function close() {\n      if (closing) {\n        text += lineSep;\n        if (extraLinebreak) { text += lineSep; }\n        closing = extraLinebreak = false;\n      }\n    }\n    function addText(str) {\n      if (str) {\n        close();\n        text += str;\n      }\n    }\n    function walk(node) {\n      if (node.nodeType == 1) {\n        var cmText = node.getAttribute(\"cm-text\");\n        if (cmText) {\n          addText(cmText);\n          return\n        }\n        var markerID = node.getAttribute(\"cm-marker\"), range;\n        if (markerID) {\n          var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n          if (found.length && (range = found[0].find(0)))\n            { addText(getBetween(cm.doc, range.from, range.to).join(lineSep)); }\n          return\n        }\n        if (node.getAttribute(\"contenteditable\") == \"false\") { return }\n        var isBlock = /^(pre|div|p|li|table|br)$/i.test(node.nodeName);\n        if (!/^br$/i.test(node.nodeName) && node.textContent.length == 0) { return }\n\n        if (isBlock) { close(); }\n        for (var i = 0; i < node.childNodes.length; i++)\n          { walk(node.childNodes[i]); }\n\n        if (/^(pre|p)$/i.test(node.nodeName)) { extraLinebreak = true; }\n        if (isBlock) { closing = true; }\n      } else if (node.nodeType == 3) {\n        addText(node.nodeValue.replace(/\\u200b/g, \"\").replace(/\\u00a0/g, \" \"));\n      }\n    }\n    for (;;) {\n      walk(from);\n      if (from == to) { break }\n      from = from.nextSibling;\n      extraLinebreak = false;\n    }\n    return text\n  }\n\n  function domToPos(cm, node, offset) {\n    var lineNode;\n    if (node == cm.display.lineDiv) {\n      lineNode = cm.display.lineDiv.childNodes[offset];\n      if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\n      node = null; offset = 0;\n    } else {\n      for (lineNode = node;; lineNode = lineNode.parentNode) {\n        if (!lineNode || lineNode == cm.display.lineDiv) { return null }\n        if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\n      }\n    }\n    for (var i = 0; i < cm.display.view.length; i++) {\n      var lineView = cm.display.view[i];\n      if (lineView.node == lineNode)\n        { return locateNodeInLineView(lineView, node, offset) }\n    }\n  }\n\n  function locateNodeInLineView(lineView, node, offset) {\n    var wrapper = lineView.text.firstChild, bad = false;\n    if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\n    if (node == wrapper) {\n      bad = true;\n      node = wrapper.childNodes[offset];\n      offset = 0;\n      if (!node) {\n        var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n        return badPos(Pos(lineNo(line), line.text.length), bad)\n      }\n    }\n\n    var textNode = node.nodeType == 3 ? node : null, topNode = node;\n    if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n      textNode = node.firstChild;\n      if (offset) { offset = textNode.nodeValue.length; }\n    }\n    while (topNode.parentNode != wrapper) { topNode = topNode.parentNode; }\n    var measure = lineView.measure, maps = measure.maps;\n\n    function find(textNode, topNode, offset) {\n      for (var i = -1; i < (maps ? maps.length : 0); i++) {\n        var map = i < 0 ? measure.map : maps[i];\n        for (var j = 0; j < map.length; j += 3) {\n          var curNode = map[j + 2];\n          if (curNode == textNode || curNode == topNode) {\n            var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n            var ch = map[j] + offset;\n            if (offset < 0 || curNode != textNode) { ch = map[j + (offset ? 1 : 0)]; }\n            return Pos(line, ch)\n          }\n        }\n      }\n    }\n    var found = find(textNode, topNode, offset);\n    if (found) { return badPos(found, bad) }\n\n    // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n    for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n      found = find(after, after.firstChild, 0);\n      if (found)\n        { return badPos(Pos(found.line, found.ch - dist), bad) }\n      else\n        { dist += after.textContent.length; }\n    }\n    for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n      found = find(before, before.firstChild, -1);\n      if (found)\n        { return badPos(Pos(found.line, found.ch + dist$1), bad) }\n      else\n        { dist$1 += before.textContent.length; }\n    }\n  }\n\n  // TEXTAREA INPUT STYLE\n\n  var TextareaInput = function(cm) {\n    this.cm = cm;\n    // See input.poll and input.reset\n    this.prevInput = \"\";\n\n    // Flag that indicates whether we expect input to appear real soon\n    // now (after some event like 'keypress' or 'input') and are\n    // polling intensively.\n    this.pollingFast = false;\n    // Self-resetting timeout for the poller\n    this.polling = new Delayed();\n    // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n    this.hasSelection = false;\n    this.composing = null;\n  };\n\n  TextareaInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = this.cm;\n    this.createField(display);\n    var te = this.textarea;\n\n    display.wrapper.insertBefore(this.wrapper, display.wrapper.firstChild);\n\n    // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n    if (ios) { te.style.width = \"0px\"; }\n\n    on(te, \"input\", function () {\n      if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null; }\n      input.poll();\n    });\n\n    on(te, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n\n      cm.state.pasteIncoming = +new Date;\n      input.fastPoll();\n    });\n\n    function prepareCopyCut(e) {\n      if (signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.setSelections(ranges.ranges, null, sel_dontScroll);\n        } else {\n          input.prevInput = \"\";\n          te.value = ranges.text.join(\"\\n\");\n          selectInput(te);\n        }\n      }\n      if (e.type == \"cut\") { cm.state.cutIncoming = +new Date; }\n    }\n    on(te, \"cut\", prepareCopyCut);\n    on(te, \"copy\", prepareCopyCut);\n\n    on(display.scroller, \"paste\", function (e) {\n      if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\n      if (!te.dispatchEvent) {\n        cm.state.pasteIncoming = +new Date;\n        input.focus();\n        return\n      }\n\n      // Pass the `paste` event to the textarea so it's handled by its event listener.\n      var event = new Event(\"paste\");\n      event.clipboardData = e.clipboardData;\n      te.dispatchEvent(event);\n    });\n\n    // Prevent normal selection in the editor (we handle our own)\n    on(display.lineSpace, \"selectstart\", function (e) {\n      if (!eventInWidget(display, e)) { e_preventDefault(e); }\n    });\n\n    on(te, \"compositionstart\", function () {\n      var start = cm.getCursor(\"from\");\n      if (input.composing) { input.composing.range.clear(); }\n      input.composing = {\n        start: start,\n        range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\n      };\n    });\n    on(te, \"compositionend\", function () {\n      if (input.composing) {\n        input.poll();\n        input.composing.range.clear();\n        input.composing = null;\n      }\n    });\n  };\n\n  TextareaInput.prototype.createField = function (_display) {\n    // Wraps and hides input textarea\n    this.wrapper = hiddenTextarea();\n    // The semihidden textarea that is focused when the editor is\n    // focused, and receives input.\n    this.textarea = this.wrapper.firstChild;\n  };\n\n  TextareaInput.prototype.prepareSelection = function () {\n    // Redraw the selection and/or cursor\n    var cm = this.cm, display = cm.display, doc = cm.doc;\n    var result = prepareSelection(cm);\n\n    // Move the hidden textarea near the cursor to prevent scrolling artifacts\n    if (cm.options.moveInputWithCursor) {\n      var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n      var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n      result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                          headPos.top + lineOff.top - wrapOff.top));\n      result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                           headPos.left + lineOff.left - wrapOff.left));\n    }\n\n    return result\n  };\n\n  TextareaInput.prototype.showSelection = function (drawn) {\n    var cm = this.cm, display = cm.display;\n    removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n    removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n    if (drawn.teTop != null) {\n      this.wrapper.style.top = drawn.teTop + \"px\";\n      this.wrapper.style.left = drawn.teLeft + \"px\";\n    }\n  };\n\n  // Reset the input to correspond to the selection (or to be empty,\n  // when not typing and nothing is selected)\n  TextareaInput.prototype.reset = function (typing) {\n    if (this.contextMenuPending || this.composing) { return }\n    var cm = this.cm;\n    if (cm.somethingSelected()) {\n      this.prevInput = \"\";\n      var content = cm.getSelection();\n      this.textarea.value = content;\n      if (cm.state.focused) { selectInput(this.textarea); }\n      if (ie && ie_version >= 9) { this.hasSelection = content; }\n    } else if (!typing) {\n      this.prevInput = this.textarea.value = \"\";\n      if (ie && ie_version >= 9) { this.hasSelection = null; }\n    }\n  };\n\n  TextareaInput.prototype.getField = function () { return this.textarea };\n\n  TextareaInput.prototype.supportsTouch = function () { return false };\n\n  TextareaInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n      try { this.textarea.focus(); }\n      catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n    }\n  };\n\n  TextareaInput.prototype.blur = function () { this.textarea.blur(); };\n\n  TextareaInput.prototype.resetPosition = function () {\n    this.wrapper.style.top = this.wrapper.style.left = 0;\n  };\n\n  TextareaInput.prototype.receivedFocus = function () { this.slowPoll(); };\n\n  // Poll for input changes, using the normal rate of polling. This\n  // runs as long as the editor is focused.\n  TextareaInput.prototype.slowPoll = function () {\n      var this$1 = this;\n\n    if (this.pollingFast) { return }\n    this.polling.set(this.cm.options.pollInterval, function () {\n      this$1.poll();\n      if (this$1.cm.state.focused) { this$1.slowPoll(); }\n    });\n  };\n\n  // When an event has just come in that is likely to add or change\n  // something in the input textarea, we poll faster, to ensure that\n  // the change appears on the screen quickly.\n  TextareaInput.prototype.fastPoll = function () {\n    var missed = false, input = this;\n    input.pollingFast = true;\n    function p() {\n      var changed = input.poll();\n      if (!changed && !missed) {missed = true; input.polling.set(60, p);}\n      else {input.pollingFast = false; input.slowPoll();}\n    }\n    input.polling.set(20, p);\n  };\n\n  // Read input from the textarea, and update the document to match.\n  // When something is selected, it is present in the textarea, and\n  // selected (unless it is huge, in which case a placeholder is\n  // used). When nothing is selected, the cursor sits after previously\n  // seen text (can be empty), which is stored in prevInput (we must\n  // not reset the textarea when typing, because that breaks IME).\n  TextareaInput.prototype.poll = function () {\n      var this$1 = this;\n\n    var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\n    // Since this is called a *lot*, try to bail out as cheaply as\n    // possible when it is clear that nothing happened. hasSelection\n    // will be the case when there is a lot of text in the textarea,\n    // in which case reading its value would be expensive.\n    if (this.contextMenuPending || !cm.state.focused ||\n        (hasSelection(input) && !prevInput && !this.composing) ||\n        cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\n      { return false }\n\n    var text = input.value;\n    // If nothing changed, bail.\n    if (text == prevInput && !cm.somethingSelected()) { return false }\n    // Work around nonsensical selection resetting in IE9/10, and\n    // inexplicable appearance of private area unicode characters on\n    // some key combos in Mac (#2689).\n    if (ie && ie_version >= 9 && this.hasSelection === text ||\n        mac && /[\\uf700-\\uf7ff]/.test(text)) {\n      cm.display.input.reset();\n      return false\n    }\n\n    if (cm.doc.sel == cm.display.selForContextMenu) {\n      var first = text.charCodeAt(0);\n      if (first == 0x200b && !prevInput) { prevInput = \"\\u200b\"; }\n      if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\") }\n    }\n    // Find the part of the input that is actually new\n    var same = 0, l = Math.min(prevInput.length, text.length);\n    while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same; }\n\n    runInOp(cm, function () {\n      applyTextInput(cm, text.slice(same), prevInput.length - same,\n                     null, this$1.composing ? \"*compose\" : null);\n\n      // Don't leave long text in the textarea, since it makes further polling slow\n      if (text.length > 1000 || text.indexOf(\"\\n\") > -1) { input.value = this$1.prevInput = \"\"; }\n      else { this$1.prevInput = text; }\n\n      if (this$1.composing) {\n        this$1.composing.range.clear();\n        this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"),\n                                           {className: \"CodeMirror-composing\"});\n      }\n    });\n    return true\n  };\n\n  TextareaInput.prototype.ensurePolled = function () {\n    if (this.pollingFast && this.poll()) { this.pollingFast = false; }\n  };\n\n  TextareaInput.prototype.onKeyPress = function () {\n    if (ie && ie_version >= 9) { this.hasSelection = null; }\n    this.fastPoll();\n  };\n\n  TextareaInput.prototype.onContextMenu = function (e) {\n    var input = this, cm = input.cm, display = cm.display, te = input.textarea;\n    if (input.contextMenuPending) { input.contextMenuPending(); }\n    var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n    if (!pos || presto) { return } // Opera is difficult.\n\n    // Reset the current text selection only if the click is done outside of the selection\n    // and 'resetSelectionOnContextMenu' option is true.\n    var reset = cm.options.resetSelectionOnContextMenu;\n    if (reset && cm.doc.sel.contains(pos) == -1)\n      { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll); }\n\n    var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText;\n    var wrapperBox = input.wrapper.offsetParent.getBoundingClientRect();\n    input.wrapper.style.cssText = \"position: static\";\n    te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n    var oldScrollY;\n    if (webkit) { oldScrollY = window.scrollY; } // Work around Chrome issue (#2712)\n    display.input.focus();\n    if (webkit) { window.scrollTo(null, oldScrollY); }\n    display.input.reset();\n    // Adds \"Select all\" to context menu in FF\n    if (!cm.somethingSelected()) { te.value = input.prevInput = \" \"; }\n    input.contextMenuPending = rehide;\n    display.selForContextMenu = cm.doc.sel;\n    clearTimeout(display.detectingSelectAll);\n\n    // Select-all will be greyed out if there's nothing to select, so\n    // this adds a zero-width space so that we can later check whether\n    // it got selected.\n    function prepareSelectAllHack() {\n      if (te.selectionStart != null) {\n        var selected = cm.somethingSelected();\n        var extval = \"\\u200b\" + (selected ? te.value : \"\");\n        te.value = \"\\u21da\"; // Used to catch context-menu undo\n        te.value = extval;\n        input.prevInput = selected ? \"\" : \"\\u200b\";\n        te.selectionStart = 1; te.selectionEnd = extval.length;\n        // Re-set this, in case some other handler touched the\n        // selection in the meantime.\n        display.selForContextMenu = cm.doc.sel;\n      }\n    }\n    function rehide() {\n      if (input.contextMenuPending != rehide) { return }\n      input.contextMenuPending = false;\n      input.wrapper.style.cssText = oldWrapperCSS;\n      te.style.cssText = oldCSS;\n      if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos); }\n\n      // Try to detect the user choosing select-all\n      if (te.selectionStart != null) {\n        if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack(); }\n        var i = 0, poll = function () {\n          if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\n              te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\n            operation(cm, selectAll)(cm);\n          } else if (i++ < 10) {\n            display.detectingSelectAll = setTimeout(poll, 500);\n          } else {\n            display.selForContextMenu = null;\n            display.input.reset();\n          }\n        };\n        display.detectingSelectAll = setTimeout(poll, 200);\n      }\n    }\n\n    if (ie && ie_version >= 9) { prepareSelectAllHack(); }\n    if (captureRightClick) {\n      e_stop(e);\n      var mouseup = function () {\n        off(window, \"mouseup\", mouseup);\n        setTimeout(rehide, 20);\n      };\n      on(window, \"mouseup\", mouseup);\n    } else {\n      setTimeout(rehide, 50);\n    }\n  };\n\n  TextareaInput.prototype.readOnlyChanged = function (val) {\n    if (!val) { this.reset(); }\n    this.textarea.disabled = val == \"nocursor\";\n  };\n\n  TextareaInput.prototype.setUneditable = function () {};\n\n  TextareaInput.prototype.needsContentAttribute = false;\n\n  function fromTextArea(textarea, options) {\n    options = options ? copyObj(options) : {};\n    options.value = textarea.value;\n    if (!options.tabindex && textarea.tabIndex)\n      { options.tabindex = textarea.tabIndex; }\n    if (!options.placeholder && textarea.placeholder)\n      { options.placeholder = textarea.placeholder; }\n    // Set autofocus to true if this textarea is focused, or if it has\n    // autofocus and no other element is focused.\n    if (options.autofocus == null) {\n      var hasFocus = activeElt();\n      options.autofocus = hasFocus == textarea ||\n        textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n    }\n\n    function save() {textarea.value = cm.getValue();}\n\n    var realSubmit;\n    if (textarea.form) {\n      on(textarea.form, \"submit\", save);\n      // Deplorable hack to make the submit method do the right thing.\n      if (!options.leaveSubmitMethodAlone) {\n        var form = textarea.form;\n        realSubmit = form.submit;\n        try {\n          var wrappedSubmit = form.submit = function () {\n            save();\n            form.submit = realSubmit;\n            form.submit();\n            form.submit = wrappedSubmit;\n          };\n        } catch(e) {}\n      }\n    }\n\n    options.finishInit = function (cm) {\n      cm.save = save;\n      cm.getTextArea = function () { return textarea; };\n      cm.toTextArea = function () {\n        cm.toTextArea = isNaN; // Prevent this from being ran twice\n        save();\n        textarea.parentNode.removeChild(cm.getWrapperElement());\n        textarea.style.display = \"\";\n        if (textarea.form) {\n          off(textarea.form, \"submit\", save);\n          if (!options.leaveSubmitMethodAlone && typeof textarea.form.submit == \"function\")\n            { textarea.form.submit = realSubmit; }\n        }\n      };\n    };\n\n    textarea.style.display = \"none\";\n    var cm = CodeMirror(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\n      options);\n    return cm\n  }\n\n  function addLegacyProps(CodeMirror) {\n    CodeMirror.off = off;\n    CodeMirror.on = on;\n    CodeMirror.wheelEventPixels = wheelEventPixels;\n    CodeMirror.Doc = Doc;\n    CodeMirror.splitLines = splitLinesAuto;\n    CodeMirror.countColumn = countColumn;\n    CodeMirror.findColumn = findColumn;\n    CodeMirror.isWordChar = isWordCharBasic;\n    CodeMirror.Pass = Pass;\n    CodeMirror.signal = signal;\n    CodeMirror.Line = Line;\n    CodeMirror.changeEnd = changeEnd;\n    CodeMirror.scrollbarModel = scrollbarModel;\n    CodeMirror.Pos = Pos;\n    CodeMirror.cmpPos = cmp;\n    CodeMirror.modes = modes;\n    CodeMirror.mimeModes = mimeModes;\n    CodeMirror.resolveMode = resolveMode;\n    CodeMirror.getMode = getMode;\n    CodeMirror.modeExtensions = modeExtensions;\n    CodeMirror.extendMode = extendMode;\n    CodeMirror.copyState = copyState;\n    CodeMirror.startState = startState;\n    CodeMirror.innerMode = innerMode;\n    CodeMirror.commands = commands;\n    CodeMirror.keyMap = keyMap;\n    CodeMirror.keyName = keyName;\n    CodeMirror.isModifierKey = isModifierKey;\n    CodeMirror.lookupKey = lookupKey;\n    CodeMirror.normalizeKeyMap = normalizeKeyMap;\n    CodeMirror.StringStream = StringStream;\n    CodeMirror.SharedTextMarker = SharedTextMarker;\n    CodeMirror.TextMarker = TextMarker;\n    CodeMirror.LineWidget = LineWidget;\n    CodeMirror.e_preventDefault = e_preventDefault;\n    CodeMirror.e_stopPropagation = e_stopPropagation;\n    CodeMirror.e_stop = e_stop;\n    CodeMirror.addClass = addClass;\n    CodeMirror.contains = contains;\n    CodeMirror.rmClass = rmClass;\n    CodeMirror.keyNames = keyNames;\n  }\n\n  // EDITOR CONSTRUCTOR\n\n  defineOptions(CodeMirror);\n\n  addEditorMethods(CodeMirror);\n\n  // Set up methods on CodeMirror's prototype to redirect to the editor's document.\n  var dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\n  for (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n    { CodeMirror.prototype[prop] = (function(method) {\n      return function() {return method.apply(this.doc, arguments)}\n    })(Doc.prototype[prop]); } }\n\n  eventMixin(Doc);\n  CodeMirror.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  CodeMirror.defineMode = function(name/*, mode, …*/) {\n    if (!CodeMirror.defaults.mode && name != \"null\") { CodeMirror.defaults.mode = name; }\n    defineMode.apply(this, arguments);\n  };\n\n  CodeMirror.defineMIME = defineMIME;\n\n  // Minimal default mode.\n  CodeMirror.defineMode(\"null\", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); });\n  CodeMirror.defineMIME(\"text/plain\", \"null\");\n\n  // EXTENSIONS\n\n  CodeMirror.defineExtension = function (name, func) {\n    CodeMirror.prototype[name] = func;\n  };\n  CodeMirror.defineDocExtension = function (name, func) {\n    Doc.prototype[name] = func;\n  };\n\n  CodeMirror.fromTextArea = fromTextArea;\n\n  addLegacyProps(CodeMirror);\n\n  CodeMirror.version = \"5.52.2\";\n\n  return CodeMirror;\n\n})));\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? globalThis : require(\"./implementation\");\n","\"use strict\";\n\nvar isValue         = require(\"type/value/is\")\n  , isPlainFunction = require(\"type/plain-function/is\")\n  , assign          = require(\"es5-ext/object/assign\")\n  , normalizeOpts   = require(\"es5-ext/object/normalize-options\")\n  , contains        = require(\"es5-ext/string/#/contains\");\n\nvar d = (module.exports = function (dscr, value/*, options*/) {\n\tvar c, e, w, options, desc;\n\tif (arguments.length < 2 || typeof dscr !== \"string\") {\n\t\toptions = value;\n\t\tvalue = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[2];\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t\tw = contains.call(dscr, \"w\");\n\t} else {\n\t\tc = w = true;\n\t\te = false;\n\t}\n\n\tdesc = { value: value, configurable: c, enumerable: e, writable: w };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n});\n\nd.gs = function (dscr, get, set/*, options*/) {\n\tvar c, e, options, desc;\n\tif (typeof dscr !== \"string\") {\n\t\toptions = set;\n\t\tset = get;\n\t\tget = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[3];\n\t}\n\tif (!isValue(get)) {\n\t\tget = undefined;\n\t} else if (!isPlainFunction(get)) {\n\t\toptions = get;\n\t\tget = set = undefined;\n\t} else if (!isValue(set)) {\n\t\tset = undefined;\n\t} else if (!isPlainFunction(set)) {\n\t\toptions = set;\n\t\tset = undefined;\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t} else {\n\t\tc = true;\n\t\te = false;\n\t}\n\n\tdesc = { get: get, set: set, configurable: c, enumerable: e };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n","\"use strict\";\n\nvar _undefined = require(\"../function/noop\")(); // Support ES3 engines\n\nmodule.exports = function (val) { return val !== _undefined && val !== null; };\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","\"use strict\";\n\n// ES3 safe\nvar _undefined = void 0;\n\nmodule.exports = function (value) { return value !== _undefined && value !== null; };\n","\"use strict\";\n\nvar isSymbol = require(\"./is-symbol\");\n\nmodule.exports = function (value) {\n\tif (!isSymbol(value)) throw new TypeError(value + \" is not a symbol\");\n\treturn value;\n};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/scheduler.production.min.js');\n} else {\n  module.exports = require('./cjs/scheduler.development.js');\n}\n","/** @license React v0.19.1\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';var f,g,h,k,l;\nif(\"undefined\"===typeof window||\"function\"!==typeof MessageChannel){var p=null,q=null,t=function(){if(null!==p)try{var a=exports.unstable_now();p(!0,a);p=null}catch(b){throw setTimeout(t,0),b;}},u=Date.now();exports.unstable_now=function(){return Date.now()-u};f=function(a){null!==p?setTimeout(f,0,a):(p=a,setTimeout(t,0))};g=function(a,b){q=setTimeout(a,b)};h=function(){clearTimeout(q)};k=function(){return!1};l=exports.unstable_forceFrameRate=function(){}}else{var w=window.performance,x=window.Date,\ny=window.setTimeout,z=window.clearTimeout;if(\"undefined\"!==typeof console){var A=window.cancelAnimationFrame;\"function\"!==typeof window.requestAnimationFrame&&console.error(\"This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills\");\"function\"!==typeof A&&console.error(\"This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills\")}if(\"object\"===\ntypeof w&&\"function\"===typeof w.now)exports.unstable_now=function(){return w.now()};else{var B=x.now();exports.unstable_now=function(){return x.now()-B}}var C=!1,D=null,E=-1,F=5,G=0;k=function(){return exports.unstable_now()>=G};l=function(){};exports.unstable_forceFrameRate=function(a){0>a||125<a?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported\"):F=0<a?Math.floor(1E3/a):5};var H=new MessageChannel,I=H.port2;H.port1.onmessage=\nfunction(){if(null!==D){var a=exports.unstable_now();G=a+F;try{D(!0,a)?I.postMessage(null):(C=!1,D=null)}catch(b){throw I.postMessage(null),b;}}else C=!1};f=function(a){D=a;C||(C=!0,I.postMessage(null))};g=function(a,b){E=y(function(){a(exports.unstable_now())},b)};h=function(){z(E);E=-1}}function J(a,b){var c=a.length;a.push(b);a:for(;;){var d=c-1>>>1,e=a[d];if(void 0!==e&&0<K(e,b))a[d]=b,a[c]=e,c=d;else break a}}function L(a){a=a[0];return void 0===a?null:a}\nfunction M(a){var b=a[0];if(void 0!==b){var c=a.pop();if(c!==b){a[0]=c;a:for(var d=0,e=a.length;d<e;){var m=2*(d+1)-1,n=a[m],v=m+1,r=a[v];if(void 0!==n&&0>K(n,c))void 0!==r&&0>K(r,n)?(a[d]=r,a[v]=c,d=v):(a[d]=n,a[m]=c,d=m);else if(void 0!==r&&0>K(r,c))a[d]=r,a[v]=c,d=v;else break a}}return b}return null}function K(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}var N=[],O=[],P=1,Q=null,R=3,S=!1,T=!1,U=!1;\nfunction V(a){for(var b=L(O);null!==b;){if(null===b.callback)M(O);else if(b.startTime<=a)M(O),b.sortIndex=b.expirationTime,J(N,b);else break;b=L(O)}}function W(a){U=!1;V(a);if(!T)if(null!==L(N))T=!0,f(X);else{var b=L(O);null!==b&&g(W,b.startTime-a)}}\nfunction X(a,b){T=!1;U&&(U=!1,h());S=!0;var c=R;try{V(b);for(Q=L(N);null!==Q&&(!(Q.expirationTime>b)||a&&!k());){var d=Q.callback;if(null!==d){Q.callback=null;R=Q.priorityLevel;var e=d(Q.expirationTime<=b);b=exports.unstable_now();\"function\"===typeof e?Q.callback=e:Q===L(N)&&M(N);V(b)}else M(N);Q=L(N)}if(null!==Q)var m=!0;else{var n=L(O);null!==n&&g(W,n.startTime-b);m=!1}return m}finally{Q=null,R=c,S=!1}}\nfunction Y(a){switch(a){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1E4;default:return 5E3}}var Z=l;exports.unstable_IdlePriority=5;exports.unstable_ImmediatePriority=1;exports.unstable_LowPriority=4;exports.unstable_NormalPriority=3;exports.unstable_Profiling=null;exports.unstable_UserBlockingPriority=2;exports.unstable_cancelCallback=function(a){a.callback=null};exports.unstable_continueExecution=function(){T||S||(T=!0,f(X))};\nexports.unstable_getCurrentPriorityLevel=function(){return R};exports.unstable_getFirstCallbackNode=function(){return L(N)};exports.unstable_next=function(a){switch(R){case 1:case 2:case 3:var b=3;break;default:b=R}var c=R;R=b;try{return a()}finally{R=c}};exports.unstable_pauseExecution=function(){};exports.unstable_requestPaint=Z;exports.unstable_runWithPriority=function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=R;R=a;try{return b()}finally{R=c}};\nexports.unstable_scheduleCallback=function(a,b,c){var d=exports.unstable_now();if(\"object\"===typeof c&&null!==c){var e=c.delay;e=\"number\"===typeof e&&0<e?d+e:d;c=\"number\"===typeof c.timeout?c.timeout:Y(a)}else c=Y(a),e=d;c=e+c;a={id:P++,callback:b,priorityLevel:a,startTime:e,expirationTime:c,sortIndex:-1};e>d?(a.sortIndex=e,J(O,a),null===L(N)&&a===L(O)&&(U?h():U=!0,g(W,e-d))):(a.sortIndex=c,J(N,a),T||S||(T=!0,f(X)));return a};\nexports.unstable_shouldYield=function(){var a=exports.unstable_now();V(a);var b=L(N);return b!==Q&&null!==Q&&null!==b&&null!==b.callback&&b.startTime<=a&&b.expirationTime<Q.expirationTime||k()};exports.unstable_wrapCallback=function(a){var b=R;return function(){var c=R;R=b;try{return a.apply(this,arguments)}finally{R=c}}};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")()\n\t? require(\"ext/global-this\").Symbol\n\t: require(\"./polyfill\");\n","\"use strict\";\n\nvar global     = require(\"ext/global-this\")\n  , validTypes = { object: true, symbol: true };\n\nmodule.exports = function () {\n\tvar Symbol = global.Symbol;\n\tvar symbol;\n\tif (typeof Symbol !== \"function\") return false;\n\tsymbol = Symbol(\"test symbol\");\n\ttry { String(symbol); }\n\tcatch (e) { return false; }\n\n\t// Return 'true' also for polyfills\n\tif (!validTypes[typeof Symbol.iterator]) return false;\n\tif (!validTypes[typeof Symbol.toPrimitive]) return false;\n\tif (!validTypes[typeof Symbol.toStringTag]) return false;\n\n\treturn true;\n};\n","\"use strict\";\n\nmodule.exports = function () {\n\tif (typeof globalThis !== \"object\") return false;\n\tif (!globalThis) return false;\n\treturn globalThis.Array === Array;\n};\n","var naiveFallback = function () {\n\tif (typeof self === \"object\" && self) return self;\n\tif (typeof window === \"object\" && window) return window;\n\tthrow new Error(\"Unable to resolve global `this`\");\n};\n\nmodule.exports = (function () {\n\tif (this) return this;\n\n\t// Unexpected strict mode (may happen if e.g. bundled into ESM module)\n\n\t// Thanks @mathiasbynens -> https://mathiasbynens.be/notes/globalthis\n\t// In all ES5+ engines global object inherits from Object.prototype\n\t// (if you approached one that doesn't please report)\n\ttry {\n\t\tObject.defineProperty(Object.prototype, \"__global__\", {\n\t\t\tget: function () { return this; },\n\t\t\tconfigurable: true\n\t\t});\n\t} catch (error) {\n\t\t// Unfortunate case of Object.prototype being sealed (via preventExtensions, seal or freeze)\n\t\treturn naiveFallback();\n\t}\n\ttry {\n\t\t// Safari case (window.__global__ is resolved with global context, but __global__ does not)\n\t\tif (!__global__) return naiveFallback();\n\t\treturn __global__;\n\t} finally {\n\t\tdelete Object.prototype.__global__;\n\t}\n})();\n","// ES2015 Symbol polyfill for environments that do not (or partially) support it\n\n\"use strict\";\n\nvar d                    = require(\"d\")\n  , validateSymbol       = require(\"./validate-symbol\")\n  , NativeSymbol         = require(\"ext/global-this\").Symbol\n  , generateName         = require(\"./lib/private/generate-name\")\n  , setupStandardSymbols = require(\"./lib/private/setup/standard-symbols\")\n  , setupSymbolRegistry  = require(\"./lib/private/setup/symbol-registry\");\n\nvar create = Object.create\n  , defineProperties = Object.defineProperties\n  , defineProperty = Object.defineProperty;\n\nvar SymbolPolyfill, HiddenSymbol, isNativeSafe;\n\nif (typeof NativeSymbol === \"function\") {\n\ttry {\n\t\tString(NativeSymbol());\n\t\tisNativeSafe = true;\n\t} catch (ignore) {}\n} else {\n\tNativeSymbol = null;\n}\n\n// Internal constructor (not one exposed) for creating Symbol instances.\n// This one is used to ensure that `someSymbol instanceof Symbol` always return false\nHiddenSymbol = function Symbol(description) {\n\tif (this instanceof HiddenSymbol) throw new TypeError(\"Symbol is not a constructor\");\n\treturn SymbolPolyfill(description);\n};\n\n// Exposed `Symbol` constructor\n// (returns instances of HiddenSymbol)\nmodule.exports = SymbolPolyfill = function Symbol(description) {\n\tvar symbol;\n\tif (this instanceof Symbol) throw new TypeError(\"Symbol is not a constructor\");\n\tif (isNativeSafe) return NativeSymbol(description);\n\tsymbol = create(HiddenSymbol.prototype);\n\tdescription = description === undefined ? \"\" : String(description);\n\treturn defineProperties(symbol, {\n\t\t__description__: d(\"\", description),\n\t\t__name__: d(\"\", generateName(description))\n\t});\n};\n\nsetupStandardSymbols(SymbolPolyfill);\nsetupSymbolRegistry(SymbolPolyfill);\n\n// Internal tweaks for real symbol producer\ndefineProperties(HiddenSymbol.prototype, {\n\tconstructor: d(SymbolPolyfill),\n\ttoString: d(\"\", function () { return this.__name__; })\n});\n\n// Proper implementation of methods exposed on Symbol.prototype\n// They won't be accessible on produced symbol instances as they derive from HiddenSymbol.prototype\ndefineProperties(SymbolPolyfill.prototype, {\n\ttoString: d(function () { return \"Symbol (\" + validateSymbol(this).__description__ + \")\"; }),\n\tvalueOf: d(function () { return validateSymbol(this); })\n});\ndefineProperty(\n\tSymbolPolyfill.prototype,\n\tSymbolPolyfill.toPrimitive,\n\td(\"\", function () {\n\t\tvar symbol = validateSymbol(this);\n\t\tif (typeof symbol === \"symbol\") return symbol;\n\t\treturn symbol.toString();\n\t})\n);\ndefineProperty(SymbolPolyfill.prototype, SymbolPolyfill.toStringTag, d(\"c\", \"Symbol\"));\n\n// Proper implementaton of toPrimitive and toStringTag for returned symbol instances\ndefineProperty(\n\tHiddenSymbol.prototype, SymbolPolyfill.toStringTag,\n\td(\"c\", SymbolPolyfill.prototype[SymbolPolyfill.toStringTag])\n);\n\n// Note: It's important to define `toPrimitive` as last one, as some implementations\n// implement `toPrimitive` natively without implementing `toStringTag` (or other specified symbols)\n// And that may invoke error in definition flow:\n// See: https://github.com/medikoo/es6-symbol/issues/13#issuecomment-164146149\ndefineProperty(\n\tHiddenSymbol.prototype, SymbolPolyfill.toPrimitive,\n\td(\"c\", SymbolPolyfill.prototype[SymbolPolyfill.toPrimitive])\n);\n","\"use strict\";\n\nvar isFunction = require(\"../function/is\");\n\nvar classRe = /^\\s*class[\\s{/}]/, functionToString = Function.prototype.toString;\n\nmodule.exports = function (value) {\n\tif (!isFunction(value)) return false;\n\tif (classRe.test(functionToString.call(value))) return false;\n\treturn true;\n};\n","\"use strict\";\n\nvar isPrototype = require(\"../prototype/is\");\n\nmodule.exports = function (value) {\n\tif (typeof value !== \"function\") return false;\n\n\tif (!hasOwnProperty.call(value, \"length\")) return false;\n\n\ttry {\n\t\tif (typeof value.length !== \"number\") return false;\n\t\tif (typeof value.call !== \"function\") return false;\n\t\tif (typeof value.apply !== \"function\") return false;\n\t} catch (error) {\n\t\treturn false;\n\t}\n\n\treturn !isPrototype(value);\n};\n","\"use strict\";\n\nvar isObject = require(\"../object/is\");\n\nmodule.exports = function (value) {\n\tif (!isObject(value)) return false;\n\ttry {\n\t\tif (!value.constructor) return false;\n\t\treturn value.constructor.prototype === value;\n\t} catch (error) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isValue = require(\"../value/is\");\n\n// prettier-ignore\nvar possibleTypes = { \"object\": true, \"function\": true, \"undefined\": true /* document.all */ };\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) return false;\n\treturn hasOwnProperty.call(possibleTypes, typeof value);\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.assign : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar assign = Object.assign, obj;\n\tif (typeof assign !== \"function\") return false;\n\tobj = { foo: \"raz\" };\n\tassign(obj, { bar: \"dwa\" }, { trzy: \"trzy\" });\n\treturn obj.foo + obj.bar + obj.trzy === \"razdwatrzy\";\n};\n","\"use strict\";\n\nvar keys  = require(\"../keys\")\n  , value = require(\"../valid-value\")\n  , max   = Math.max;\n\nmodule.exports = function (dest, src/*, …srcn*/) {\n\tvar error, i, length = max(arguments.length, 2), assign;\n\tdest = Object(value(dest));\n\tassign = function (key) {\n\t\ttry {\n\t\t\tdest[key] = src[key];\n\t\t} catch (e) {\n\t\t\tif (!error) error = e;\n\t\t}\n\t};\n\tfor (i = 1; i < length; ++i) {\n\t\tsrc = arguments[i];\n\t\tkeys(src).forEach(assign);\n\t}\n\tif (error !== undefined) throw error;\n\treturn dest;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.keys : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\ttry {\n\t\tObject.keys(\"primitive\");\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isValue = require(\"../is-value\");\n\nvar keys = Object.keys;\n\nmodule.exports = function (object) { return keys(isValue(object) ? Object(object) : object); };\n","\"use strict\";\n\n// eslint-disable-next-line no-empty-function\nmodule.exports = function () {};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) throw new TypeError(\"Cannot use null or undefined\");\n\treturn value;\n};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nvar forEach = Array.prototype.forEach, create = Object.create;\n\nvar process = function (src, obj) {\n\tvar key;\n\tfor (key in src) obj[key] = src[key];\n};\n\n// eslint-disable-next-line no-unused-vars\nmodule.exports = function (opts1/*, …options*/) {\n\tvar result = create(null);\n\tforEach.call(arguments, function (options) {\n\t\tif (!isValue(options)) return;\n\t\tprocess(Object(options), result);\n\t});\n\treturn result;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? String.prototype.contains : require(\"./shim\");\n","\"use strict\";\n\nvar str = \"razdwatrzy\";\n\nmodule.exports = function () {\n\tif (typeof str.contains !== \"function\") return false;\n\treturn str.contains(\"dwa\") === true && str.contains(\"foo\") === false;\n};\n","\"use strict\";\n\nvar indexOf = String.prototype.indexOf;\n\nmodule.exports = function (searchString/*, position*/) {\n\treturn indexOf.call(this, searchString, arguments[1]) > -1;\n};\n","\"use strict\";\n\nmodule.exports = function (value) {\n\tif (!value) return false;\n\tif (typeof value === \"symbol\") return true;\n\tif (!value.constructor) return false;\n\tif (value.constructor.name !== \"Symbol\") return false;\n\treturn value[value.constructor.toStringTag] === \"Symbol\";\n};\n","\"use strict\";\n\nvar d = require(\"d\");\n\nvar create = Object.create, defineProperty = Object.defineProperty, objPrototype = Object.prototype;\n\nvar created = create(null);\nmodule.exports = function (desc) {\n\tvar postfix = 0, name, ie11BugWorkaround;\n\twhile (created[desc + (postfix || \"\")]) ++postfix;\n\tdesc += postfix || \"\";\n\tcreated[desc] = true;\n\tname = \"@@\" + desc;\n\tdefineProperty(\n\t\tobjPrototype,\n\t\tname,\n\t\td.gs(null, function (value) {\n\t\t\t// For IE11 issue see:\n\t\t\t// https://connect.microsoft.com/IE/feedbackdetail/view/1928508/\n\t\t\t//    ie11-broken-getters-on-dom-objects\n\t\t\t// https://github.com/medikoo/es6-symbol/issues/12\n\t\t\tif (ie11BugWorkaround) return;\n\t\t\tie11BugWorkaround = true;\n\t\t\tdefineProperty(this, name, d(value));\n\t\t\tie11BugWorkaround = false;\n\t\t})\n\t);\n\treturn name;\n};\n","\"use strict\";\n\nvar d            = require(\"d\")\n  , NativeSymbol = require(\"ext/global-this\").Symbol;\n\nmodule.exports = function (SymbolPolyfill) {\n\treturn Object.defineProperties(SymbolPolyfill, {\n\t\t// To ensure proper interoperability with other native functions (e.g. Array.from)\n\t\t// fallback to eventual native implementation of given symbol\n\t\thasInstance: d(\n\t\t\t\"\", (NativeSymbol && NativeSymbol.hasInstance) || SymbolPolyfill(\"hasInstance\")\n\t\t),\n\t\tisConcatSpreadable: d(\n\t\t\t\"\",\n\t\t\t(NativeSymbol && NativeSymbol.isConcatSpreadable) ||\n\t\t\t\tSymbolPolyfill(\"isConcatSpreadable\")\n\t\t),\n\t\titerator: d(\"\", (NativeSymbol && NativeSymbol.iterator) || SymbolPolyfill(\"iterator\")),\n\t\tmatch: d(\"\", (NativeSymbol && NativeSymbol.match) || SymbolPolyfill(\"match\")),\n\t\treplace: d(\"\", (NativeSymbol && NativeSymbol.replace) || SymbolPolyfill(\"replace\")),\n\t\tsearch: d(\"\", (NativeSymbol && NativeSymbol.search) || SymbolPolyfill(\"search\")),\n\t\tspecies: d(\"\", (NativeSymbol && NativeSymbol.species) || SymbolPolyfill(\"species\")),\n\t\tsplit: d(\"\", (NativeSymbol && NativeSymbol.split) || SymbolPolyfill(\"split\")),\n\t\ttoPrimitive: d(\n\t\t\t\"\", (NativeSymbol && NativeSymbol.toPrimitive) || SymbolPolyfill(\"toPrimitive\")\n\t\t),\n\t\ttoStringTag: d(\n\t\t\t\"\", (NativeSymbol && NativeSymbol.toStringTag) || SymbolPolyfill(\"toStringTag\")\n\t\t),\n\t\tunscopables: d(\n\t\t\t\"\", (NativeSymbol && NativeSymbol.unscopables) || SymbolPolyfill(\"unscopables\")\n\t\t)\n\t});\n};\n","\"use strict\";\n\nvar d              = require(\"d\")\n  , validateSymbol = require(\"../../../validate-symbol\");\n\nvar registry = Object.create(null);\n\nmodule.exports = function (SymbolPolyfill) {\n\treturn Object.defineProperties(SymbolPolyfill, {\n\t\tfor: d(function (key) {\n\t\t\tif (registry[key]) return registry[key];\n\t\t\treturn (registry[key] = SymbolPolyfill(String(key)));\n\t\t}),\n\t\tkeyFor: d(function (symbol) {\n\t\t\tvar key;\n\t\t\tvalidateSymbol(symbol);\n\t\t\tfor (key in registry) {\n\t\t\t\tif (registry[key] === symbol) return key;\n\t\t\t}\n\t\t\treturn undefined;\n\t\t})\n\t});\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toast-group-container\":\"toast-group-container___2sa2t\",\"fixed-layout\":\"fixed-layout___1JUHs\",\"absolute-layout\":\"absolute-layout___2bqgx\",\"instance-container\":\"instance-container___3-o80\",\"line-break\":\"line-break___3ShLP\",\"toast-root\":\"toast-root___vdTNs\",\"initialized\":\"initialized___2RQe5\",\"main-content\":\"main-content___2VBQ_\",\"icon\":\"icon___3qZYU\",\"content\":\"content___16xZz\",\"success\":\"success___IbFW-\",\"error\":\"error___2AIv0\",\"warning\":\"warning___3J_Rd\",\"loading\":\"loading___3hWPc\",\"in\":\"in___wEgv8\",\"animeIn\":\"animeIn___1_Skp\",\"out\":\"out___1JnlW\",\"animeOut\":\"animeOut___2IrZ6\",\"exit\":\"exit___2IG9Y\"};","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode(\"javascript\", function(config, parserConfig) {\n  var indentUnit = config.indentUnit;\n  var statementIndent = parserConfig.statementIndent;\n  var jsonldMode = parserConfig.jsonld;\n  var jsonMode = parserConfig.json || jsonldMode;\n  var isTS = parserConfig.typescript;\n  var wordRE = parserConfig.wordCharacters || /[\\w$\\xa1-\\uffff]/;\n\n  // Tokenizer\n\n  var keywords = function(){\n    function kw(type) {return {type: type, style: \"keyword\"};}\n    var A = kw(\"keyword a\"), B = kw(\"keyword b\"), C = kw(\"keyword c\"), D = kw(\"keyword d\");\n    var operator = kw(\"operator\"), atom = {type: \"atom\", style: \"atom\"};\n\n    return {\n      \"if\": kw(\"if\"), \"while\": A, \"with\": A, \"else\": B, \"do\": B, \"try\": B, \"finally\": B,\n      \"return\": D, \"break\": D, \"continue\": D, \"new\": kw(\"new\"), \"delete\": C, \"void\": C, \"throw\": C,\n      \"debugger\": kw(\"debugger\"), \"var\": kw(\"var\"), \"const\": kw(\"var\"), \"let\": kw(\"var\"),\n      \"function\": kw(\"function\"), \"catch\": kw(\"catch\"),\n      \"for\": kw(\"for\"), \"switch\": kw(\"switch\"), \"case\": kw(\"case\"), \"default\": kw(\"default\"),\n      \"in\": operator, \"typeof\": operator, \"instanceof\": operator,\n      \"true\": atom, \"false\": atom, \"null\": atom, \"undefined\": atom, \"NaN\": atom, \"Infinity\": atom,\n      \"this\": kw(\"this\"), \"class\": kw(\"class\"), \"super\": kw(\"atom\"),\n      \"yield\": C, \"export\": kw(\"export\"), \"import\": kw(\"import\"), \"extends\": C,\n      \"await\": C\n    };\n  }();\n\n  var isOperatorChar = /[+\\-*&%=<>!?|~^@]/;\n  var isJsonldKeyword = /^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)\"/;\n\n  function readRegexp(stream) {\n    var escaped = false, next, inSet = false;\n    while ((next = stream.next()) != null) {\n      if (!escaped) {\n        if (next == \"/\" && !inSet) return;\n        if (next == \"[\") inSet = true;\n        else if (inSet && next == \"]\") inSet = false;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n  }\n\n  // Used as scratch variables to communicate multiple values without\n  // consing up tons of objects.\n  var type, content;\n  function ret(tp, style, cont) {\n    type = tp; content = cont;\n    return style;\n  }\n  function tokenBase(stream, state) {\n    var ch = stream.next();\n    if (ch == '\"' || ch == \"'\") {\n      state.tokenize = tokenString(ch);\n      return state.tokenize(stream, state);\n    } else if (ch == \".\" && stream.match(/^\\d[\\d_]*(?:[eE][+\\-]?[\\d_]+)?/)) {\n      return ret(\"number\", \"number\");\n    } else if (ch == \".\" && stream.match(\"..\")) {\n      return ret(\"spread\", \"meta\");\n    } else if (/[\\[\\]{}\\(\\),;\\:\\.]/.test(ch)) {\n      return ret(ch);\n    } else if (ch == \"=\" && stream.eat(\">\")) {\n      return ret(\"=>\", \"operator\");\n    } else if (ch == \"0\" && stream.match(/^(?:x[\\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/)) {\n      return ret(\"number\", \"number\");\n    } else if (/\\d/.test(ch)) {\n      stream.match(/^[\\d_]*(?:n|(?:\\.[\\d_]*)?(?:[eE][+\\-]?[\\d_]+)?)?/);\n      return ret(\"number\", \"number\");\n    } else if (ch == \"/\") {\n      if (stream.eat(\"*\")) {\n        state.tokenize = tokenComment;\n        return tokenComment(stream, state);\n      } else if (stream.eat(\"/\")) {\n        stream.skipToEnd();\n        return ret(\"comment\", \"comment\");\n      } else if (expressionAllowed(stream, state, 1)) {\n        readRegexp(stream);\n        stream.match(/^\\b(([gimyus])(?![gimyus]*\\2))+\\b/);\n        return ret(\"regexp\", \"string-2\");\n      } else {\n        stream.eat(\"=\");\n        return ret(\"operator\", \"operator\", stream.current());\n      }\n    } else if (ch == \"`\") {\n      state.tokenize = tokenQuasi;\n      return tokenQuasi(stream, state);\n    } else if (ch == \"#\") {\n      stream.skipToEnd();\n      return ret(\"error\", \"error\");\n    } else if (ch == \"<\" && stream.match(\"!--\") || ch == \"-\" && stream.match(\"->\")) {\n      stream.skipToEnd()\n      return ret(\"comment\", \"comment\")\n    } else if (isOperatorChar.test(ch)) {\n      if (ch != \">\" || !state.lexical || state.lexical.type != \">\") {\n        if (stream.eat(\"=\")) {\n          if (ch == \"!\" || ch == \"=\") stream.eat(\"=\")\n        } else if (/[<>*+\\-]/.test(ch)) {\n          stream.eat(ch)\n          if (ch == \">\") stream.eat(ch)\n        }\n      }\n      return ret(\"operator\", \"operator\", stream.current());\n    } else if (wordRE.test(ch)) {\n      stream.eatWhile(wordRE);\n      var word = stream.current()\n      if (state.lastType != \".\") {\n        if (keywords.propertyIsEnumerable(word)) {\n          var kw = keywords[word]\n          return ret(kw.type, kw.style, word)\n        }\n        if (word == \"async\" && stream.match(/^(\\s|\\/\\*.*?\\*\\/)*[\\[\\(\\w]/, false))\n          return ret(\"async\", \"keyword\", word)\n      }\n      return ret(\"variable\", \"variable\", word)\n    }\n  }\n\n  function tokenString(quote) {\n    return function(stream, state) {\n      var escaped = false, next;\n      if (jsonldMode && stream.peek() == \"@\" && stream.match(isJsonldKeyword)){\n        state.tokenize = tokenBase;\n        return ret(\"jsonld-keyword\", \"meta\");\n      }\n      while ((next = stream.next()) != null) {\n        if (next == quote && !escaped) break;\n        escaped = !escaped && next == \"\\\\\";\n      }\n      if (!escaped) state.tokenize = tokenBase;\n      return ret(\"string\", \"string\");\n    };\n  }\n\n  function tokenComment(stream, state) {\n    var maybeEnd = false, ch;\n    while (ch = stream.next()) {\n      if (ch == \"/\" && maybeEnd) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      maybeEnd = (ch == \"*\");\n    }\n    return ret(\"comment\", \"comment\");\n  }\n\n  function tokenQuasi(stream, state) {\n    var escaped = false, next;\n    while ((next = stream.next()) != null) {\n      if (!escaped && (next == \"`\" || next == \"$\" && stream.eat(\"{\"))) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n    return ret(\"quasi\", \"string-2\", stream.current());\n  }\n\n  var brackets = \"([{}])\";\n  // This is a crude lookahead trick to try and notice that we're\n  // parsing the argument patterns for a fat-arrow function before we\n  // actually hit the arrow token. It only works if the arrow is on\n  // the same line as the arguments and there's no strange noise\n  // (comments) in between. Fallback is to only notice when we hit the\n  // arrow, and not declare the arguments as locals for the arrow\n  // body.\n  function findFatArrow(stream, state) {\n    if (state.fatArrowAt) state.fatArrowAt = null;\n    var arrow = stream.string.indexOf(\"=>\", stream.start);\n    if (arrow < 0) return;\n\n    if (isTS) { // Try to skip TypeScript return type declarations after the arguments\n      var m = /:\\s*(?:\\w+(?:<[^>]*>|\\[\\])?|\\{[^}]*\\})\\s*$/.exec(stream.string.slice(stream.start, arrow))\n      if (m) arrow = m.index\n    }\n\n    var depth = 0, sawSomething = false;\n    for (var pos = arrow - 1; pos >= 0; --pos) {\n      var ch = stream.string.charAt(pos);\n      var bracket = brackets.indexOf(ch);\n      if (bracket >= 0 && bracket < 3) {\n        if (!depth) { ++pos; break; }\n        if (--depth == 0) { if (ch == \"(\") sawSomething = true; break; }\n      } else if (bracket >= 3 && bracket < 6) {\n        ++depth;\n      } else if (wordRE.test(ch)) {\n        sawSomething = true;\n      } else if (/[\"'\\/`]/.test(ch)) {\n        for (;; --pos) {\n          if (pos == 0) return\n          var next = stream.string.charAt(pos - 1)\n          if (next == ch && stream.string.charAt(pos - 2) != \"\\\\\") { pos--; break }\n        }\n      } else if (sawSomething && !depth) {\n        ++pos;\n        break;\n      }\n    }\n    if (sawSomething && !depth) state.fatArrowAt = pos;\n  }\n\n  // Parser\n\n  var atomicTypes = {\"atom\": true, \"number\": true, \"variable\": true, \"string\": true, \"regexp\": true, \"this\": true, \"jsonld-keyword\": true};\n\n  function JSLexical(indented, column, type, align, prev, info) {\n    this.indented = indented;\n    this.column = column;\n    this.type = type;\n    this.prev = prev;\n    this.info = info;\n    if (align != null) this.align = align;\n  }\n\n  function inScope(state, varname) {\n    for (var v = state.localVars; v; v = v.next)\n      if (v.name == varname) return true;\n    for (var cx = state.context; cx; cx = cx.prev) {\n      for (var v = cx.vars; v; v = v.next)\n        if (v.name == varname) return true;\n    }\n  }\n\n  function parseJS(state, style, type, content, stream) {\n    var cc = state.cc;\n    // Communicate our context to the combinators.\n    // (Less wasteful than consing up a hundred closures on every call.)\n    cx.state = state; cx.stream = stream; cx.marked = null, cx.cc = cc; cx.style = style;\n\n    if (!state.lexical.hasOwnProperty(\"align\"))\n      state.lexical.align = true;\n\n    while(true) {\n      var combinator = cc.length ? cc.pop() : jsonMode ? expression : statement;\n      if (combinator(type, content)) {\n        while(cc.length && cc[cc.length - 1].lex)\n          cc.pop()();\n        if (cx.marked) return cx.marked;\n        if (type == \"variable\" && inScope(state, content)) return \"variable-2\";\n        return style;\n      }\n    }\n  }\n\n  // Combinator utils\n\n  var cx = {state: null, column: null, marked: null, cc: null};\n  function pass() {\n    for (var i = arguments.length - 1; i >= 0; i--) cx.cc.push(arguments[i]);\n  }\n  function cont() {\n    pass.apply(null, arguments);\n    return true;\n  }\n  function inList(name, list) {\n    for (var v = list; v; v = v.next) if (v.name == name) return true\n    return false;\n  }\n  function register(varname) {\n    var state = cx.state;\n    cx.marked = \"def\";\n    if (state.context) {\n      if (state.lexical.info == \"var\" && state.context && state.context.block) {\n        // FIXME function decls are also not block scoped\n        var newContext = registerVarScoped(varname, state.context)\n        if (newContext != null) {\n          state.context = newContext\n          return\n        }\n      } else if (!inList(varname, state.localVars)) {\n        state.localVars = new Var(varname, state.localVars)\n        return\n      }\n    }\n    // Fall through means this is global\n    if (parserConfig.globalVars && !inList(varname, state.globalVars))\n      state.globalVars = new Var(varname, state.globalVars)\n  }\n  function registerVarScoped(varname, context) {\n    if (!context) {\n      return null\n    } else if (context.block) {\n      var inner = registerVarScoped(varname, context.prev)\n      if (!inner) return null\n      if (inner == context.prev) return context\n      return new Context(inner, context.vars, true)\n    } else if (inList(varname, context.vars)) {\n      return context\n    } else {\n      return new Context(context.prev, new Var(varname, context.vars), false)\n    }\n  }\n\n  function isModifier(name) {\n    return name == \"public\" || name == \"private\" || name == \"protected\" || name == \"abstract\" || name == \"readonly\"\n  }\n\n  // Combinators\n\n  function Context(prev, vars, block) { this.prev = prev; this.vars = vars; this.block = block }\n  function Var(name, next) { this.name = name; this.next = next }\n\n  var defaultVars = new Var(\"this\", new Var(\"arguments\", null))\n  function pushcontext() {\n    cx.state.context = new Context(cx.state.context, cx.state.localVars, false)\n    cx.state.localVars = defaultVars\n  }\n  function pushblockcontext() {\n    cx.state.context = new Context(cx.state.context, cx.state.localVars, true)\n    cx.state.localVars = null\n  }\n  function popcontext() {\n    cx.state.localVars = cx.state.context.vars\n    cx.state.context = cx.state.context.prev\n  }\n  popcontext.lex = true\n  function pushlex(type, info) {\n    var result = function() {\n      var state = cx.state, indent = state.indented;\n      if (state.lexical.type == \"stat\") indent = state.lexical.indented;\n      else for (var outer = state.lexical; outer && outer.type == \")\" && outer.align; outer = outer.prev)\n        indent = outer.indented;\n      state.lexical = new JSLexical(indent, cx.stream.column(), type, null, state.lexical, info);\n    };\n    result.lex = true;\n    return result;\n  }\n  function poplex() {\n    var state = cx.state;\n    if (state.lexical.prev) {\n      if (state.lexical.type == \")\")\n        state.indented = state.lexical.indented;\n      state.lexical = state.lexical.prev;\n    }\n  }\n  poplex.lex = true;\n\n  function expect(wanted) {\n    function exp(type) {\n      if (type == wanted) return cont();\n      else if (wanted == \";\" || type == \"}\" || type == \")\" || type == \"]\") return pass();\n      else return cont(exp);\n    };\n    return exp;\n  }\n\n  function statement(type, value) {\n    if (type == \"var\") return cont(pushlex(\"vardef\", value), vardef, expect(\";\"), poplex);\n    if (type == \"keyword a\") return cont(pushlex(\"form\"), parenExpr, statement, poplex);\n    if (type == \"keyword b\") return cont(pushlex(\"form\"), statement, poplex);\n    if (type == \"keyword d\") return cx.stream.match(/^\\s*$/, false) ? cont() : cont(pushlex(\"stat\"), maybeexpression, expect(\";\"), poplex);\n    if (type == \"debugger\") return cont(expect(\";\"));\n    if (type == \"{\") return cont(pushlex(\"}\"), pushblockcontext, block, poplex, popcontext);\n    if (type == \";\") return cont();\n    if (type == \"if\") {\n      if (cx.state.lexical.info == \"else\" && cx.state.cc[cx.state.cc.length - 1] == poplex)\n        cx.state.cc.pop()();\n      return cont(pushlex(\"form\"), parenExpr, statement, poplex, maybeelse);\n    }\n    if (type == \"function\") return cont(functiondef);\n    if (type == \"for\") return cont(pushlex(\"form\"), forspec, statement, poplex);\n    if (type == \"class\" || (isTS && value == \"interface\")) {\n      cx.marked = \"keyword\"\n      return cont(pushlex(\"form\", type == \"class\" ? type : value), className, poplex)\n    }\n    if (type == \"variable\") {\n      if (isTS && value == \"declare\") {\n        cx.marked = \"keyword\"\n        return cont(statement)\n      } else if (isTS && (value == \"module\" || value == \"enum\" || value == \"type\") && cx.stream.match(/^\\s*\\w/, false)) {\n        cx.marked = \"keyword\"\n        if (value == \"enum\") return cont(enumdef);\n        else if (value == \"type\") return cont(typename, expect(\"operator\"), typeexpr, expect(\";\"));\n        else return cont(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), block, poplex, poplex)\n      } else if (isTS && value == \"namespace\") {\n        cx.marked = \"keyword\"\n        return cont(pushlex(\"form\"), expression, statement, poplex)\n      } else if (isTS && value == \"abstract\") {\n        cx.marked = \"keyword\"\n        return cont(statement)\n      } else {\n        return cont(pushlex(\"stat\"), maybelabel);\n      }\n    }\n    if (type == \"switch\") return cont(pushlex(\"form\"), parenExpr, expect(\"{\"), pushlex(\"}\", \"switch\"), pushblockcontext,\n                                      block, poplex, poplex, popcontext);\n    if (type == \"case\") return cont(expression, expect(\":\"));\n    if (type == \"default\") return cont(expect(\":\"));\n    if (type == \"catch\") return cont(pushlex(\"form\"), pushcontext, maybeCatchBinding, statement, poplex, popcontext);\n    if (type == \"export\") return cont(pushlex(\"stat\"), afterExport, poplex);\n    if (type == \"import\") return cont(pushlex(\"stat\"), afterImport, poplex);\n    if (type == \"async\") return cont(statement)\n    if (value == \"@\") return cont(expression, statement)\n    return pass(pushlex(\"stat\"), expression, expect(\";\"), poplex);\n  }\n  function maybeCatchBinding(type) {\n    if (type == \"(\") return cont(funarg, expect(\")\"))\n  }\n  function expression(type, value) {\n    return expressionInner(type, value, false);\n  }\n  function expressionNoComma(type, value) {\n    return expressionInner(type, value, true);\n  }\n  function parenExpr(type) {\n    if (type != \"(\") return pass()\n    return cont(pushlex(\")\"), maybeexpression, expect(\")\"), poplex)\n  }\n  function expressionInner(type, value, noComma) {\n    if (cx.state.fatArrowAt == cx.stream.start) {\n      var body = noComma ? arrowBodyNoComma : arrowBody;\n      if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, expect(\"=>\"), body, popcontext);\n      else if (type == \"variable\") return pass(pushcontext, pattern, expect(\"=>\"), body, popcontext);\n    }\n\n    var maybeop = noComma ? maybeoperatorNoComma : maybeoperatorComma;\n    if (atomicTypes.hasOwnProperty(type)) return cont(maybeop);\n    if (type == \"function\") return cont(functiondef, maybeop);\n    if (type == \"class\" || (isTS && value == \"interface\")) { cx.marked = \"keyword\"; return cont(pushlex(\"form\"), classExpression, poplex); }\n    if (type == \"keyword c\" || type == \"async\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"(\") return cont(pushlex(\")\"), maybeexpression, expect(\")\"), poplex, maybeop);\n    if (type == \"operator\" || type == \"spread\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"[\") return cont(pushlex(\"]\"), arrayLiteral, poplex, maybeop);\n    if (type == \"{\") return contCommasep(objprop, \"}\", null, maybeop);\n    if (type == \"quasi\") return pass(quasi, maybeop);\n    if (type == \"new\") return cont(maybeTarget(noComma));\n    if (type == \"import\") return cont(expression);\n    return cont();\n  }\n  function maybeexpression(type) {\n    if (type.match(/[;\\}\\)\\],]/)) return pass();\n    return pass(expression);\n  }\n\n  function maybeoperatorComma(type, value) {\n    if (type == \",\") return cont(maybeexpression);\n    return maybeoperatorNoComma(type, value, false);\n  }\n  function maybeoperatorNoComma(type, value, noComma) {\n    var me = noComma == false ? maybeoperatorComma : maybeoperatorNoComma;\n    var expr = noComma == false ? expression : expressionNoComma;\n    if (type == \"=>\") return cont(pushcontext, noComma ? arrowBodyNoComma : arrowBody, popcontext);\n    if (type == \"operator\") {\n      if (/\\+\\+|--/.test(value) || isTS && value == \"!\") return cont(me);\n      if (isTS && value == \"<\" && cx.stream.match(/^([^>]|<.*?>)*>\\s*\\(/, false))\n        return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, me);\n      if (value == \"?\") return cont(expression, expect(\":\"), expr);\n      return cont(expr);\n    }\n    if (type == \"quasi\") { return pass(quasi, me); }\n    if (type == \";\") return;\n    if (type == \"(\") return contCommasep(expressionNoComma, \")\", \"call\", me);\n    if (type == \".\") return cont(property, me);\n    if (type == \"[\") return cont(pushlex(\"]\"), maybeexpression, expect(\"]\"), poplex, me);\n    if (isTS && value == \"as\") { cx.marked = \"keyword\"; return cont(typeexpr, me) }\n    if (type == \"regexp\") {\n      cx.state.lastType = cx.marked = \"operator\"\n      cx.stream.backUp(cx.stream.pos - cx.stream.start - 1)\n      return cont(expr)\n    }\n  }\n  function quasi(type, value) {\n    if (type != \"quasi\") return pass();\n    if (value.slice(value.length - 2) != \"${\") return cont(quasi);\n    return cont(expression, continueQuasi);\n  }\n  function continueQuasi(type) {\n    if (type == \"}\") {\n      cx.marked = \"string-2\";\n      cx.state.tokenize = tokenQuasi;\n      return cont(quasi);\n    }\n  }\n  function arrowBody(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expression);\n  }\n  function arrowBodyNoComma(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expressionNoComma);\n  }\n  function maybeTarget(noComma) {\n    return function(type) {\n      if (type == \".\") return cont(noComma ? targetNoComma : target);\n      else if (type == \"variable\" && isTS) return cont(maybeTypeArgs, noComma ? maybeoperatorNoComma : maybeoperatorComma)\n      else return pass(noComma ? expressionNoComma : expression);\n    };\n  }\n  function target(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorComma); }\n  }\n  function targetNoComma(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorNoComma); }\n  }\n  function maybelabel(type) {\n    if (type == \":\") return cont(poplex, statement);\n    return pass(maybeoperatorComma, expect(\";\"), poplex);\n  }\n  function property(type) {\n    if (type == \"variable\") {cx.marked = \"property\"; return cont();}\n  }\n  function objprop(type, value) {\n    if (type == \"async\") {\n      cx.marked = \"property\";\n      return cont(objprop);\n    } else if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      if (value == \"get\" || value == \"set\") return cont(getterSetter);\n      var m // Work around fat-arrow-detection complication for detecting typescript typed arrow params\n      if (isTS && cx.state.fatArrowAt == cx.stream.start && (m = cx.stream.match(/^\\s*:\\s*/, false)))\n        cx.state.fatArrowAt = cx.stream.pos + m[0].length\n      return cont(afterprop);\n    } else if (type == \"number\" || type == \"string\") {\n      cx.marked = jsonldMode ? \"property\" : (cx.style + \" property\");\n      return cont(afterprop);\n    } else if (type == \"jsonld-keyword\") {\n      return cont(afterprop);\n    } else if (isTS && isModifier(value)) {\n      cx.marked = \"keyword\"\n      return cont(objprop)\n    } else if (type == \"[\") {\n      return cont(expression, maybetype, expect(\"]\"), afterprop);\n    } else if (type == \"spread\") {\n      return cont(expressionNoComma, afterprop);\n    } else if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(objprop);\n    } else if (type == \":\") {\n      return pass(afterprop)\n    }\n  }\n  function getterSetter(type) {\n    if (type != \"variable\") return pass(afterprop);\n    cx.marked = \"property\";\n    return cont(functiondef);\n  }\n  function afterprop(type) {\n    if (type == \":\") return cont(expressionNoComma);\n    if (type == \"(\") return pass(functiondef);\n  }\n  function commasep(what, end, sep) {\n    function proceed(type, value) {\n      if (sep ? sep.indexOf(type) > -1 : type == \",\") {\n        var lex = cx.state.lexical;\n        if (lex.info == \"call\") lex.pos = (lex.pos || 0) + 1;\n        return cont(function(type, value) {\n          if (type == end || value == end) return pass()\n          return pass(what)\n        }, proceed);\n      }\n      if (type == end || value == end) return cont();\n      if (sep && sep.indexOf(\";\") > -1) return pass(what)\n      return cont(expect(end));\n    }\n    return function(type, value) {\n      if (type == end || value == end) return cont();\n      return pass(what, proceed);\n    };\n  }\n  function contCommasep(what, end, info) {\n    for (var i = 3; i < arguments.length; i++)\n      cx.cc.push(arguments[i]);\n    return cont(pushlex(end, info), commasep(what, end), poplex);\n  }\n  function block(type) {\n    if (type == \"}\") return cont();\n    return pass(statement, block);\n  }\n  function maybetype(type, value) {\n    if (isTS) {\n      if (type == \":\") return cont(typeexpr);\n      if (value == \"?\") return cont(maybetype);\n    }\n  }\n  function maybetypeOrIn(type, value) {\n    if (isTS && (type == \":\" || value == \"in\")) return cont(typeexpr)\n  }\n  function mayberettype(type) {\n    if (isTS && type == \":\") {\n      if (cx.stream.match(/^\\s*\\w+\\s+is\\b/, false)) return cont(expression, isKW, typeexpr)\n      else return cont(typeexpr)\n    }\n  }\n  function isKW(_, value) {\n    if (value == \"is\") {\n      cx.marked = \"keyword\"\n      return cont()\n    }\n  }\n  function typeexpr(type, value) {\n    if (value == \"keyof\" || value == \"typeof\" || value == \"infer\") {\n      cx.marked = \"keyword\"\n      return cont(value == \"typeof\" ? expressionNoComma : typeexpr)\n    }\n    if (type == \"variable\" || value == \"void\") {\n      cx.marked = \"type\"\n      return cont(afterType)\n    }\n    if (value == \"|\" || value == \"&\") return cont(typeexpr)\n    if (type == \"string\" || type == \"number\" || type == \"atom\") return cont(afterType);\n    if (type == \"[\") return cont(pushlex(\"]\"), commasep(typeexpr, \"]\", \",\"), poplex, afterType)\n    if (type == \"{\") return cont(pushlex(\"}\"), commasep(typeprop, \"}\", \",;\"), poplex, afterType)\n    if (type == \"(\") return cont(commasep(typearg, \")\"), maybeReturnType, afterType)\n    if (type == \"<\") return cont(commasep(typeexpr, \">\"), typeexpr)\n  }\n  function maybeReturnType(type) {\n    if (type == \"=>\") return cont(typeexpr)\n  }\n  function typeprop(type, value) {\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\"\n      return cont(typeprop)\n    } else if (value == \"?\" || type == \"number\" || type == \"string\") {\n      return cont(typeprop)\n    } else if (type == \":\") {\n      return cont(typeexpr)\n    } else if (type == \"[\") {\n      return cont(expect(\"variable\"), maybetypeOrIn, expect(\"]\"), typeprop)\n    } else if (type == \"(\") {\n      return pass(functiondecl, typeprop)\n    }\n  }\n  function typearg(type, value) {\n    if (type == \"variable\" && cx.stream.match(/^\\s*[?:]/, false) || value == \"?\") return cont(typearg)\n    if (type == \":\") return cont(typeexpr)\n    if (type == \"spread\") return cont(typearg)\n    return pass(typeexpr)\n  }\n  function afterType(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n    if (value == \"|\" || type == \".\" || value == \"&\") return cont(typeexpr)\n    if (type == \"[\") return cont(typeexpr, expect(\"]\"), afterType)\n    if (value == \"extends\" || value == \"implements\") { cx.marked = \"keyword\"; return cont(typeexpr) }\n    if (value == \"?\") return cont(typeexpr, expect(\":\"), typeexpr)\n  }\n  function maybeTypeArgs(_, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n  }\n  function typeparam() {\n    return pass(typeexpr, maybeTypeDefault)\n  }\n  function maybeTypeDefault(_, value) {\n    if (value == \"=\") return cont(typeexpr)\n  }\n  function vardef(_, value) {\n    if (value == \"enum\") {cx.marked = \"keyword\"; return cont(enumdef)}\n    return pass(pattern, maybetype, maybeAssign, vardefCont);\n  }\n  function pattern(type, value) {\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(pattern) }\n    if (type == \"variable\") { register(value); return cont(); }\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"[\") return contCommasep(eltpattern, \"]\");\n    if (type == \"{\") return contCommasep(proppattern, \"}\");\n  }\n  function proppattern(type, value) {\n    if (type == \"variable\" && !cx.stream.match(/^\\s*:/, false)) {\n      register(value);\n      return cont(maybeAssign);\n    }\n    if (type == \"variable\") cx.marked = \"property\";\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"}\") return pass();\n    if (type == \"[\") return cont(expression, expect(']'), expect(':'), proppattern);\n    return cont(expect(\":\"), pattern, maybeAssign);\n  }\n  function eltpattern() {\n    return pass(pattern, maybeAssign)\n  }\n  function maybeAssign(_type, value) {\n    if (value == \"=\") return cont(expressionNoComma);\n  }\n  function vardefCont(type) {\n    if (type == \",\") return cont(vardef);\n  }\n  function maybeelse(type, value) {\n    if (type == \"keyword b\" && value == \"else\") return cont(pushlex(\"form\", \"else\"), statement, poplex);\n  }\n  function forspec(type, value) {\n    if (value == \"await\") return cont(forspec);\n    if (type == \"(\") return cont(pushlex(\")\"), forspec1, poplex);\n  }\n  function forspec1(type) {\n    if (type == \"var\") return cont(vardef, forspec2);\n    if (type == \"variable\") return cont(forspec2);\n    return pass(forspec2)\n  }\n  function forspec2(type, value) {\n    if (type == \")\") return cont()\n    if (type == \";\") return cont(forspec2)\n    if (value == \"in\" || value == \"of\") { cx.marked = \"keyword\"; return cont(expression, forspec2) }\n    return pass(expression, forspec2)\n  }\n  function functiondef(type, value) {\n    if (value == \"*\") {cx.marked = \"keyword\"; return cont(functiondef);}\n    if (type == \"variable\") {register(value); return cont(functiondef);}\n    if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, statement, popcontext);\n    if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondef)\n  }\n  function functiondecl(type, value) {\n    if (value == \"*\") {cx.marked = \"keyword\"; return cont(functiondecl);}\n    if (type == \"variable\") {register(value); return cont(functiondecl);}\n    if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, popcontext);\n    if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondecl)\n  }\n  function typename(type, value) {\n    if (type == \"keyword\" || type == \"variable\") {\n      cx.marked = \"type\"\n      return cont(typename)\n    } else if (value == \"<\") {\n      return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex)\n    }\n  }\n  function funarg(type, value) {\n    if (value == \"@\") cont(expression, funarg)\n    if (type == \"spread\") return cont(funarg);\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(funarg); }\n    if (isTS && type == \"this\") return cont(maybetype, maybeAssign)\n    return pass(pattern, maybetype, maybeAssign);\n  }\n  function classExpression(type, value) {\n    // Class expressions may have an optional name.\n    if (type == \"variable\") return className(type, value);\n    return classNameAfter(type, value);\n  }\n  function className(type, value) {\n    if (type == \"variable\") {register(value); return cont(classNameAfter);}\n  }\n  function classNameAfter(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, classNameAfter)\n    if (value == \"extends\" || value == \"implements\" || (isTS && type == \",\")) {\n      if (value == \"implements\") cx.marked = \"keyword\";\n      return cont(isTS ? typeexpr : expression, classNameAfter);\n    }\n    if (type == \"{\") return cont(pushlex(\"}\"), classBody, poplex);\n  }\n  function classBody(type, value) {\n    if (type == \"async\" ||\n        (type == \"variable\" &&\n         (value == \"static\" || value == \"get\" || value == \"set\" || (isTS && isModifier(value))) &&\n         cx.stream.match(/^\\s+[\\w$\\xa1-\\uffff]/, false))) {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      return cont(isTS ? classfield : functiondef, classBody);\n    }\n    if (type == \"number\" || type == \"string\") return cont(isTS ? classfield : functiondef, classBody);\n    if (type == \"[\")\n      return cont(expression, maybetype, expect(\"]\"), isTS ? classfield : functiondef, classBody)\n    if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (isTS && type == \"(\") return pass(functiondecl, classBody)\n    if (type == \";\" || type == \",\") return cont(classBody);\n    if (type == \"}\") return cont();\n    if (value == \"@\") return cont(expression, classBody)\n  }\n  function classfield(type, value) {\n    if (value == \"?\") return cont(classfield)\n    if (type == \":\") return cont(typeexpr, maybeAssign)\n    if (value == \"=\") return cont(expressionNoComma)\n    var context = cx.state.lexical.prev, isInterface = context && context.info == \"interface\"\n    return pass(isInterface ? functiondecl : functiondef)\n  }\n  function afterExport(type, value) {\n    if (value == \"*\") { cx.marked = \"keyword\"; return cont(maybeFrom, expect(\";\")); }\n    if (value == \"default\") { cx.marked = \"keyword\"; return cont(expression, expect(\";\")); }\n    if (type == \"{\") return cont(commasep(exportField, \"}\"), maybeFrom, expect(\";\"));\n    return pass(statement);\n  }\n  function exportField(type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(expect(\"variable\")); }\n    if (type == \"variable\") return pass(expressionNoComma, exportField);\n  }\n  function afterImport(type) {\n    if (type == \"string\") return cont();\n    if (type == \"(\") return pass(expression);\n    return pass(importSpec, maybeMoreImports, maybeFrom);\n  }\n  function importSpec(type, value) {\n    if (type == \"{\") return contCommasep(importSpec, \"}\");\n    if (type == \"variable\") register(value);\n    if (value == \"*\") cx.marked = \"keyword\";\n    return cont(maybeAs);\n  }\n  function maybeMoreImports(type) {\n    if (type == \",\") return cont(importSpec, maybeMoreImports)\n  }\n  function maybeAs(_type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(importSpec); }\n  }\n  function maybeFrom(_type, value) {\n    if (value == \"from\") { cx.marked = \"keyword\"; return cont(expression); }\n  }\n  function arrayLiteral(type) {\n    if (type == \"]\") return cont();\n    return pass(commasep(expressionNoComma, \"]\"));\n  }\n  function enumdef() {\n    return pass(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), commasep(enummember, \"}\"), poplex, poplex)\n  }\n  function enummember() {\n    return pass(pattern, maybeAssign);\n  }\n\n  function isContinuedStatement(state, textAfter) {\n    return state.lastType == \"operator\" || state.lastType == \",\" ||\n      isOperatorChar.test(textAfter.charAt(0)) ||\n      /[,.]/.test(textAfter.charAt(0));\n  }\n\n  function expressionAllowed(stream, state, backUp) {\n    return state.tokenize == tokenBase &&\n      /^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\\[{}\\(,;:]|=>)$/.test(state.lastType) ||\n      (state.lastType == \"quasi\" && /\\{\\s*$/.test(stream.string.slice(0, stream.pos - (backUp || 0))))\n  }\n\n  // Interface\n\n  return {\n    startState: function(basecolumn) {\n      var state = {\n        tokenize: tokenBase,\n        lastType: \"sof\",\n        cc: [],\n        lexical: new JSLexical((basecolumn || 0) - indentUnit, 0, \"block\", false),\n        localVars: parserConfig.localVars,\n        context: parserConfig.localVars && new Context(null, null, false),\n        indented: basecolumn || 0\n      };\n      if (parserConfig.globalVars && typeof parserConfig.globalVars == \"object\")\n        state.globalVars = parserConfig.globalVars;\n      return state;\n    },\n\n    token: function(stream, state) {\n      if (stream.sol()) {\n        if (!state.lexical.hasOwnProperty(\"align\"))\n          state.lexical.align = false;\n        state.indented = stream.indentation();\n        findFatArrow(stream, state);\n      }\n      if (state.tokenize != tokenComment && stream.eatSpace()) return null;\n      var style = state.tokenize(stream, state);\n      if (type == \"comment\") return style;\n      state.lastType = type == \"operator\" && (content == \"++\" || content == \"--\") ? \"incdec\" : type;\n      return parseJS(state, style, type, content, stream);\n    },\n\n    indent: function(state, textAfter) {\n      if (state.tokenize == tokenComment) return CodeMirror.Pass;\n      if (state.tokenize != tokenBase) return 0;\n      var firstChar = textAfter && textAfter.charAt(0), lexical = state.lexical, top\n      // Kludge to prevent 'maybelse' from blocking lexical scope pops\n      if (!/^\\s*else\\b/.test(textAfter)) for (var i = state.cc.length - 1; i >= 0; --i) {\n        var c = state.cc[i];\n        if (c == poplex) lexical = lexical.prev;\n        else if (c != maybeelse) break;\n      }\n      while ((lexical.type == \"stat\" || lexical.type == \"form\") &&\n             (firstChar == \"}\" || ((top = state.cc[state.cc.length - 1]) &&\n                                   (top == maybeoperatorComma || top == maybeoperatorNoComma) &&\n                                   !/^[,\\.=+\\-*:?[\\(]/.test(textAfter))))\n        lexical = lexical.prev;\n      if (statementIndent && lexical.type == \")\" && lexical.prev.type == \"stat\")\n        lexical = lexical.prev;\n      var type = lexical.type, closing = firstChar == type;\n\n      if (type == \"vardef\") return lexical.indented + (state.lastType == \"operator\" || state.lastType == \",\" ? lexical.info.length + 1 : 0);\n      else if (type == \"form\" && firstChar == \"{\") return lexical.indented;\n      else if (type == \"form\") return lexical.indented + indentUnit;\n      else if (type == \"stat\")\n        return lexical.indented + (isContinuedStatement(state, textAfter) ? statementIndent || indentUnit : 0);\n      else if (lexical.info == \"switch\" && !closing && parserConfig.doubleIndentSwitch != false)\n        return lexical.indented + (/^(?:case|default)\\b/.test(textAfter) ? indentUnit : 2 * indentUnit);\n      else if (lexical.align) return lexical.column + (closing ? 0 : 1);\n      else return lexical.indented + (closing ? 0 : indentUnit);\n    },\n\n    electricInput: /^\\s*(?:case .*?:|default:|\\{|\\})$/,\n    blockCommentStart: jsonMode ? null : \"/*\",\n    blockCommentEnd: jsonMode ? null : \"*/\",\n    blockCommentContinue: jsonMode ? null : \" * \",\n    lineComment: jsonMode ? null : \"//\",\n    fold: \"brace\",\n    closeBrackets: \"()[]{}''\\\"\\\"``\",\n\n    helperType: jsonMode ? \"json\" : \"javascript\",\n    jsonldMode: jsonldMode,\n    jsonMode: jsonMode,\n\n    expressionAllowed: expressionAllowed,\n\n    skipExpression: function(state) {\n      var top = state.cc[state.cc.length - 1]\n      if (top == expression || top == expressionNoComma) state.cc.pop()\n    }\n  };\n});\n\nCodeMirror.registerHelper(\"wordChars\", \"javascript\", /[\\w$]/);\n\nCodeMirror.defineMIME(\"text/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"text/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/x-javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/json\", {name: \"javascript\", json: true});\nCodeMirror.defineMIME(\"application/x-json\", {name: \"javascript\", json: true});\nCodeMirror.defineMIME(\"application/ld+json\", {name: \"javascript\", jsonld: true});\nCodeMirror.defineMIME(\"text/typescript\", { name: \"javascript\", typescript: true });\nCodeMirror.defineMIME(\"application/typescript\", { name: \"javascript\", typescript: true });\n\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// A rough approximation of Sublime Text's keybindings\n// Depends on addon/search/searchcursor.js and optionally addon/dialog/dialogs.js\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../lib/codemirror\"), require(\"../addon/search/searchcursor\"), require(\"../addon/edit/matchbrackets\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../lib/codemirror\", \"../addon/search/searchcursor\", \"../addon/edit/matchbrackets\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var cmds = CodeMirror.commands;\n  var Pos = CodeMirror.Pos;\n\n  // This is not exactly Sublime's algorithm. I couldn't make heads or tails of that.\n  function findPosSubword(doc, start, dir) {\n    if (dir < 0 && start.ch == 0) return doc.clipPos(Pos(start.line - 1));\n    var line = doc.getLine(start.line);\n    if (dir > 0 && start.ch >= line.length) return doc.clipPos(Pos(start.line + 1, 0));\n    var state = \"start\", type, startPos = start.ch;\n    for (var pos = startPos, e = dir < 0 ? 0 : line.length, i = 0; pos != e; pos += dir, i++) {\n      var next = line.charAt(dir < 0 ? pos - 1 : pos);\n      var cat = next != \"_\" && CodeMirror.isWordChar(next) ? \"w\" : \"o\";\n      if (cat == \"w\" && next.toUpperCase() == next) cat = \"W\";\n      if (state == \"start\") {\n        if (cat != \"o\") { state = \"in\"; type = cat; }\n        else startPos = pos + dir\n      } else if (state == \"in\") {\n        if (type != cat) {\n          if (type == \"w\" && cat == \"W\" && dir < 0) pos--;\n          if (type == \"W\" && cat == \"w\" && dir > 0) { // From uppercase to lowercase\n            if (pos == startPos + 1) { type = \"w\"; continue; }\n            else pos--;\n          }\n          break;\n        }\n      }\n    }\n    return Pos(start.line, pos);\n  }\n\n  function moveSubword(cm, dir) {\n    cm.extendSelectionsBy(function(range) {\n      if (cm.display.shift || cm.doc.extend || range.empty())\n        return findPosSubword(cm.doc, range.head, dir);\n      else\n        return dir < 0 ? range.from() : range.to();\n    });\n  }\n\n  cmds.goSubwordLeft = function(cm) { moveSubword(cm, -1); };\n  cmds.goSubwordRight = function(cm) { moveSubword(cm, 1); };\n\n  cmds.scrollLineUp = function(cm) {\n    var info = cm.getScrollInfo();\n    if (!cm.somethingSelected()) {\n      var visibleBottomLine = cm.lineAtHeight(info.top + info.clientHeight, \"local\");\n      if (cm.getCursor().line >= visibleBottomLine)\n        cm.execCommand(\"goLineUp\");\n    }\n    cm.scrollTo(null, info.top - cm.defaultTextHeight());\n  };\n  cmds.scrollLineDown = function(cm) {\n    var info = cm.getScrollInfo();\n    if (!cm.somethingSelected()) {\n      var visibleTopLine = cm.lineAtHeight(info.top, \"local\")+1;\n      if (cm.getCursor().line <= visibleTopLine)\n        cm.execCommand(\"goLineDown\");\n    }\n    cm.scrollTo(null, info.top + cm.defaultTextHeight());\n  };\n\n  cmds.splitSelectionByLine = function(cm) {\n    var ranges = cm.listSelections(), lineRanges = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var from = ranges[i].from(), to = ranges[i].to();\n      for (var line = from.line; line <= to.line; ++line)\n        if (!(to.line > from.line && line == to.line && to.ch == 0))\n          lineRanges.push({anchor: line == from.line ? from : Pos(line, 0),\n                           head: line == to.line ? to : Pos(line)});\n    }\n    cm.setSelections(lineRanges, 0);\n  };\n\n  cmds.singleSelectionTop = function(cm) {\n    var range = cm.listSelections()[0];\n    cm.setSelection(range.anchor, range.head, {scroll: false});\n  };\n\n  cmds.selectLine = function(cm) {\n    var ranges = cm.listSelections(), extended = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      extended.push({anchor: Pos(range.from().line, 0),\n                     head: Pos(range.to().line + 1, 0)});\n    }\n    cm.setSelections(extended);\n  };\n\n  function insertLine(cm, above) {\n    if (cm.isReadOnly()) return CodeMirror.Pass\n    cm.operation(function() {\n      var len = cm.listSelections().length, newSelection = [], last = -1;\n      for (var i = 0; i < len; i++) {\n        var head = cm.listSelections()[i].head;\n        if (head.line <= last) continue;\n        var at = Pos(head.line + (above ? 0 : 1), 0);\n        cm.replaceRange(\"\\n\", at, null, \"+insertLine\");\n        cm.indentLine(at.line, null, true);\n        newSelection.push({head: at, anchor: at});\n        last = head.line + 1;\n      }\n      cm.setSelections(newSelection);\n    });\n    cm.execCommand(\"indentAuto\");\n  }\n\n  cmds.insertLineAfter = function(cm) { return insertLine(cm, false); };\n\n  cmds.insertLineBefore = function(cm) { return insertLine(cm, true); };\n\n  function wordAt(cm, pos) {\n    var start = pos.ch, end = start, line = cm.getLine(pos.line);\n    while (start && CodeMirror.isWordChar(line.charAt(start - 1))) --start;\n    while (end < line.length && CodeMirror.isWordChar(line.charAt(end))) ++end;\n    return {from: Pos(pos.line, start), to: Pos(pos.line, end), word: line.slice(start, end)};\n  }\n\n  cmds.selectNextOccurrence = function(cm) {\n    var from = cm.getCursor(\"from\"), to = cm.getCursor(\"to\");\n    var fullWord = cm.state.sublimeFindFullWord == cm.doc.sel;\n    if (CodeMirror.cmpPos(from, to) == 0) {\n      var word = wordAt(cm, from);\n      if (!word.word) return;\n      cm.setSelection(word.from, word.to);\n      fullWord = true;\n    } else {\n      var text = cm.getRange(from, to);\n      var query = fullWord ? new RegExp(\"\\\\b\" + text + \"\\\\b\") : text;\n      var cur = cm.getSearchCursor(query, to);\n      var found = cur.findNext();\n      if (!found) {\n        cur = cm.getSearchCursor(query, Pos(cm.firstLine(), 0));\n        found = cur.findNext();\n      }\n      if (!found || isSelectedRange(cm.listSelections(), cur.from(), cur.to())) return\n      cm.addSelection(cur.from(), cur.to());\n    }\n    if (fullWord)\n      cm.state.sublimeFindFullWord = cm.doc.sel;\n  };\n\n  cmds.skipAndSelectNextOccurrence = function(cm) {\n    var prevAnchor = cm.getCursor(\"anchor\"), prevHead = cm.getCursor(\"head\");\n    cmds.selectNextOccurrence(cm);\n    if (CodeMirror.cmpPos(prevAnchor, prevHead) != 0) {\n      cm.doc.setSelections(cm.doc.listSelections()\n          .filter(function (sel) {\n            return sel.anchor != prevAnchor || sel.head != prevHead;\n          }));\n    }\n  }\n\n  function addCursorToSelection(cm, dir) {\n    var ranges = cm.listSelections(), newRanges = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      var newAnchor = cm.findPosV(\n          range.anchor, dir, \"line\", range.anchor.goalColumn);\n      var newHead = cm.findPosV(\n          range.head, dir, \"line\", range.head.goalColumn);\n      newAnchor.goalColumn = range.anchor.goalColumn != null ?\n          range.anchor.goalColumn : cm.cursorCoords(range.anchor, \"div\").left;\n      newHead.goalColumn = range.head.goalColumn != null ?\n          range.head.goalColumn : cm.cursorCoords(range.head, \"div\").left;\n      var newRange = {anchor: newAnchor, head: newHead};\n      newRanges.push(range);\n      newRanges.push(newRange);\n    }\n    cm.setSelections(newRanges);\n  }\n  cmds.addCursorToPrevLine = function(cm) { addCursorToSelection(cm, -1); };\n  cmds.addCursorToNextLine = function(cm) { addCursorToSelection(cm, 1); };\n\n  function isSelectedRange(ranges, from, to) {\n    for (var i = 0; i < ranges.length; i++)\n      if (CodeMirror.cmpPos(ranges[i].from(), from) == 0 &&\n          CodeMirror.cmpPos(ranges[i].to(), to) == 0) return true\n    return false\n  }\n\n  var mirror = \"(){}[]\";\n  function selectBetweenBrackets(cm) {\n    var ranges = cm.listSelections(), newRanges = []\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], pos = range.head, opening = cm.scanForBracket(pos, -1);\n      if (!opening) return false;\n      for (;;) {\n        var closing = cm.scanForBracket(pos, 1);\n        if (!closing) return false;\n        if (closing.ch == mirror.charAt(mirror.indexOf(opening.ch) + 1)) {\n          var startPos = Pos(opening.pos.line, opening.pos.ch + 1);\n          if (CodeMirror.cmpPos(startPos, range.from()) == 0 &&\n              CodeMirror.cmpPos(closing.pos, range.to()) == 0) {\n            opening = cm.scanForBracket(opening.pos, -1);\n            if (!opening) return false;\n          } else {\n            newRanges.push({anchor: startPos, head: closing.pos});\n            break;\n          }\n        }\n        pos = Pos(closing.pos.line, closing.pos.ch + 1);\n      }\n    }\n    cm.setSelections(newRanges);\n    return true;\n  }\n\n  cmds.selectScope = function(cm) {\n    selectBetweenBrackets(cm) || cm.execCommand(\"selectAll\");\n  };\n  cmds.selectBetweenBrackets = function(cm) {\n    if (!selectBetweenBrackets(cm)) return CodeMirror.Pass;\n  };\n\n  function puncType(type) {\n    return !type ? null : /\\bpunctuation\\b/.test(type) ? type : undefined\n  }\n\n  cmds.goToBracket = function(cm) {\n    cm.extendSelectionsBy(function(range) {\n      var next = cm.scanForBracket(range.head, 1, puncType(cm.getTokenTypeAt(range.head)));\n      if (next && CodeMirror.cmpPos(next.pos, range.head) != 0) return next.pos;\n      var prev = cm.scanForBracket(range.head, -1, puncType(cm.getTokenTypeAt(Pos(range.head.line, range.head.ch + 1))));\n      return prev && Pos(prev.pos.line, prev.pos.ch + 1) || range.head;\n    });\n  };\n\n  cmds.swapLineUp = function(cm) {\n    if (cm.isReadOnly()) return CodeMirror.Pass\n    var ranges = cm.listSelections(), linesToMove = [], at = cm.firstLine() - 1, newSels = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], from = range.from().line - 1, to = range.to().line;\n      newSels.push({anchor: Pos(range.anchor.line - 1, range.anchor.ch),\n                    head: Pos(range.head.line - 1, range.head.ch)});\n      if (range.to().ch == 0 && !range.empty()) --to;\n      if (from > at) linesToMove.push(from, to);\n      else if (linesToMove.length) linesToMove[linesToMove.length - 1] = to;\n      at = to;\n    }\n    cm.operation(function() {\n      for (var i = 0; i < linesToMove.length; i += 2) {\n        var from = linesToMove[i], to = linesToMove[i + 1];\n        var line = cm.getLine(from);\n        cm.replaceRange(\"\", Pos(from, 0), Pos(from + 1, 0), \"+swapLine\");\n        if (to > cm.lastLine())\n          cm.replaceRange(\"\\n\" + line, Pos(cm.lastLine()), null, \"+swapLine\");\n        else\n          cm.replaceRange(line + \"\\n\", Pos(to, 0), null, \"+swapLine\");\n      }\n      cm.setSelections(newSels);\n      cm.scrollIntoView();\n    });\n  };\n\n  cmds.swapLineDown = function(cm) {\n    if (cm.isReadOnly()) return CodeMirror.Pass\n    var ranges = cm.listSelections(), linesToMove = [], at = cm.lastLine() + 1;\n    for (var i = ranges.length - 1; i >= 0; i--) {\n      var range = ranges[i], from = range.to().line + 1, to = range.from().line;\n      if (range.to().ch == 0 && !range.empty()) from--;\n      if (from < at) linesToMove.push(from, to);\n      else if (linesToMove.length) linesToMove[linesToMove.length - 1] = to;\n      at = to;\n    }\n    cm.operation(function() {\n      for (var i = linesToMove.length - 2; i >= 0; i -= 2) {\n        var from = linesToMove[i], to = linesToMove[i + 1];\n        var line = cm.getLine(from);\n        if (from == cm.lastLine())\n          cm.replaceRange(\"\", Pos(from - 1), Pos(from), \"+swapLine\");\n        else\n          cm.replaceRange(\"\", Pos(from, 0), Pos(from + 1, 0), \"+swapLine\");\n        cm.replaceRange(line + \"\\n\", Pos(to, 0), null, \"+swapLine\");\n      }\n      cm.scrollIntoView();\n    });\n  };\n\n  cmds.toggleCommentIndented = function(cm) {\n    cm.toggleComment({ indent: true });\n  }\n\n  cmds.joinLines = function(cm) {\n    var ranges = cm.listSelections(), joined = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], from = range.from();\n      var start = from.line, end = range.to().line;\n      while (i < ranges.length - 1 && ranges[i + 1].from().line == end)\n        end = ranges[++i].to().line;\n      joined.push({start: start, end: end, anchor: !range.empty() && from});\n    }\n    cm.operation(function() {\n      var offset = 0, ranges = [];\n      for (var i = 0; i < joined.length; i++) {\n        var obj = joined[i];\n        var anchor = obj.anchor && Pos(obj.anchor.line - offset, obj.anchor.ch), head;\n        for (var line = obj.start; line <= obj.end; line++) {\n          var actual = line - offset;\n          if (line == obj.end) head = Pos(actual, cm.getLine(actual).length + 1);\n          if (actual < cm.lastLine()) {\n            cm.replaceRange(\" \", Pos(actual), Pos(actual + 1, /^\\s*/.exec(cm.getLine(actual + 1))[0].length));\n            ++offset;\n          }\n        }\n        ranges.push({anchor: anchor || head, head: head});\n      }\n      cm.setSelections(ranges, 0);\n    });\n  };\n\n  cmds.duplicateLine = function(cm) {\n    cm.operation(function() {\n      var rangeCount = cm.listSelections().length;\n      for (var i = 0; i < rangeCount; i++) {\n        var range = cm.listSelections()[i];\n        if (range.empty())\n          cm.replaceRange(cm.getLine(range.head.line) + \"\\n\", Pos(range.head.line, 0));\n        else\n          cm.replaceRange(cm.getRange(range.from(), range.to()), range.from());\n      }\n      cm.scrollIntoView();\n    });\n  };\n\n\n  function sortLines(cm, caseSensitive) {\n    if (cm.isReadOnly()) return CodeMirror.Pass\n    var ranges = cm.listSelections(), toSort = [], selected;\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      if (range.empty()) continue;\n      var from = range.from().line, to = range.to().line;\n      while (i < ranges.length - 1 && ranges[i + 1].from().line == to)\n        to = ranges[++i].to().line;\n      if (!ranges[i].to().ch) to--;\n      toSort.push(from, to);\n    }\n    if (toSort.length) selected = true;\n    else toSort.push(cm.firstLine(), cm.lastLine());\n\n    cm.operation(function() {\n      var ranges = [];\n      for (var i = 0; i < toSort.length; i += 2) {\n        var from = toSort[i], to = toSort[i + 1];\n        var start = Pos(from, 0), end = Pos(to);\n        var lines = cm.getRange(start, end, false);\n        if (caseSensitive)\n          lines.sort();\n        else\n          lines.sort(function(a, b) {\n            var au = a.toUpperCase(), bu = b.toUpperCase();\n            if (au != bu) { a = au; b = bu; }\n            return a < b ? -1 : a == b ? 0 : 1;\n          });\n        cm.replaceRange(lines, start, end);\n        if (selected) ranges.push({anchor: start, head: Pos(to + 1, 0)});\n      }\n      if (selected) cm.setSelections(ranges, 0);\n    });\n  }\n\n  cmds.sortLines = function(cm) { sortLines(cm, true); };\n  cmds.sortLinesInsensitive = function(cm) { sortLines(cm, false); };\n\n  cmds.nextBookmark = function(cm) {\n    var marks = cm.state.sublimeBookmarks;\n    if (marks) while (marks.length) {\n      var current = marks.shift();\n      var found = current.find();\n      if (found) {\n        marks.push(current);\n        return cm.setSelection(found.from, found.to);\n      }\n    }\n  };\n\n  cmds.prevBookmark = function(cm) {\n    var marks = cm.state.sublimeBookmarks;\n    if (marks) while (marks.length) {\n      marks.unshift(marks.pop());\n      var found = marks[marks.length - 1].find();\n      if (!found)\n        marks.pop();\n      else\n        return cm.setSelection(found.from, found.to);\n    }\n  };\n\n  cmds.toggleBookmark = function(cm) {\n    var ranges = cm.listSelections();\n    var marks = cm.state.sublimeBookmarks || (cm.state.sublimeBookmarks = []);\n    for (var i = 0; i < ranges.length; i++) {\n      var from = ranges[i].from(), to = ranges[i].to();\n      var found = ranges[i].empty() ? cm.findMarksAt(from) : cm.findMarks(from, to);\n      for (var j = 0; j < found.length; j++) {\n        if (found[j].sublimeBookmark) {\n          found[j].clear();\n          for (var k = 0; k < marks.length; k++)\n            if (marks[k] == found[j])\n              marks.splice(k--, 1);\n          break;\n        }\n      }\n      if (j == found.length)\n        marks.push(cm.markText(from, to, {sublimeBookmark: true, clearWhenEmpty: false}));\n    }\n  };\n\n  cmds.clearBookmarks = function(cm) {\n    var marks = cm.state.sublimeBookmarks;\n    if (marks) for (var i = 0; i < marks.length; i++) marks[i].clear();\n    marks.length = 0;\n  };\n\n  cmds.selectBookmarks = function(cm) {\n    var marks = cm.state.sublimeBookmarks, ranges = [];\n    if (marks) for (var i = 0; i < marks.length; i++) {\n      var found = marks[i].find();\n      if (!found)\n        marks.splice(i--, 0);\n      else\n        ranges.push({anchor: found.from, head: found.to});\n    }\n    if (ranges.length)\n      cm.setSelections(ranges, 0);\n  };\n\n  function modifyWordOrSelection(cm, mod) {\n    cm.operation(function() {\n      var ranges = cm.listSelections(), indices = [], replacements = [];\n      for (var i = 0; i < ranges.length; i++) {\n        var range = ranges[i];\n        if (range.empty()) { indices.push(i); replacements.push(\"\"); }\n        else replacements.push(mod(cm.getRange(range.from(), range.to())));\n      }\n      cm.replaceSelections(replacements, \"around\", \"case\");\n      for (var i = indices.length - 1, at; i >= 0; i--) {\n        var range = ranges[indices[i]];\n        if (at && CodeMirror.cmpPos(range.head, at) > 0) continue;\n        var word = wordAt(cm, range.head);\n        at = word.from;\n        cm.replaceRange(mod(word.word), word.from, word.to);\n      }\n    });\n  }\n\n  cmds.smartBackspace = function(cm) {\n    if (cm.somethingSelected()) return CodeMirror.Pass;\n\n    cm.operation(function() {\n      var cursors = cm.listSelections();\n      var indentUnit = cm.getOption(\"indentUnit\");\n\n      for (var i = cursors.length - 1; i >= 0; i--) {\n        var cursor = cursors[i].head;\n        var toStartOfLine = cm.getRange({line: cursor.line, ch: 0}, cursor);\n        var column = CodeMirror.countColumn(toStartOfLine, null, cm.getOption(\"tabSize\"));\n\n        // Delete by one character by default\n        var deletePos = cm.findPosH(cursor, -1, \"char\", false);\n\n        if (toStartOfLine && !/\\S/.test(toStartOfLine) && column % indentUnit == 0) {\n          var prevIndent = new Pos(cursor.line,\n            CodeMirror.findColumn(toStartOfLine, column - indentUnit, indentUnit));\n\n          // Smart delete only if we found a valid prevIndent location\n          if (prevIndent.ch != cursor.ch) deletePos = prevIndent;\n        }\n\n        cm.replaceRange(\"\", deletePos, cursor, \"+delete\");\n      }\n    });\n  };\n\n  cmds.delLineRight = function(cm) {\n    cm.operation(function() {\n      var ranges = cm.listSelections();\n      for (var i = ranges.length - 1; i >= 0; i--)\n        cm.replaceRange(\"\", ranges[i].anchor, Pos(ranges[i].to().line), \"+delete\");\n      cm.scrollIntoView();\n    });\n  };\n\n  cmds.upcaseAtCursor = function(cm) {\n    modifyWordOrSelection(cm, function(str) { return str.toUpperCase(); });\n  };\n  cmds.downcaseAtCursor = function(cm) {\n    modifyWordOrSelection(cm, function(str) { return str.toLowerCase(); });\n  };\n\n  cmds.setSublimeMark = function(cm) {\n    if (cm.state.sublimeMark) cm.state.sublimeMark.clear();\n    cm.state.sublimeMark = cm.setBookmark(cm.getCursor());\n  };\n  cmds.selectToSublimeMark = function(cm) {\n    var found = cm.state.sublimeMark && cm.state.sublimeMark.find();\n    if (found) cm.setSelection(cm.getCursor(), found);\n  };\n  cmds.deleteToSublimeMark = function(cm) {\n    var found = cm.state.sublimeMark && cm.state.sublimeMark.find();\n    if (found) {\n      var from = cm.getCursor(), to = found;\n      if (CodeMirror.cmpPos(from, to) > 0) { var tmp = to; to = from; from = tmp; }\n      cm.state.sublimeKilled = cm.getRange(from, to);\n      cm.replaceRange(\"\", from, to);\n    }\n  };\n  cmds.swapWithSublimeMark = function(cm) {\n    var found = cm.state.sublimeMark && cm.state.sublimeMark.find();\n    if (found) {\n      cm.state.sublimeMark.clear();\n      cm.state.sublimeMark = cm.setBookmark(cm.getCursor());\n      cm.setCursor(found);\n    }\n  };\n  cmds.sublimeYank = function(cm) {\n    if (cm.state.sublimeKilled != null)\n      cm.replaceSelection(cm.state.sublimeKilled, null, \"paste\");\n  };\n\n  cmds.showInCenter = function(cm) {\n    var pos = cm.cursorCoords(null, \"local\");\n    cm.scrollTo(null, (pos.top + pos.bottom) / 2 - cm.getScrollInfo().clientHeight / 2);\n  };\n\n  function getTarget(cm) {\n    var from = cm.getCursor(\"from\"), to = cm.getCursor(\"to\");\n    if (CodeMirror.cmpPos(from, to) == 0) {\n      var word = wordAt(cm, from);\n      if (!word.word) return;\n      from = word.from;\n      to = word.to;\n    }\n    return {from: from, to: to, query: cm.getRange(from, to), word: word};\n  }\n\n  function findAndGoTo(cm, forward) {\n    var target = getTarget(cm);\n    if (!target) return;\n    var query = target.query;\n    var cur = cm.getSearchCursor(query, forward ? target.to : target.from);\n\n    if (forward ? cur.findNext() : cur.findPrevious()) {\n      cm.setSelection(cur.from(), cur.to());\n    } else {\n      cur = cm.getSearchCursor(query, forward ? Pos(cm.firstLine(), 0)\n                                              : cm.clipPos(Pos(cm.lastLine())));\n      if (forward ? cur.findNext() : cur.findPrevious())\n        cm.setSelection(cur.from(), cur.to());\n      else if (target.word)\n        cm.setSelection(target.from, target.to);\n    }\n  };\n  cmds.findUnder = function(cm) { findAndGoTo(cm, true); };\n  cmds.findUnderPrevious = function(cm) { findAndGoTo(cm,false); };\n  cmds.findAllUnder = function(cm) {\n    var target = getTarget(cm);\n    if (!target) return;\n    var cur = cm.getSearchCursor(target.query);\n    var matches = [];\n    var primaryIndex = -1;\n    while (cur.findNext()) {\n      matches.push({anchor: cur.from(), head: cur.to()});\n      if (cur.from().line <= target.from.line && cur.from().ch <= target.from.ch)\n        primaryIndex++;\n    }\n    cm.setSelections(matches, primaryIndex);\n  };\n\n\n  var keyMap = CodeMirror.keyMap;\n  keyMap.macSublime = {\n    \"Cmd-Left\": \"goLineStartSmart\",\n    \"Shift-Tab\": \"indentLess\",\n    \"Shift-Ctrl-K\": \"deleteLine\",\n    \"Alt-Q\": \"wrapLines\",\n    \"Ctrl-Left\": \"goSubwordLeft\",\n    \"Ctrl-Right\": \"goSubwordRight\",\n    \"Ctrl-Alt-Up\": \"scrollLineUp\",\n    \"Ctrl-Alt-Down\": \"scrollLineDown\",\n    \"Cmd-L\": \"selectLine\",\n    \"Shift-Cmd-L\": \"splitSelectionByLine\",\n    \"Esc\": \"singleSelectionTop\",\n    \"Cmd-Enter\": \"insertLineAfter\",\n    \"Shift-Cmd-Enter\": \"insertLineBefore\",\n    \"Cmd-D\": \"selectNextOccurrence\",\n    \"Shift-Cmd-Space\": \"selectScope\",\n    \"Shift-Cmd-M\": \"selectBetweenBrackets\",\n    \"Cmd-M\": \"goToBracket\",\n    \"Cmd-Ctrl-Up\": \"swapLineUp\",\n    \"Cmd-Ctrl-Down\": \"swapLineDown\",\n    \"Cmd-/\": \"toggleCommentIndented\",\n    \"Cmd-J\": \"joinLines\",\n    \"Shift-Cmd-D\": \"duplicateLine\",\n    \"F5\": \"sortLines\",\n    \"Cmd-F5\": \"sortLinesInsensitive\",\n    \"F2\": \"nextBookmark\",\n    \"Shift-F2\": \"prevBookmark\",\n    \"Cmd-F2\": \"toggleBookmark\",\n    \"Shift-Cmd-F2\": \"clearBookmarks\",\n    \"Alt-F2\": \"selectBookmarks\",\n    \"Backspace\": \"smartBackspace\",\n    \"Cmd-K Cmd-D\": \"skipAndSelectNextOccurrence\",\n    \"Cmd-K Cmd-K\": \"delLineRight\",\n    \"Cmd-K Cmd-U\": \"upcaseAtCursor\",\n    \"Cmd-K Cmd-L\": \"downcaseAtCursor\",\n    \"Cmd-K Cmd-Space\": \"setSublimeMark\",\n    \"Cmd-K Cmd-A\": \"selectToSublimeMark\",\n    \"Cmd-K Cmd-W\": \"deleteToSublimeMark\",\n    \"Cmd-K Cmd-X\": \"swapWithSublimeMark\",\n    \"Cmd-K Cmd-Y\": \"sublimeYank\",\n    \"Cmd-K Cmd-C\": \"showInCenter\",\n    \"Cmd-K Cmd-G\": \"clearBookmarks\",\n    \"Cmd-K Cmd-Backspace\": \"delLineLeft\",\n    \"Cmd-K Cmd-0\": \"unfoldAll\",\n    \"Cmd-K Cmd-J\": \"unfoldAll\",\n    \"Ctrl-Shift-Up\": \"addCursorToPrevLine\",\n    \"Ctrl-Shift-Down\": \"addCursorToNextLine\",\n    \"Cmd-F3\": \"findUnder\",\n    \"Shift-Cmd-F3\": \"findUnderPrevious\",\n    \"Alt-F3\": \"findAllUnder\",\n    \"Shift-Cmd-[\": \"fold\",\n    \"Shift-Cmd-]\": \"unfold\",\n    \"Cmd-I\": \"findIncremental\",\n    \"Shift-Cmd-I\": \"findIncrementalReverse\",\n    \"Cmd-H\": \"replace\",\n    \"F3\": \"findNext\",\n    \"Shift-F3\": \"findPrev\",\n    \"fallthrough\": \"macDefault\"\n  };\n  CodeMirror.normalizeKeyMap(keyMap.macSublime);\n\n  keyMap.pcSublime = {\n    \"Shift-Tab\": \"indentLess\",\n    \"Shift-Ctrl-K\": \"deleteLine\",\n    \"Alt-Q\": \"wrapLines\",\n    \"Ctrl-T\": \"transposeChars\",\n    \"Alt-Left\": \"goSubwordLeft\",\n    \"Alt-Right\": \"goSubwordRight\",\n    \"Ctrl-Up\": \"scrollLineUp\",\n    \"Ctrl-Down\": \"scrollLineDown\",\n    \"Ctrl-L\": \"selectLine\",\n    \"Shift-Ctrl-L\": \"splitSelectionByLine\",\n    \"Esc\": \"singleSelectionTop\",\n    \"Ctrl-Enter\": \"insertLineAfter\",\n    \"Shift-Ctrl-Enter\": \"insertLineBefore\",\n    \"Ctrl-D\": \"selectNextOccurrence\",\n    \"Shift-Ctrl-Space\": \"selectScope\",\n    \"Shift-Ctrl-M\": \"selectBetweenBrackets\",\n    \"Ctrl-M\": \"goToBracket\",\n    \"Shift-Ctrl-Up\": \"swapLineUp\",\n    \"Shift-Ctrl-Down\": \"swapLineDown\",\n    \"Ctrl-/\": \"toggleCommentIndented\",\n    \"Ctrl-J\": \"joinLines\",\n    \"Shift-Ctrl-D\": \"duplicateLine\",\n    \"F9\": \"sortLines\",\n    \"Ctrl-F9\": \"sortLinesInsensitive\",\n    \"F2\": \"nextBookmark\",\n    \"Shift-F2\": \"prevBookmark\",\n    \"Ctrl-F2\": \"toggleBookmark\",\n    \"Shift-Ctrl-F2\": \"clearBookmarks\",\n    \"Alt-F2\": \"selectBookmarks\",\n    \"Backspace\": \"smartBackspace\",\n    \"Ctrl-K Ctrl-D\": \"skipAndSelectNextOccurrence\",\n    \"Ctrl-K Ctrl-K\": \"delLineRight\",\n    \"Ctrl-K Ctrl-U\": \"upcaseAtCursor\",\n    \"Ctrl-K Ctrl-L\": \"downcaseAtCursor\",\n    \"Ctrl-K Ctrl-Space\": \"setSublimeMark\",\n    \"Ctrl-K Ctrl-A\": \"selectToSublimeMark\",\n    \"Ctrl-K Ctrl-W\": \"deleteToSublimeMark\",\n    \"Ctrl-K Ctrl-X\": \"swapWithSublimeMark\",\n    \"Ctrl-K Ctrl-Y\": \"sublimeYank\",\n    \"Ctrl-K Ctrl-C\": \"showInCenter\",\n    \"Ctrl-K Ctrl-G\": \"clearBookmarks\",\n    \"Ctrl-K Ctrl-Backspace\": \"delLineLeft\",\n    \"Ctrl-K Ctrl-0\": \"unfoldAll\",\n    \"Ctrl-K Ctrl-J\": \"unfoldAll\",\n    \"Ctrl-Alt-Up\": \"addCursorToPrevLine\",\n    \"Ctrl-Alt-Down\": \"addCursorToNextLine\",\n    \"Ctrl-F3\": \"findUnder\",\n    \"Shift-Ctrl-F3\": \"findUnderPrevious\",\n    \"Alt-F3\": \"findAllUnder\",\n    \"Shift-Ctrl-[\": \"fold\",\n    \"Shift-Ctrl-]\": \"unfold\",\n    \"Ctrl-I\": \"findIncremental\",\n    \"Shift-Ctrl-I\": \"findIncrementalReverse\",\n    \"Ctrl-H\": \"replace\",\n    \"F3\": \"findNext\",\n    \"Shift-F3\": \"findPrev\",\n    \"fallthrough\": \"pcDefault\"\n  };\n  CodeMirror.normalizeKeyMap(keyMap.pcSublime);\n\n  var mac = keyMap.default == keyMap.macDefault;\n  keyMap.sublime = mac ? keyMap.macSublime : keyMap.pcSublime;\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"))\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod)\n  else // Plain browser env\n    mod(CodeMirror)\n})(function(CodeMirror) {\n  \"use strict\"\n  var Pos = CodeMirror.Pos\n\n  function regexpFlags(regexp) {\n    var flags = regexp.flags\n    return flags != null ? flags : (regexp.ignoreCase ? \"i\" : \"\")\n      + (regexp.global ? \"g\" : \"\")\n      + (regexp.multiline ? \"m\" : \"\")\n  }\n\n  function ensureFlags(regexp, flags) {\n    var current = regexpFlags(regexp), target = current\n    for (var i = 0; i < flags.length; i++) if (target.indexOf(flags.charAt(i)) == -1)\n      target += flags.charAt(i)\n    return current == target ? regexp : new RegExp(regexp.source, target)\n  }\n\n  function maybeMultiline(regexp) {\n    return /\\\\s|\\\\n|\\n|\\\\W|\\\\D|\\[\\^/.test(regexp.source)\n  }\n\n  function searchRegexpForward(doc, regexp, start) {\n    regexp = ensureFlags(regexp, \"g\")\n    for (var line = start.line, ch = start.ch, last = doc.lastLine(); line <= last; line++, ch = 0) {\n      regexp.lastIndex = ch\n      var string = doc.getLine(line), match = regexp.exec(string)\n      if (match)\n        return {from: Pos(line, match.index),\n                to: Pos(line, match.index + match[0].length),\n                match: match}\n    }\n  }\n\n  function searchRegexpForwardMultiline(doc, regexp, start) {\n    if (!maybeMultiline(regexp)) return searchRegexpForward(doc, regexp, start)\n\n    regexp = ensureFlags(regexp, \"gm\")\n    var string, chunk = 1\n    for (var line = start.line, last = doc.lastLine(); line <= last;) {\n      // This grows the search buffer in exponentially-sized chunks\n      // between matches, so that nearby matches are fast and don't\n      // require concatenating the whole document (in case we're\n      // searching for something that has tons of matches), but at the\n      // same time, the amount of retries is limited.\n      for (var i = 0; i < chunk; i++) {\n        if (line > last) break\n        var curLine = doc.getLine(line++)\n        string = string == null ? curLine : string + \"\\n\" + curLine\n      }\n      chunk = chunk * 2\n      regexp.lastIndex = start.ch\n      var match = regexp.exec(string)\n      if (match) {\n        var before = string.slice(0, match.index).split(\"\\n\"), inside = match[0].split(\"\\n\")\n        var startLine = start.line + before.length - 1, startCh = before[before.length - 1].length\n        return {from: Pos(startLine, startCh),\n                to: Pos(startLine + inside.length - 1,\n                        inside.length == 1 ? startCh + inside[0].length : inside[inside.length - 1].length),\n                match: match}\n      }\n    }\n  }\n\n  function lastMatchIn(string, regexp, endMargin) {\n    var match, from = 0\n    while (from <= string.length) {\n      regexp.lastIndex = from\n      var newMatch = regexp.exec(string)\n      if (!newMatch) break\n      var end = newMatch.index + newMatch[0].length\n      if (end > string.length - endMargin) break\n      if (!match || end > match.index + match[0].length)\n        match = newMatch\n      from = newMatch.index + 1\n    }\n    return match\n  }\n\n  function searchRegexpBackward(doc, regexp, start) {\n    regexp = ensureFlags(regexp, \"g\")\n    for (var line = start.line, ch = start.ch, first = doc.firstLine(); line >= first; line--, ch = -1) {\n      var string = doc.getLine(line)\n      var match = lastMatchIn(string, regexp, ch < 0 ? 0 : string.length - ch)\n      if (match)\n        return {from: Pos(line, match.index),\n                to: Pos(line, match.index + match[0].length),\n                match: match}\n    }\n  }\n\n  function searchRegexpBackwardMultiline(doc, regexp, start) {\n    if (!maybeMultiline(regexp)) return searchRegexpBackward(doc, regexp, start)\n    regexp = ensureFlags(regexp, \"gm\")\n    var string, chunkSize = 1, endMargin = doc.getLine(start.line).length - start.ch\n    for (var line = start.line, first = doc.firstLine(); line >= first;) {\n      for (var i = 0; i < chunkSize && line >= first; i++) {\n        var curLine = doc.getLine(line--)\n        string = string == null ? curLine : curLine + \"\\n\" + string\n      }\n      chunkSize *= 2\n\n      var match = lastMatchIn(string, regexp, endMargin)\n      if (match) {\n        var before = string.slice(0, match.index).split(\"\\n\"), inside = match[0].split(\"\\n\")\n        var startLine = line + before.length, startCh = before[before.length - 1].length\n        return {from: Pos(startLine, startCh),\n                to: Pos(startLine + inside.length - 1,\n                        inside.length == 1 ? startCh + inside[0].length : inside[inside.length - 1].length),\n                match: match}\n      }\n    }\n  }\n\n  var doFold, noFold\n  if (String.prototype.normalize) {\n    doFold = function(str) { return str.normalize(\"NFD\").toLowerCase() }\n    noFold = function(str) { return str.normalize(\"NFD\") }\n  } else {\n    doFold = function(str) { return str.toLowerCase() }\n    noFold = function(str) { return str }\n  }\n\n  // Maps a position in a case-folded line back to a position in the original line\n  // (compensating for codepoints increasing in number during folding)\n  function adjustPos(orig, folded, pos, foldFunc) {\n    if (orig.length == folded.length) return pos\n    for (var min = 0, max = pos + Math.max(0, orig.length - folded.length);;) {\n      if (min == max) return min\n      var mid = (min + max) >> 1\n      var len = foldFunc(orig.slice(0, mid)).length\n      if (len == pos) return mid\n      else if (len > pos) max = mid\n      else min = mid + 1\n    }\n  }\n\n  function searchStringForward(doc, query, start, caseFold) {\n    // Empty string would match anything and never progress, so we\n    // define it to match nothing instead.\n    if (!query.length) return null\n    var fold = caseFold ? doFold : noFold\n    var lines = fold(query).split(/\\r|\\n\\r?/)\n\n    search: for (var line = start.line, ch = start.ch, last = doc.lastLine() + 1 - lines.length; line <= last; line++, ch = 0) {\n      var orig = doc.getLine(line).slice(ch), string = fold(orig)\n      if (lines.length == 1) {\n        var found = string.indexOf(lines[0])\n        if (found == -1) continue search\n        var start = adjustPos(orig, string, found, fold) + ch\n        return {from: Pos(line, adjustPos(orig, string, found, fold) + ch),\n                to: Pos(line, adjustPos(orig, string, found + lines[0].length, fold) + ch)}\n      } else {\n        var cutFrom = string.length - lines[0].length\n        if (string.slice(cutFrom) != lines[0]) continue search\n        for (var i = 1; i < lines.length - 1; i++)\n          if (fold(doc.getLine(line + i)) != lines[i]) continue search\n        var end = doc.getLine(line + lines.length - 1), endString = fold(end), lastLine = lines[lines.length - 1]\n        if (endString.slice(0, lastLine.length) != lastLine) continue search\n        return {from: Pos(line, adjustPos(orig, string, cutFrom, fold) + ch),\n                to: Pos(line + lines.length - 1, adjustPos(end, endString, lastLine.length, fold))}\n      }\n    }\n  }\n\n  function searchStringBackward(doc, query, start, caseFold) {\n    if (!query.length) return null\n    var fold = caseFold ? doFold : noFold\n    var lines = fold(query).split(/\\r|\\n\\r?/)\n\n    search: for (var line = start.line, ch = start.ch, first = doc.firstLine() - 1 + lines.length; line >= first; line--, ch = -1) {\n      var orig = doc.getLine(line)\n      if (ch > -1) orig = orig.slice(0, ch)\n      var string = fold(orig)\n      if (lines.length == 1) {\n        var found = string.lastIndexOf(lines[0])\n        if (found == -1) continue search\n        return {from: Pos(line, adjustPos(orig, string, found, fold)),\n                to: Pos(line, adjustPos(orig, string, found + lines[0].length, fold))}\n      } else {\n        var lastLine = lines[lines.length - 1]\n        if (string.slice(0, lastLine.length) != lastLine) continue search\n        for (var i = 1, start = line - lines.length + 1; i < lines.length - 1; i++)\n          if (fold(doc.getLine(start + i)) != lines[i]) continue search\n        var top = doc.getLine(line + 1 - lines.length), topString = fold(top)\n        if (topString.slice(topString.length - lines[0].length) != lines[0]) continue search\n        return {from: Pos(line + 1 - lines.length, adjustPos(top, topString, top.length - lines[0].length, fold)),\n                to: Pos(line, adjustPos(orig, string, lastLine.length, fold))}\n      }\n    }\n  }\n\n  function SearchCursor(doc, query, pos, options) {\n    this.atOccurrence = false\n    this.doc = doc\n    pos = pos ? doc.clipPos(pos) : Pos(0, 0)\n    this.pos = {from: pos, to: pos}\n\n    var caseFold\n    if (typeof options == \"object\") {\n      caseFold = options.caseFold\n    } else { // Backwards compat for when caseFold was the 4th argument\n      caseFold = options\n      options = null\n    }\n\n    if (typeof query == \"string\") {\n      if (caseFold == null) caseFold = false\n      this.matches = function(reverse, pos) {\n        return (reverse ? searchStringBackward : searchStringForward)(doc, query, pos, caseFold)\n      }\n    } else {\n      query = ensureFlags(query, \"gm\")\n      if (!options || options.multiline !== false)\n        this.matches = function(reverse, pos) {\n          return (reverse ? searchRegexpBackwardMultiline : searchRegexpForwardMultiline)(doc, query, pos)\n        }\n      else\n        this.matches = function(reverse, pos) {\n          return (reverse ? searchRegexpBackward : searchRegexpForward)(doc, query, pos)\n        }\n    }\n  }\n\n  SearchCursor.prototype = {\n    findNext: function() {return this.find(false)},\n    findPrevious: function() {return this.find(true)},\n\n    find: function(reverse) {\n      var result = this.matches(reverse, this.doc.clipPos(reverse ? this.pos.from : this.pos.to))\n\n      // Implements weird auto-growing behavior on null-matches for\n      // backwards-compatiblity with the vim code (unfortunately)\n      while (result && CodeMirror.cmpPos(result.from, result.to) == 0) {\n        if (reverse) {\n          if (result.from.ch) result.from = Pos(result.from.line, result.from.ch - 1)\n          else if (result.from.line == this.doc.firstLine()) result = null\n          else result = this.matches(reverse, this.doc.clipPos(Pos(result.from.line - 1)))\n        } else {\n          if (result.to.ch < this.doc.getLine(result.to.line).length) result.to = Pos(result.to.line, result.to.ch + 1)\n          else if (result.to.line == this.doc.lastLine()) result = null\n          else result = this.matches(reverse, Pos(result.to.line + 1, 0))\n        }\n      }\n\n      if (result) {\n        this.pos = result\n        this.atOccurrence = true\n        return this.pos.match || true\n      } else {\n        var end = Pos(reverse ? this.doc.firstLine() : this.doc.lastLine() + 1, 0)\n        this.pos = {from: end, to: end}\n        return this.atOccurrence = false\n      }\n    },\n\n    from: function() {if (this.atOccurrence) return this.pos.from},\n    to: function() {if (this.atOccurrence) return this.pos.to},\n\n    replace: function(newText, origin) {\n      if (!this.atOccurrence) return\n      var lines = CodeMirror.splitLines(newText)\n      this.doc.replaceRange(lines, this.pos.from, this.pos.to, origin)\n      this.pos.to = Pos(this.pos.from.line + lines.length - 1,\n                        lines[lines.length - 1].length + (lines.length == 1 ? this.pos.from.ch : 0))\n    }\n  }\n\n  CodeMirror.defineExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this.doc, query, pos, caseFold)\n  })\n  CodeMirror.defineDocExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this, query, pos, caseFold)\n  })\n\n  CodeMirror.defineExtension(\"selectMatches\", function(query, caseFold) {\n    var ranges = []\n    var cur = this.getSearchCursor(query, this.getCursor(\"from\"), caseFold)\n    while (cur.findNext()) {\n      if (CodeMirror.cmpPos(cur.to(), this.getCursor(\"to\")) > 0) break\n      ranges.push({anchor: cur.from(), head: cur.to()})\n    }\n    if (ranges.length)\n      this.setSelections(ranges, 0)\n  })\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  var ie_lt8 = /MSIE \\d/.test(navigator.userAgent) &&\n    (document.documentMode == null || document.documentMode < 8);\n\n  var Pos = CodeMirror.Pos;\n\n  var matching = {\"(\": \")>\", \")\": \"(<\", \"[\": \"]>\", \"]\": \"[<\", \"{\": \"}>\", \"}\": \"{<\", \"<\": \">>\", \">\": \"<<\"};\n\n  function bracketRegex(config) {\n    return config && config.bracketRegex || /[(){}[\\]]/\n  }\n\n  function findMatchingBracket(cm, where, config) {\n    var line = cm.getLineHandle(where.line), pos = where.ch - 1;\n    var afterCursor = config && config.afterCursor\n    if (afterCursor == null)\n      afterCursor = /(^| )cm-fat-cursor($| )/.test(cm.getWrapperElement().className)\n    var re = bracketRegex(config)\n\n    // A cursor is defined as between two characters, but in in vim command mode\n    // (i.e. not insert mode), the cursor is visually represented as a\n    // highlighted box on top of the 2nd character. Otherwise, we allow matches\n    // from before or after the cursor.\n    var match = (!afterCursor && pos >= 0 && re.test(line.text.charAt(pos)) && matching[line.text.charAt(pos)]) ||\n        re.test(line.text.charAt(pos + 1)) && matching[line.text.charAt(++pos)];\n    if (!match) return null;\n    var dir = match.charAt(1) == \">\" ? 1 : -1;\n    if (config && config.strict && (dir > 0) != (pos == where.ch)) return null;\n    var style = cm.getTokenTypeAt(Pos(where.line, pos + 1));\n\n    var found = scanForBracket(cm, Pos(where.line, pos + (dir > 0 ? 1 : 0)), dir, style || null, config);\n    if (found == null) return null;\n    return {from: Pos(where.line, pos), to: found && found.pos,\n            match: found && found.ch == match.charAt(0), forward: dir > 0};\n  }\n\n  // bracketRegex is used to specify which type of bracket to scan\n  // should be a regexp, e.g. /[[\\]]/\n  //\n  // Note: If \"where\" is on an open bracket, then this bracket is ignored.\n  //\n  // Returns false when no bracket was found, null when it reached\n  // maxScanLines and gave up\n  function scanForBracket(cm, where, dir, style, config) {\n    var maxScanLen = (config && config.maxScanLineLength) || 10000;\n    var maxScanLines = (config && config.maxScanLines) || 1000;\n\n    var stack = [];\n    var re = bracketRegex(config)\n    var lineEnd = dir > 0 ? Math.min(where.line + maxScanLines, cm.lastLine() + 1)\n                          : Math.max(cm.firstLine() - 1, where.line - maxScanLines);\n    for (var lineNo = where.line; lineNo != lineEnd; lineNo += dir) {\n      var line = cm.getLine(lineNo);\n      if (!line) continue;\n      var pos = dir > 0 ? 0 : line.length - 1, end = dir > 0 ? line.length : -1;\n      if (line.length > maxScanLen) continue;\n      if (lineNo == where.line) pos = where.ch - (dir < 0 ? 1 : 0);\n      for (; pos != end; pos += dir) {\n        var ch = line.charAt(pos);\n        if (re.test(ch) && (style === undefined || cm.getTokenTypeAt(Pos(lineNo, pos + 1)) == style)) {\n          var match = matching[ch];\n          if (match && (match.charAt(1) == \">\") == (dir > 0)) stack.push(ch);\n          else if (!stack.length) return {pos: Pos(lineNo, pos), ch: ch};\n          else stack.pop();\n        }\n      }\n    }\n    return lineNo - dir == (dir > 0 ? cm.lastLine() : cm.firstLine()) ? false : null;\n  }\n\n  function matchBrackets(cm, autoclear, config) {\n    // Disable brace matching in long lines, since it'll cause hugely slow updates\n    var maxHighlightLen = cm.state.matchBrackets.maxHighlightLineLength || 1000;\n    var marks = [], ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++) {\n      var match = ranges[i].empty() && findMatchingBracket(cm, ranges[i].head, config);\n      if (match && cm.getLine(match.from.line).length <= maxHighlightLen) {\n        var style = match.match ? \"CodeMirror-matchingbracket\" : \"CodeMirror-nonmatchingbracket\";\n        marks.push(cm.markText(match.from, Pos(match.from.line, match.from.ch + 1), {className: style}));\n        if (match.to && cm.getLine(match.to.line).length <= maxHighlightLen)\n          marks.push(cm.markText(match.to, Pos(match.to.line, match.to.ch + 1), {className: style}));\n      }\n    }\n\n    if (marks.length) {\n      // Kludge to work around the IE bug from issue #1193, where text\n      // input stops going to the textare whever this fires.\n      if (ie_lt8 && cm.state.focused) cm.focus();\n\n      var clear = function() {\n        cm.operation(function() {\n          for (var i = 0; i < marks.length; i++) marks[i].clear();\n        });\n      };\n      if (autoclear) setTimeout(clear, 800);\n      else return clear;\n    }\n  }\n\n  function doMatchBrackets(cm) {\n    cm.operation(function() {\n      if (cm.state.matchBrackets.currentlyHighlighted) {\n        cm.state.matchBrackets.currentlyHighlighted();\n        cm.state.matchBrackets.currentlyHighlighted = null;\n      }\n      cm.state.matchBrackets.currentlyHighlighted = matchBrackets(cm, false, cm.state.matchBrackets);\n    });\n  }\n\n  CodeMirror.defineOption(\"matchBrackets\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      cm.off(\"cursorActivity\", doMatchBrackets);\n      if (cm.state.matchBrackets && cm.state.matchBrackets.currentlyHighlighted) {\n        cm.state.matchBrackets.currentlyHighlighted();\n        cm.state.matchBrackets.currentlyHighlighted = null;\n      }\n    }\n    if (val) {\n      cm.state.matchBrackets = typeof val == \"object\" ? val : {};\n      cm.on(\"cursorActivity\", doMatchBrackets);\n    }\n  });\n\n  CodeMirror.defineExtension(\"matchBrackets\", function() {matchBrackets(this, true);});\n  CodeMirror.defineExtension(\"findMatchingBracket\", function(pos, config, oldConfig){\n    // Backwards-compatibility kludge\n    if (oldConfig || typeof config == \"boolean\") {\n      if (!oldConfig) {\n        config = config ? {strict: true} : null\n      } else {\n        oldConfig.strict = config\n        config = oldConfig\n      }\n    }\n    return findMatchingBracket(this, pos, config)\n  });\n  CodeMirror.defineExtension(\"scanForBracket\", function(pos, dir, style, config){\n    return scanForBracket(this, pos, dir, style, config);\n  });\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var noOptions = {};\n  var nonWS = /[^\\s\\u00a0]/;\n  var Pos = CodeMirror.Pos;\n\n  function firstNonWS(str) {\n    var found = str.search(nonWS);\n    return found == -1 ? 0 : found;\n  }\n\n  CodeMirror.commands.toggleComment = function(cm) {\n    cm.toggleComment();\n  };\n\n  CodeMirror.defineExtension(\"toggleComment\", function(options) {\n    if (!options) options = noOptions;\n    var cm = this;\n    var minLine = Infinity, ranges = this.listSelections(), mode = null;\n    for (var i = ranges.length - 1; i >= 0; i--) {\n      var from = ranges[i].from(), to = ranges[i].to();\n      if (from.line >= minLine) continue;\n      if (to.line >= minLine) to = Pos(minLine, 0);\n      minLine = from.line;\n      if (mode == null) {\n        if (cm.uncomment(from, to, options)) mode = \"un\";\n        else { cm.lineComment(from, to, options); mode = \"line\"; }\n      } else if (mode == \"un\") {\n        cm.uncomment(from, to, options);\n      } else {\n        cm.lineComment(from, to, options);\n      }\n    }\n  });\n\n  // Rough heuristic to try and detect lines that are part of multi-line string\n  function probablyInsideString(cm, pos, line) {\n    return /\\bstring\\b/.test(cm.getTokenTypeAt(Pos(pos.line, 0))) && !/^[\\'\\\"\\`]/.test(line)\n  }\n\n  function getMode(cm, pos) {\n    var mode = cm.getMode()\n    return mode.useInnerComments === false || !mode.innerMode ? mode : cm.getModeAt(pos)\n  }\n\n  CodeMirror.defineExtension(\"lineComment\", function(from, to, options) {\n    if (!options) options = noOptions;\n    var self = this, mode = getMode(self, from);\n    var firstLine = self.getLine(from.line);\n    if (firstLine == null || probablyInsideString(self, from, firstLine)) return;\n\n    var commentString = options.lineComment || mode.lineComment;\n    if (!commentString) {\n      if (options.blockCommentStart || mode.blockCommentStart) {\n        options.fullLines = true;\n        self.blockComment(from, to, options);\n      }\n      return;\n    }\n\n    var end = Math.min(to.ch != 0 || to.line == from.line ? to.line + 1 : to.line, self.lastLine() + 1);\n    var pad = options.padding == null ? \" \" : options.padding;\n    var blankLines = options.commentBlankLines || from.line == to.line;\n\n    self.operation(function() {\n      if (options.indent) {\n        var baseString = null;\n        for (var i = from.line; i < end; ++i) {\n          var line = self.getLine(i);\n          var whitespace = line.slice(0, firstNonWS(line));\n          if (baseString == null || baseString.length > whitespace.length) {\n            baseString = whitespace;\n          }\n        }\n        for (var i = from.line; i < end; ++i) {\n          var line = self.getLine(i), cut = baseString.length;\n          if (!blankLines && !nonWS.test(line)) continue;\n          if (line.slice(0, cut) != baseString) cut = firstNonWS(line);\n          self.replaceRange(baseString + commentString + pad, Pos(i, 0), Pos(i, cut));\n        }\n      } else {\n        for (var i = from.line; i < end; ++i) {\n          if (blankLines || nonWS.test(self.getLine(i)))\n            self.replaceRange(commentString + pad, Pos(i, 0));\n        }\n      }\n    });\n  });\n\n  CodeMirror.defineExtension(\"blockComment\", function(from, to, options) {\n    if (!options) options = noOptions;\n    var self = this, mode = getMode(self, from);\n    var startString = options.blockCommentStart || mode.blockCommentStart;\n    var endString = options.blockCommentEnd || mode.blockCommentEnd;\n    if (!startString || !endString) {\n      if ((options.lineComment || mode.lineComment) && options.fullLines != false)\n        self.lineComment(from, to, options);\n      return;\n    }\n    if (/\\bcomment\\b/.test(self.getTokenTypeAt(Pos(from.line, 0)))) return\n\n    var end = Math.min(to.line, self.lastLine());\n    if (end != from.line && to.ch == 0 && nonWS.test(self.getLine(end))) --end;\n\n    var pad = options.padding == null ? \" \" : options.padding;\n    if (from.line > end) return;\n\n    self.operation(function() {\n      if (options.fullLines != false) {\n        var lastLineHasText = nonWS.test(self.getLine(end));\n        self.replaceRange(pad + endString, Pos(end));\n        self.replaceRange(startString + pad, Pos(from.line, 0));\n        var lead = options.blockCommentLead || mode.blockCommentLead;\n        if (lead != null) for (var i = from.line + 1; i <= end; ++i)\n          if (i != end || lastLineHasText)\n            self.replaceRange(lead + pad, Pos(i, 0));\n      } else {\n        self.replaceRange(endString, to);\n        self.replaceRange(startString, from);\n      }\n    });\n  });\n\n  CodeMirror.defineExtension(\"uncomment\", function(from, to, options) {\n    if (!options) options = noOptions;\n    var self = this, mode = getMode(self, from);\n    var end = Math.min(to.ch != 0 || to.line == from.line ? to.line : to.line - 1, self.lastLine()), start = Math.min(from.line, end);\n\n    // Try finding line comments\n    var lineString = options.lineComment || mode.lineComment, lines = [];\n    var pad = options.padding == null ? \" \" : options.padding, didSomething;\n    lineComment: {\n      if (!lineString) break lineComment;\n      for (var i = start; i <= end; ++i) {\n        var line = self.getLine(i);\n        var found = line.indexOf(lineString);\n        if (found > -1 && !/comment/.test(self.getTokenTypeAt(Pos(i, found + 1)))) found = -1;\n        if (found == -1 && nonWS.test(line)) break lineComment;\n        if (found > -1 && nonWS.test(line.slice(0, found))) break lineComment;\n        lines.push(line);\n      }\n      self.operation(function() {\n        for (var i = start; i <= end; ++i) {\n          var line = lines[i - start];\n          var pos = line.indexOf(lineString), endPos = pos + lineString.length;\n          if (pos < 0) continue;\n          if (line.slice(endPos, endPos + pad.length) == pad) endPos += pad.length;\n          didSomething = true;\n          self.replaceRange(\"\", Pos(i, pos), Pos(i, endPos));\n        }\n      });\n      if (didSomething) return true;\n    }\n\n    // Try block comments\n    var startString = options.blockCommentStart || mode.blockCommentStart;\n    var endString = options.blockCommentEnd || mode.blockCommentEnd;\n    if (!startString || !endString) return false;\n    var lead = options.blockCommentLead || mode.blockCommentLead;\n    var startLine = self.getLine(start), open = startLine.indexOf(startString)\n    if (open == -1) return false\n    var endLine = end == start ? startLine : self.getLine(end)\n    var close = endLine.indexOf(endString, end == start ? open + startString.length : 0);\n    var insideStart = Pos(start, open + 1), insideEnd = Pos(end, close + 1)\n    if (close == -1 ||\n        !/comment/.test(self.getTokenTypeAt(insideStart)) ||\n        !/comment/.test(self.getTokenTypeAt(insideEnd)) ||\n        self.getRange(insideStart, insideEnd, \"\\n\").indexOf(endString) > -1)\n      return false;\n\n    // Avoid killing block comments completely outside the selection.\n    // Positions of the last startString before the start of the selection, and the first endString after it.\n    var lastStart = startLine.lastIndexOf(startString, from.ch);\n    var firstEnd = lastStart == -1 ? -1 : startLine.slice(0, from.ch).indexOf(endString, lastStart + startString.length);\n    if (lastStart != -1 && firstEnd != -1 && firstEnd + endString.length != from.ch) return false;\n    // Positions of the first endString after the end of the selection, and the last startString before it.\n    firstEnd = endLine.indexOf(endString, to.ch);\n    var almostLastStart = endLine.slice(to.ch).lastIndexOf(startString, firstEnd - to.ch);\n    lastStart = (firstEnd == -1 || almostLastStart == -1) ? -1 : to.ch + almostLastStart;\n    if (firstEnd != -1 && lastStart != -1 && lastStart != to.ch) return false;\n\n    self.operation(function() {\n      self.replaceRange(\"\", Pos(end, close - (pad && endLine.slice(close - pad.length, close) == pad ? pad.length : 0)),\n                        Pos(end, close + endString.length));\n      var openEnd = open + startString.length;\n      if (pad && startLine.slice(openEnd, openEnd + pad.length) == pad) openEnd += pad.length;\n      self.replaceRange(\"\", Pos(start, open), Pos(start, openEnd));\n      if (lead) for (var i = start + 1; i <= end; ++i) {\n        var line = self.getLine(i), found = line.indexOf(lead);\n        if (found == -1 || nonWS.test(line.slice(0, found))) continue;\n        var foundEnd = found + lead.length;\n        if (pad && line.slice(foundEnd, foundEnd + pad.length) == pad) foundEnd += pad.length;\n        self.replaceRange(\"\", Pos(i, found), Pos(i, foundEnd));\n      }\n    });\n    return true;\n  });\n});\n","import React, { useState, useEffect, useRef } from 'react'\nimport ReactDOM from 'react-dom'\nconst Symbol = require('es6-symbol')\n\nimport { useReactiveRef, useTimeoutRef } from './hooks'\n\nimport './interface'\n\nconst style = require('./index.less')\n\nconst defaultOption:ToastProp = {\n  type: 'success',\n  message: '',\n  duration: 1000,\n  cssClass: '',\n  sustain: 0,\n  animeDuration: 250,\n  control: null,\n  context: {} as Context,\n  attachment: document.body,\n}\n\nfunction Toast(options: ToastProp) {\n  const [type, setType] = useState(options.type)\n  const [message, setMessage] = useState(options.message)\n  const [duration, setDuration] = useState(options.duration)\n  const [cssClass, setCssClass] = useState(options.cssClass)\n  const timerRef = useTimeoutRef(undefined as unknown as NodeJS.Timeout)\n  const rootRef = useRef(null)\n  const referRef = useRef(Promise.resolve())\n  const sustainRef = useRef(options.sustain)\n  const animeDurRef = useRef(options.animeDuration)\n  const timestampRef = useRef(new Date().getTime())\n  const [initProgress, setInitProgress] = useState(Symbol('sleep'))\n  const curprogress = useReactiveRef(initProgress)\n\n  options.context.goto = goto\n  options.context.delay = delay\n  options.context.set = set\n  \n  useEffect(() => {\n    (async () => {\n      if (!options.control) {\n        await goto('in')\n        await delay(duration)\n        await goto('out')\n        await goto('exit')\n      } else {\n        options.control(options.context)\n      }\n    })()\n  }, [])\n\n  /**\n   * \n   * @param progress string\n   * @description 跳转到流程\n   */\n  function goto(progress:string):Promise<any> {\n    referRef.current = referRef.current.then(() => transit(progress))\n    return referRef.current\n  }\n\n  /**\n   * \n   * @param millisecond number\n   * @description 延迟指定毫秒数\n   */\n  function delay(millisecond:number):Promise<any> {\n    referRef.current = referRef.current.then(() => new Promise(resolve => {\n      if (millisecond >= 0 && millisecond < Infinity) {\n        timerRef.current = setTimeout(() => {\n          resolve()\n        }, millisecond)\n      } else if (millisecond < 0) {\n        resolve()\n      }\n    }) as unknown as Promise<any>)\n\n    return referRef.current\n  }\n\n  /**\n   * \n   * @param progress string\n   * @param option? DefaultToastProp\n   * @description 流转到下一个流程\n   */\n  async function transit(progress:string, option?:DefaultToastProp):Promise<any> {\n    const currenttime = new Date().getTime()\n\n    if (curprogress.current !== initProgress) {\n      const dt = sustainRef.current - (currenttime - timestampRef.current)\n  \n      await new Promise(resolve => {\n        if (dt >= 0) {\n          timerRef.current = setTimeout(() => {\n            resolve()\n          }, dt)\n        } else {\n          resolve()\n        }\n      })\n    }\n\n    option && set(option)\n\n    return new Promise(resolve => {\n      if (curprogress.current === progress) {\n        resolve()\n        return\n      }\n\n      // 防止动画还未结束\n      setTimeout(() => {\n        curprogress.current = progress\n        timestampRef.current = new Date().getTime()\n\n        timerRef.current = setTimeout(() => {\n          resolve()\n          if (progress === 'exit') {\n            const current = rootRef.current as unknown as Element\n            const parent:null|Element = current.parentElement\n            const linebreak:null|undefined|Element = parent?.nextElementSibling\n            const grand:null|undefined|Element = parent?.parentElement\n            const ancestor:null|undefined|Element = grand?.parentElement\n            parent && grand?.removeChild(parent)\n            linebreak && linebreak.className === style['line-break'] && grand?.removeChild(linebreak)\n            grand?.children.length===0 && ancestor?.removeChild(grand)\n          }\n        }, animeDurRef.current)\n      }, 16)\n    })\n  }\n\n  /**\n   * \n   * @param key string\n   * @param value any\n   * @description 更新单个配置项（type|message|duration|cssClass|sustain|animeDuration）\n   */\n  function setSingle(key:string, value:any) {\n    switch (key) {\n      case 'type':\n        setType(value)\n        break\n      case 'message':\n        setMessage(value)\n        break\n      case 'duration':\n        setDuration(value)\n      case 'cssClass':\n        setCssClass(value)\n        break\n      case 'sustain':\n        sustainRef.current = value\n        break\n      case 'animeDuration':\n        animeDurRef.current = value\n        break\n    }\n  }\n\n  /**\n   * \n   * @param payload DefaultToastProp\n   * @description 以对象形式更新多个配置项\n   */\n  function set(payload:DefaultToastProp) {\n    Object.keys(payload).map(key => {\n      setSingle(key, payload[key])\n    })\n  }\n\n  /**\n   * \n   * @param evt AnimationEvent\n   * @description 动画开始|结束时，保存动画属性值，以便流转时过度动画更平滑\n   */\n  function saveAnimateValue(evt:any) {\n    const styleSheets = window.document.styleSheets as any\n    const target = evt.target as HTMLElement\n\n    [...styleSheets]\n      .map(stylesheet => {\n        const rulelist = [...stylesheet.cssRules]\n        .reverse()\n        .find(rulelist => {\n          return rulelist.type === 7 && rulelist.name === evt.animationName\n        }) as any\n          \n        if (rulelist) {\n          const framerule = [...rulelist.cssRules].find(framerule => framerule.keyText === '100%') as any\n\n          if (framerule) {\n            [...framerule.style].map(property => {\n              const value = getComputedStyle(target)[property]\n\n              target.style[property] = value\n            })\n          }\n        }\n      }\n    )\n  }\n\n  return (\n    <div className={`toast-root ${ curprogress.current !== initProgress ? style['initialized'] : ''} ${style['toast-root']} ${type} ${style[type]} ${String(curprogress.current)} ${style[String(curprogress.current)]} ${cssClass}`} style={{ animationDuration: `${animeDurRef.current}ms` }} ref={rootRef}>\n      <div className={`main-content ${style['main-content']}`} onAnimationStart={saveAnimateValue} onAnimationEnd={saveAnimateValue}>\n        <div className={`icon ${style['icon']}`}>&zwj;</div>\n        {\n          message && <div className={`content ${style['content']}`}>{message}</div>\n        }\n      </div>\n    </div>\n  )\n}\n\nfunction createParam(...options: Array<string|DefaultToastProp>):ToastProp {\n  let prop:ToastProp = {\n    ...defaultOption,\n    context: {} as Context,\n  }\n\n  options.map((option:string|DefaultToastProp) => {\n    if (typeof option === 'string') {\n      prop.message = option\n    } else {\n      prop = Object.assign(prop, option)\n    }\n  })\n\n  return prop\n}\n\nconst ToastWrapper:ToastWrapper = function(options: string|DefaultToastProp) {\n  const prop:ToastProp = createParam(options)\n  const attachment = prop.attachment instanceof HTMLElement ? prop.attachment : document.querySelector(prop.attachment)\n\n  if (!attachment) {\n    throw '[attachment] param refers to none exist HTMLElement.'\n  }\n\n  let container = [...attachment.children as unknown as Array<HTMLElement>].find(el => el.className.indexOf(`${style['toast-group-container']}`) !== -1)\n\n  if (!container) {\n    container = document.createElement('div')\n    container.className = `toast-group-container ${style['toast-group-container']} ${attachment === document.body ? style['fixed-layout'] : style['absolute-layout']}`\n    attachment.append(container)\n  }\n\n  // render元素\n  const div:HTMLDivElement = document.createElement('div')\n  div.className = style['instance-container']\n  container.append(div)\n\n  // 换行\n  const linebreak:HTMLDivElement = document.createElement('div')\n  linebreak.className = style['line-break']\n  container.append(linebreak)\n\n  ReactDOM.render(<Toast {...prop} />, div)\n}\n\nToastWrapper.create = (options: string|DefaultToastProp):Context => {\n  const prop:ToastProp = createParam(options, {\n    control: () => {},\n  })\n\n  ToastWrapper(prop)\n\n  return prop.context\n}\n\nexport default ToastWrapper\n","import { useState, useRef } from 'react'\n\n/**\n * @desc 综合useRef的实时性和useState能触发render的特性\n */\nexport function useReactiveRef(initial:any) {\n    let [value, setValue] = useState(initial)\n    const ref = useRef(value)\n    const res:React.MutableRefObject<any> = {\n        current: value,\n    }\n\n    Object.defineProperty(res, 'current', {\n        get() {\n            return value\n        },\n        set(val) {\n            setValue(() => {\n                // 因闭包相关原因，有必要手动执行一次value = val，否则res.current存在stale state现象\n                value = val\n                return val\n            })\n            ref.current = val\n        },\n    })\n\n    return res\n}\n\n/**\n * \n * @desc 可以被赋值setTimeout的返回值，每次赋值前自动clearTimeout\n */\nexport function useTimeoutRef(initial:NodeJS.Timeout) {\n    const ref = useRef(initial)\n    const res:React.MutableRefObject<NodeJS.Timeout> = {\n        current: ref.current,\n    }\n\n    Object.defineProperty(res, 'current', {\n        get() {\n            return ref.current\n        },\n        set(val) {\n            clearTimeout(ref.current as unknown as number)\n            ref.current = val\n        },\n    })\n\n    return res\n}\n","import React, { useState, useRef, useEffect } from 'react'\nimport CodeMirror from 'codemirror'\nimport 'codemirror/mode/javascript/javascript'\nimport 'codemirror/keymap/sublime'\nimport 'codemirror/addon/comment/comment'\nimport 'codemirror/lib/codemirror.css'\nimport 'codemirror/theme/neo.css'\n\nimport Toast from '../../Toast'\n\nimport './style.less'\n\nimport './interface'\n\nexport default function CodeField(props:CodeFieldProp) {\n  const textareaRef = useRef(null as unknown as HTMLTextAreaElement)\n  const presentZoneRef = useRef(null as unknown as HTMLObjectElement)\n  const runBtnRef = useRef(null as unknown as HTMLObjectElement)\n  const [editor, setEditor] = useState(null as unknown as CodeMirror.EditorFromTextArea)\n\n  useEffect(() => {\n    const cm = CodeMirror.fromTextArea(textareaRef.current, {\n      value: '',\n      mode: 'javascript',\n      keyMap: 'sublime',\n      lineNumbers: true,\n      theme: 'neo',\n      readOnly: props.readonly ? 'nocursor' : false,\n    })\n\n    setEditor(cm)\n\n    if (runBtnRef.current) {\n      const handler = run.bind({ Toast })\n      cm.getWrapperElement().appendChild(runBtnRef.current)\n      runBtnRef.current.addEventListener('click', handler)\n    }\n  }, [])\n\n  function run(this: any) {\n    if (!editor) {\n      return\n    }\n    const doc = editor.getDoc()\n    const execStr = doc.getValue()\n    let container\n    if (props.sandboxId) {\n      container = [...presentZoneRef.current.children as unknown as Array<HTMLElement>].find(el => el.className.indexOf('toast-group-container') !== -1)\n    } else if (props.attachment) {\n      container = [...props.attachment.children as unknown as Array<HTMLElement>].find(el => el.className.indexOf('toast-group-container') !== -1)\n    }\n    container?.remove()\n    try {\n      Function(\n      'ctx',\n      `with (ctx){\n          ${execStr}\n      }`,\n      )(this)\n    } catch(err) {}\n  }\n\n  return (\n    <div className=\"code-field-root\">\n      <textarea\n          ref={textareaRef}\n          onChange={() => {}}\n          value={props.code}\n      />\n      {\n        props.runBtn && <div ref={runBtnRef} className=\"run-btn\" onClick={run.bind({Toast})}>run</div>\n      }\n      {\n        props.sandboxId && <div ref={presentZoneRef} id={props.sandboxId} data-id={`#${props.sandboxId}`} className=\"presentation-zone\" />\n      }\n    </div>\n  )\n}\n","import React, { useRef, useEffect } from 'react'\n\nimport './style.less'\n\nimport './interface'\n\ndocument.addEventListener('click', () => {\n    let els = document.querySelectorAll('.click-flash, .out-line') as unknown as Array<Element>\n    els = els.length ? [...els] : []\n\n    els.map(el => el.classList.remove('click-flash', 'out-line'))\n}, {\n    passive: true,\n    capture: false,\n})\n\nexport default function Anchor(props:AnchorProps) {\n    const domRef = useRef(null as unknown as HTMLAnchorElement)\n\n    useEffect(() => {\n        const handler = (add:boolean, toclass:string, fromclass?:string) => (evt:any) => {\n            if (props.href?.[0] === '#') {\n                const el = document.querySelector(props.href)\n\n                if (add) {\n                    let els = document.querySelectorAll(`.${toclass}, .${fromclass}`) as unknown as Array<Element>\n                    els = els.length ? [...els] : []\n\n                    els.map(el => {\n                        el.classList.remove(toclass, fromclass as string)\n                    })\n                    el?.classList.add(toclass)\n                    fromclass && evt.currentTarget.classList.add(fromclass)\n                } else {\n                    el?.classList.remove(toclass)\n                }\n\n                evt.stopPropagation()\n            }\n        }\n        const hoverAdd = handler(true, 'hover-flash')\n        const hoverRemove = handler(false, 'hover-flash')\n        const clickAdd = handler(true, 'click-flash', 'out-line')\n        const option = {\n            passive: true,\n            capture: true,\n        }\n\n        domRef.current.addEventListener('mouseover', hoverAdd, option)\n        domRef.current.addEventListener('mouseout', hoverRemove, option)\n        domRef.current.addEventListener('click', clickAdd, option)\n        \n        return () => {\n            domRef.current.removeEventListener('mouseover', hoverAdd)\n            domRef.current.removeEventListener('mouseout', hoverRemove)\n            domRef.current.removeEventListener('click', clickAdd)\n        }\n    }, [])\n    return (<a href={props.href} id={props.id} ref={domRef}>\n        { props.children }\n    </a>)\n}\n","import React, { useRef, useEffect } from \"react\"\nimport ReactDOM from 'react-dom'\n\nimport Toast from './Toast'\nimport CodeField from './components/CodeField'\nimport Anchor from './components/Anchor'\n\nimport './style.less'\n\nfunction App() {\n  const instance = useRef(null as unknown as Context)\n  useEffect(() => {\n    instance.current = Toast.create({\n      cssClass: 'present-toast',\n      attachment: '#carousel',\n    })\n  }, [])\n\n  useEffect(() => {\n    setTimeout(async () => {\n      enum TYPE_ENUM { success, error, warning, loading, length }\n      enum MESSAGE_ENUM {\n        'This is a React Component, Made by React Hooks.',\n        'Already support 4 types: success|error|warning|loading.',\n        'You can also override or add your own type by style.',\n        'For example: Shrink',\n        'Another example: tremble',\n        'import Toast from \\'@senwii/toast\\';',\n        'Toast(\\'message\\');',\n        length,\n      }\n      for(let i=0;;i++) {\n        const type = TYPE_ENUM[i%TYPE_ENUM.length]\n        instance.current.set({\n          type,\n          message: MESSAGE_ENUM[i%MESSAGE_ENUM.length],\n        })\n\n        switch (i%MESSAGE_ENUM.length) {\n          case 3:\n            instance.current.set({\n              animeDuration: 1000,\n            })\n            await instance.current.goto('shrink')\n            instance.current.set({\n              animeDuration: 250,\n            })\n            break\n          case 4:\n            instance.current.set({\n              animeDuration: 1000,\n            })\n            await instance.current.goto('tremble')\n            instance.current.set({\n              animeDuration: 250,\n            })\n            break\n          default:\n            await instance.current.goto('in')\n        }\n        await instance.current.delay(3500)\n        await instance.current.goto('out')\n      }\n    }, 10)\n  })\n  return (\n    <div className=\"root\">\n      <div className=\"top-block\">\n\n        <h1>@senwii/toast</h1>\n        <img src=\"//img.shields.io/github/license/senwii/toast\" />\n        &nbsp;\n        <object data=\"//img.shields.io/github/forks/senwii/toast?link=https%3A%2F%2Fgithub.com%2Fsenwii%2Ftoast%2Ffork\" />\n        &nbsp;\n        <img src=\"//img.shields.io/github/stars/senwii/toast\" />\n        &nbsp;\n        <img src=\"//github.com/senwii/toast/workflows/ci/badge.svg\" />\n        <div id=\"carousel\"></div>\n      </div>\n      <p>This is a <Anchor href=\"//github.com/senwii/toast\">Toast</Anchor> UI Component written by React Hooks and Typescript. <b>Type</b> and <b>progress</b> are used to describe a toast's state. The former decides the icon outlooking, like success tick or error cross. And the latter shows animations while changing to different progress. Of course, a set of api like <b>set()</b> <b>delay()</b> <b>goto()</b> are provided to control them. So, edit the nether codes and have a try!</p>\n      <section>\n        <h3><Anchor href=\"#instantiate\" id=\"instantiate\">Instantiate</Anchor></h3>\n        <div>\n          <ul>\n            <li>\n              <Anchor href=\"#toast\" id=\"toast\"><code>Toast(options)</code></Anchor>\n              <br />\n              <p>This will instantiate a toast immediately. options description can be seen <Anchor href=\"#options\">here</Anchor>. Sometimes we want to activate a toast not immediately but lazily, we can use <Anchor href=\"#toast_create\">Toast.create(options)</Anchor> instead.</p>\n              <p>Minimal usage:</p>\n              <CodeField readonly={true} runBtn={true} attachment={document.body} code={\n`// By default, toast dom is attached to <body>.\n// Run the code, toast will appears on top center of the page.\nToast('A message.')`}\n              />\n              <p>Rich usage:</p>\n              <CodeField readonly={true} runBtn={true} attachment={document.body} code={\n`Toast({\n  type: 'loading',\n  message: 'It\\\\'s loading for something now.',\n  attachment: document.body,\n  duration: 3500,\n  sustain: 5000,\n  cssClass: 'custom-class-name',\n  animeDuration: 250,\n})`}\n              />\n              <br />\n            </li>\n            <li>\n              <Anchor href=\"#toast_create\" id=\"toast_create\"><code>Toast.create(options)</code></Anchor>\n              <br />\n              <p>Create a toast but don't activate it immediately. <Anchor href=\"#options\">Options</Anchor> param is the same as <Anchor href=\"#toast\">Toast(options)</Anchor>. A <Anchor href=\"#context\">context</Anchor> will be returned, and then control the toast's state by it. You should completely manually control the shown state, so some options like <Anchor href=\"#options_duration\">duration</Anchor> won't work here.</p>\n              <CodeField attachment={document.body} runBtn={true} code={\n`const toast = Toast.create('A message') // return a context\n// some logic...\ntoast.goto('in') // show\ntoast.delay(1500) // keep shown for 1500ms\ntoast.goto('out') // hide\n\ntoast.goto('in') // show again\n// some logic...\ntoast.goto('out') // hide again\ntoast.goto('exit') // remove from the dom. Call this if not needed any more.`}\n              />\n            </li>\n          </ul>\n        </div>\n      </section>\n      <section>\n        <h3><Anchor href=\"#options\" id=\"options\">options</Anchor></h3>\n        <div>\n          <ul>\n            <li>\n              <Anchor href=\"#options_string\" id=\"options_string\"><code>&lt;string&gt;</code></Anchor>\n              <br />\n              <p>Will be set as toast message.</p>\n            </li>\n            <li>\n              <Anchor href=\"#options_object\" id=\"options_object\"><code>&lt;object&gt;</code></Anchor>\n              <br />\n              <p>Some optional properties are exposed to be used. Here is the list:</p>\n              <table>\n                <thead>\n                  <tr>\n                    <th>Property</th>\n                    <th>Type</th>\n                    <th>Default</th>\n                    <th>Description</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr>\n                    <td><code><Anchor href=\"#options_type\" id=\"options_type\">type</Anchor></code></td>\n                    <td><code>&lt;String&gt;</code></td>\n                    <td><code>success</code></td>\n                    <td><code>success|error|warning|loading, or you can also <Anchor href=\"#customized_a_type\">customized a type</Anchor>. <b>Instance dom element will add a css class named type</b>.</code></td>\n                  </tr>\n                  <tr>\n                    <td><code><Anchor href=\"#options_message\" id=\"options_message\">message</Anchor></code></td>\n                    <td><code>&lt;String&gt;</code></td>\n                    <td><code>&lt;Empty String&gt;</code></td>\n                    <td><code>the shown content.</code></td>\n                  </tr>\n                  <tr>\n                    <td><code><Anchor href=\"#options_duration\" id=\"options_duration\">duration</Anchor></code></td>\n                    <td><code>&lt;Number&gt;</code></td>\n                    <td><code>1000</code></td>\n                    <td><code>millisecond between progress 'in' and 'out', ignored while <Anchor href=\"#options_control\">control</Anchor> property exists or in <Anchor href=\"#toast_create\">Toast.create</Anchor>.</code></td>\n                  </tr>\n                  <tr>\n                    <td><code><Anchor href=\"#options_cssClass\" id=\"options_cssClass\">cssClass</Anchor></code></td>\n                    <td><code>&lt;String&gt;</code></td>\n                    <td><code>&lt;Empty String&gt;</code></td>\n                    <td><code>add a css class to instance dom, convenient for overriding style.</code></td>\n                  </tr>\n                  <tr>\n                    <td><code><Anchor href=\"#options_sustain\" id=\"options_sustain\">sustain</Anchor></code></td>\n                    <td><code>&lt;Number&gt;</code></td>\n                    <td><code>0</code></td>\n                    <td><code>minimal millisecond between two progress. Progress won't effect until the time gap reaches this value. This property is designed to avoid flash.</code></td>\n                  </tr>\n                  <tr>\n                    <td><code><Anchor href=\"#options_animeDuration\" id=\"options_animeDuration\">animeDuration</Anchor></code></td>\n                    <td><code>&lt;Number&gt;</code></td>\n                    <td><code>250</code></td>\n                    <td><code>millisecond of progress changing animation duration.</code></td>\n                  </tr>\n                  <tr>\n                    <td><code><Anchor href=\"#options_control\" id=\"options_control\">control</Anchor></code></td>\n                    <td><code>&lt;Function(<Anchor href=\"#context\">context</Anchor>)&gt;</code></td>\n                    <td><code>null</code></td>\n                    <td>\n                      <code>manually control the shown state.\n                        <br />\n                        <br />\n                        Tips:\n                        <br />\n                        1. Ignored when used in <Anchor href=\"#toast_create\">Toast.create(options)</Anchor>\n                        <br />\n                        2. If exists, <Anchor href=\"#options_duration\">duration</Anchor> will be ignored.\n                        <br />\n                        Detailed usage seen <Anchor href=\"#use_control\">here</Anchor>.\n                      </code>\n                    </td>\n                  </tr>\n                  <tr>\n                    <td><code><Anchor href=\"#options_attachment\" id=\"options_attachment\">attachment</Anchor></code></td>\n                    <td><code>&lt;Selector String&gt;|<br />&lt;HTMLElement&gt;</code></td>\n                    <td><code>document.body</code></td>\n                    <td><code>the element to attach the instance dom. If is document.body, use fixed layout; else use absolute layout.</code></td>\n                  </tr>\n                </tbody>\n              </table>\n            </li>\n          </ul>\n        </div>\n      </section>\n      <section>\n        <h3><Anchor href=\"#context\" id=\"context\">context</Anchor></h3>\n        <div>\n          <ul>\n            <li>\n              <Anchor href=\"#context_object\" id=\"context_object\"><code>&lt;object&gt;</code></Anchor>\n              <br />\n              <p>Used in <Anchor href=\"#options_control\">control option</Anchor> or the return value of <Anchor href=\"#toast_create\">Toast.create</Anchor>. Contains several properties:</p>\n              <table>\n                <thead>\n                  <tr>\n                    <th>Property</th>\n                    <th>Signature</th>\n                    <th>Functionality</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr>\n                    <td><code><Anchor href=\"#context_set\" id=\"context_set\">set</Anchor></code></td>\n                    <td><code>(<Anchor href=\"#context_set_payload\">payload</Anchor>:&lt;Object&gt;):undefined</code></td>\n                    <td><code>set toast state, like <Anchor href=\"#options_type\">type</Anchor>、<Anchor href=\"#options_message\">message</Anchor>, <Anchor href=\"#options_sustain\">sustain</Anchor> and so on. <Anchor href=\"#use_control\">Usage</Anchor>.</code></td>\n                  </tr>\n                  <tr>\n                    <td><code><Anchor href=\"#context_goto\" id=\"context_goto\">goto</Anchor></code></td>\n                    <td><code>(progress:&lt;String&gt;):&lt;Promise&gt;</code></td>\n                    <td>\n                      <code>change to specific progress. <b>Instance dom element will add a css class named progress</b>. And show animation while changing. Provided three:\n                        <br />\n                        - in: from hidden to visible\n                        <br />\n                        - out: from visible to hidden\n                        <br />\n                        - exit: remove instance dom (no-recover operation, used to clean dom while no more needed)\n                        <br />\n                        <br />\n                        Tips:\n                        <br />\n                        1. If <Anchor href=\"#options_sustain\">sustain</Anchor> exists, won't effect until time gap meets the sustain value.\n                        <br />\n                        2. Besides upper three, any other value is treated as custom progress type. Combined with <Anchor href=\"#options_cssClass\">cssClass</Anchor>, can reach the purpose to <Anchor href=\"#extend_a_new_progress\">extend a new progress</Anchor>.\n                        <br />\n                        3. Inside, uses a Promise to save <Anchor href=\"#context_goto\">goto()</Anchor> and <Anchor href=\"#context_delay\">delay()</Anchor> call order, so <Anchor href=\"#goto_and_delay_written_sync\">this</Anchor> works completely fine. But, if mixin <Anchor href=\"#context_goto\">goto()</Anchor> or <Anchor href=\"#context_delay\">delay()</Anchor> with <Anchor href=\"#context_set\">set()</Anchor>, errors occur, seen <Anchor href=\"#goto_delay_mixin_set\">this</Anchor>.\n                      </code>\n                    </td>\n                  </tr>\n                  <tr>\n                    <td><code><Anchor href=\"#context_delay\" id=\"context_delay\">delay</Anchor></code></td>\n                    <td><code>(millisecond:&lt;Number&gt;):&lt;Promise&gt;</code></td>\n                    <td><code>prolong current progress for specific millisecond.</code></td>\n                  </tr>\n                </tbody>\n              </table>\n            </li>\n          </ul>\n        </div>\n      </section>\n      <section>\n        <h3><Anchor href=\"#context_set_payload\" id=\"context_set_payload\">payload</Anchor></h3>\n        <div>\n          <ul>\n            <li>\n              <Anchor href=\"#context_set_payload_object\" id=\"context_set_payload_object\"><code>&lt;object&gt;</code></Anchor>\n              <br />\n              <p>Not all properties in <Anchor href=\"#options\">options</Anchor> can be used in <Anchor href=\"#context_set\">set()</Anchor> call. Only part works: <Anchor href=\"#options_type\">type</Anchor>、<Anchor href=\"#options_message\">message</Anchor>、<Anchor href=\"#options_cssClass\">cssClass</Anchor>、<Anchor href=\"#options_sustain\">sustain</Anchor>, and <Anchor href=\"#options_animeDuration\">animeDuration</Anchor></p>\n              <CodeField sandboxId=\"p-1\" runBtn={true} code={\n`const a = Toast.create({\n  attachment: '#p-1',\n  message: 'Success',\n})\n;(async function() {\n  await a.goto('in')\n  await a.delay(1000)\n  a.set({ // payload usage\n    type: 'loading',\n    message: 'Loading',\n  })\n  await a.delay(1000)\n  a.set({ // payload usage\n    type: 'error',\n    message: 'Error',\n  })\n  await a.delay(1000)\n  await a.goto('out')\n  await a.goto('exit')\n})()`}\n              />\n            </li>\n          </ul>\n        </div>\n      </section>\n      <section>\n        <h3><Anchor href=\"#example\" id=\"example\">example</Anchor></h3>\n        <div>\n          <ul>\n            <li>\n              <Anchor href=\"#customized_a_type\" id=\"customized_a_type\"><code>customized a type</code></Anchor>\n              <br />\n              <p>Combine custom <b>type</b> with <b>cssClass</b>, we can define a new type.</p>\n              <CodeField sandboxId=\"p-2\" runBtn={true} code={\n`// .js\nconst toast = Toast.create({\n  type: 'search', // custom type, besides default success|error|warning|loading...\n  cssClass: 'custom-toast', // className for control style\n  message: 'A new type: Search',\n  attachment: '#p-2',\n})\ntoast.goto('in')\n\n// .css\n// Add these styles\n// .custom-toast.search .icon {\n//   background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTg2NTE0NDY3ODk3IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjU0NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTExMyA0ODkuNUMxMTMgMjY4LjkgMjkxLjYgOTAgNTEyIDkwczM5OSAxNzguOSAzOTkgMzk5LjVTNzMyLjQgODg5IDUxMiA4ODkgMTEzIDcxMC4xIDExMyA0ODkuNXoiIGZpbGw9IiMzMzNGNTAiIHAtaWQ9IjU0NjMiPjwvcGF0aD48cGF0aCBkPSJNMTk0LjIgNjA3LjZsMC41IDEuOCAwLjIgMS44LTAuMSAxLjgtMC40IDEuNy0wLjYgMS42LTAuOSAxLjUtMS4xIDEuNC0xLjMgMS4yLTEuNSAxLTEuNyAwLjgtMS44IDAuNS0xLjggMC4yLTEuOC0wLjEtMS43LTAuNC0xLjctMC42LTEuNS0wLjktMS40LTEuMS0xLjItMS4zLTEtMS41LTAuOC0xLjctMS0yLjktMS0yLjktMC45LTIuOS0wLjktMi45LTAuOS0yLjktMC45LTIuOS0wLjktMi45LTAuOC0yLjktMC44LTIuOS0wLjgtMi45LTAuOC0yLjktMC43LTIuOS0wLjctMi45LTAuNy0yLjktMC43LTIuOS0wLjYtMi45LTAuNi0yLjktMC42LTIuOS0wLjYtMi45LTAuNS0yLjktMC41LTIuOS0wLjUtMi45LTAuNS0yLjktMC40LTMtMC40LTMtMC40LTMtMC40LTMtMC40LTMtMC4zLTMtMC4zLTMtMC4zLTMtMC4zLTMtMC4yLTMtMC4yLTMtMC4yLTMtMC4yLTMtMC4xLTMtMC4xLTMtMC4xLTMtMC4xLTN2LTE1bDAuMS0zIDAuMS0zIDAuMS0zIDAuMS0zIDAuMi0zIDAuMi0zIDAuMi0zIDAuMi0zIDAuMy0zIDAuMy0zIDAuMy0zIDAuMy0zIDAuNC0yLjkgMC40LTIuOSAwLjQtMi45IDAuNC0yLjkgMC40LTIuOSAwLjUtMi45IDAuNS0yLjkgMC41LTIuOSAwLjUtMi45IDAuNi0yLjkgMC42LTIuOSAwLjYtMi45IDAuNi0yLjkgMC43LTIuOSAwLjctMi45IDAuNy0yLjkgMC43LTIuOSAwLjctMi45IDAuOC0yLjkgMC44LTIuOSAwLjgtMi45IDAuOC0yLjkgMC45LTIuOSAwLjktMi45IDAuOS0yLjggMC45LTIuOCAxLTIuOCAxLTIuOCAxLTIuOCAxLTIuOCAxLTIuOCAxLjEtMi44IDEuMS0yLjggMS4xLTIuOCAxLjEtMi44IDEuMi0yLjggMS4yLTIuOCAxLjItMi44IDEuMi0yLjggMS4zLTIuNyAxLjMtMi43IDIuNi01LjQgMS40LTIuOCAxLjQtMi43IDEuNC0yLjcgMS40LTIuNyAxLjQtMi43IDEuNS0yLjYgMS41LTIuNiAxLjUtMi42IDEuNS0yLjYgMS41LTIuNiAxLjYtMi42IDEuNi0yLjYgMS42LTIuNSAxLjYtMi41IDEuNi0yLjUgMS42LTIuNSAxLjctMi41IDEuNy0yLjUgMS43LTIuNSAxLjctMi40IDEuNy0yLjQgMS44LTIuNCAxLjgtMi40IDEuOC0yLjQgMS44LTIuNCAxLjgtMi40IDEuOS0yLjMgMS45LTIuMyAxLjktMi4zIDEuOS0yLjMgMS45LTIuMyAxLjktMi4zIDItMi4yIDItMi4yIDItMi4yIDItMi4yIDItMi4yIDItMi4yIDIuMS0yLjEgMi4xLTIuMSAyLjEtMi4xIDIuMS0yLjEgMi4xLTIuMSAyLjEtMi4xIDIuMi0yIDIuMi0yIDIuMi0yIDIuMi0yIDIuMi0yIDIuMi0yIDIuMy0xLjkgMi4zLTEuOSAyLjMtMS45IDIuMy0xLjkgMi4zLTEuOSAyLjMtMS45IDIuMy0xLjggMi40LTEuOCAyLjQtMS44IDIuNC0xLjggMi40LTEuOCAyLjQtMS43IDIuNC0xLjcgMi40LTEuNyAyLjUtMS43IDIuNS0xLjcgMi41LTEuNiAyLjUtMS42IDIuNS0xLjYgMi41LTEuNiAyLjUtMS42IDIuNi0xLjUgMi42LTEuNSAyLjYtMS41IDIuNi0xLjUgMi42LTEuNSAyLjYtMS40IDIuNi0xLjQgMi42LTEuNCAyLjctMS40IDIuNy0xLjQgMi43LTEuMyAyLjctMS4zIDIuNy0xLjMgMi43LTEuMyAyLjctMS4zIDIuNy0xLjIgMi44LTEuMiAyLjgtMS4yIDIuOC0xLjIgMi44LTEuMiAyLjgtMS4xIDIuOC0xLjEgMi44LTEuMSAyLjgtMS4xIDIuOC0xIDIuOC0xIDIuOS0xIDUuNy0xLjkgMy43LTAuNiAzLjUgMC42IDMuMiAxLjYgMi42IDIuNSAxLjcgMy4zIDAuNiAzLjYtMC42IDMuNS0xLjYgMy4yLTIuNSAyLjUtMy4zIDEuNy01LjQgMS44LTIuNyAwLjktMi43IDEtMi43IDEtMi43IDEtMi42IDEtMi42IDEtMi42IDEuMS0yLjYgMS4xLTIuNiAxLjEtMi42IDEuMS0yLjYgMS4xLTIuNiAxLjItMi42IDEuMi0yLjUgMS4yLTIuNSAxLjItMi41IDEuMi0yLjUgMS4zLTIuNSAxLjMtMi41IDEuMy0yLjUgMS4zLTIuNSAxLjMtMi41IDEuNC0yLjQgMS40LTIuNCAxLjQtMi40IDEuNC0yLjQgMS40LTIuNCAxLjUtMi40IDEuNS0yLjQgMS41LTIuNCAxLjUtMi4zIDEuNS0yLjMgMS41LTIuMyAxLjYtMi4zIDEuNi0yLjMgMS42LTIuMyAxLjYtMi4zIDEuNi0yLjMgMS43LTIuMiAxLjctMi4yIDEuNy0yLjIgMS43LTIuMiAxLjctMi4yIDEuNy0yLjIgMS44LTIuMiAxLjgtMi4xIDEuOC0yLjEgMS44LTIuMSAxLjgtMi4xIDEuOC0yLjEgMS45LTIuMSAxLjktMi4xIDEuOS0yIDEuOS0yIDEuOS0yIDEuOS0yIDItMiAyLTIgMi0yIDItMS45IDItMS45IDItMS45IDItMS45IDIuMS0xLjkgMi4xLTEuOSAyLjEtMS44IDIuMS0xLjggMi4xLTEuOCAyLjEtMS44IDIuMi0xLjggMi4yLTEuOCAyLjItMS43IDIuMi0xLjcgMi4yLTEuNyAyLjItMS43IDIuMi0xLjcgMi4zLTEuNyAyLjMtMS42IDIuMy0xLjYgMi4zLTEuNiAyLjMtMS42IDIuMy0xLjYgMi4zLTEuNSAyLjQtMS41IDIuNC0xLjUgMi40LTEuNSAyLjQtMS41IDIuNC0xLjUgMi40LTEuNCAyLjQtMS43IDIuOC0xLjQgMi41LTEuNCAyLjUtMS40IDIuNS0xLjMgMi41LTEuMyAyLjUtMS4zIDIuNS0xLjMgMi41LTEuMiAyLjUtMi41IDUuMi0xLjIgMi42LTEuMiAyLjYtMS4yIDIuNi0xLjEgMi42LTEuMSAyLjYtMS4xIDIuNi0xLjEgMi42LTEuMSAyLjYtMSAyLjYtMSAyLjYtMSAyLjYtMSAyLjYtMC45IDIuNy0wLjkgMi43LTAuOSAyLjctMC45IDIuNy0wLjkgMi43LTAuOCAyLjctMC44IDIuNy0wLjggMi43LTAuOCAyLjctMC43IDIuNy0wLjcgMi43LTAuNyAyLjctMC43IDIuNy0wLjcgMi43LTAuNiAyLjctMC42IDIuNy0wLjYgMi43LTAuNiAyLjctMC42IDIuNy0wLjUgMi43LTAuNSAyLjctMC41IDIuNy0wLjUgMi44LTAuNCAyLjgtMC40IDIuOC0wLjQgMi44LTAuNCAyLjgtMC40IDIuOC0wLjMgMi44LTAuMyAyLjgtMC4zIDIuOC0wLjMgMi44LTAuMiAyLjgtMC4yIDIuOC0wLjIgMi44LTAuMiAyLjgtMC4yIDIuOC0wLjEgMi44LTAuMSAyLjgtMC4xIDIuOC0wLjEgMi44djE0bDAuMSAyLjggMC4xIDIuOCAwLjEgMi44IDAuMSAyLjggMC4yIDIuOCAwLjIgMi44IDAuMiAyLjggMC4yIDIuOCAwLjIgMi44IDAuMyAyLjggMC4zIDIuOCAwLjMgMi44IDAuMyAyLjggMC40IDIuOCAwLjQgMi44IDAuNCAyLjggMC40IDIuOCAwLjQgMi44IDAuNSAyLjggMC41IDIuOCAwLjUgMi44IDAuNSAyLjggMC42IDIuOCAwLjYgMi44IDAuNiAyLjcgMC42IDIuNyAwLjYgMi43IDAuNyAyLjcgMC43IDIuNyAwLjcgMi43IDAuNyAyLjcgMC44IDIuNyAwLjggMi43IDAuOCAyLjcgMC44IDIuNyAwLjggMi43IDAuOSAyLjcgMC45IDIuNyAwLjkgMi43IDEuMSAxLjl6TTE4MSA2NTNjMC03LjcgNi4zLTE0IDE0LTE0czE0IDYuMyAxNCAxNC02LjMgMTQtMTQgMTQtMTQtNi4zLTE0LTE0ek00NjguOCAxNzguN2MtMC40LTAuNi0xLjEtMS0xLjktMC45bC04LjMgMS01LjUtNi4zYy0wLjUtMC42LTEuMy0wLjgtMi0wLjYtMC43IDAuMi0xLjMgMC44LTEuNCAxLjVsLTEuNiA4LjItNy43IDMuM2MtMC43IDAuMy0xLjEgMS0xLjIgMS43IDAgMC43IDAuNCAxLjUgMSAxLjhsNy4zIDQuMSAwLjggOC4zYzAuMSAwLjcgMC42IDEuNCAxLjMgMS43IDAuNyAwLjMgMS41IDAuMSAyLTAuNGw2LjItNS43IDguMiAxLjhjMC4zIDAuMSAwLjYgMC4xIDAuOSAwIDAuNC0wLjEgMC44LTAuMyAxLTAuNyAwLjUtMC42IDAuNi0xLjQgMC4zLTIuMWwtMy41LTcuNiA0LjMtNy4yYzAuMi0wLjUgMC4yLTEuMy0wLjItMS45ek04MDUuOCAyOTcuM2MtMC4yLTAuNy0wLjgtMS4yLTEuNi0xLjRsLTguMi0xLjItMy43LTcuNmMtMC4zLTAuNy0xLTEuMS0xLjgtMS4xcy0xLjQgMC40LTEuOCAxLjFsLTMuNyA3LjYtOC4yIDEuMmMtMC43IDAuMS0xLjQgMC42LTEuNiAxLjQtMC4yIDAuNyAwIDEuNSAwLjUgMmw2IDUuOS0xLjQgOC4zYy0wLjEgMC44IDAuMiAxLjUgMC44IDEuOSAwLjYgMC40IDEuNCAwLjUgMi4xIDAuMmw3LjQtMy45IDcuNCAzLjljMC4zIDAuMiAwLjYgMC4yIDAuOSAwLjIgMC40IDAgMC44LTAuMSAxLjItMC40IDAuNi0wLjQgMC45LTEuMiAwLjgtMS45bC0xLjQtOC4zIDYtNS45YzAuMy0wLjUgMC41LTEuMyAwLjMtMnpNNTUwLjggODI2LjljLTAuMi0wLjctMC44LTEuMi0xLjYtMS4zbC04LjItMS4yLTMuNy03LjNjLTAuMy0wLjctMS0xLjEtMS44LTEuMXMtMS40IDAuNC0xLjggMS4xbC0zLjcgNy4zLTguMiAxLjJjLTAuNyAwLjEtMS40IDAuNi0xLjYgMS4zLTAuMiAwLjcgMCAxLjUgMC41IDJsNiA1LjctMS40IDguMWMtMC4xIDAuNyAwLjIgMS41IDAuOCAxLjkgMC42IDAuNCAxLjQgMC41IDIuMSAwLjFsNy40LTMuOCA3LjQgMy44YzAuMyAwLjEgMC42IDAuMiAwLjkgMC4yIDAuNCAwIDAuOC0wLjEgMS4yLTAuNCAwLjYtMC40IDAuOS0xLjIgMC44LTEuOWwtMS40LTguMSA2LTUuN2MwLjMtMC40IDAuNS0xLjIgMC4zLTEuOXoiIGZpbGw9IiNGRkZGRkYiIHAtaWQ9IjU0NjQiPjwvcGF0aD48cGF0aCBkPSJNMjQ3LjQgNTc2LjJjMC0wLjctMC40LTEuNC0xLjEtMS44bC03LjQtMy44LTEuMS04LjNjLTAuMS0wLjctMC42LTEuNC0xLjMtMS42LTAuNy0wLjItMS41LTAuMS0yIDAuNWwtNiA1LjktOC4yLTEuNmMtMC43LTAuMS0xLjUgMC4yLTEuOSAwLjctMC41IDAuNi0wLjUgMS40LTAuMiAyLjFsMy44IDcuNS00IDcuM2MtMC40IDAuNy0wLjMgMS41IDAuMSAyLjEgMC40IDAuNiAxLjIgMC45IDEuOSAwLjhsOC4zLTEuMyA1LjcgNi4xYzAuMiAwLjIgMC41IDAuNCAwLjggMC41IDAuNCAwLjEgMC44IDAuMSAxLjIgMCAwLjctMC4yIDEuMi0wLjggMS40LTEuNmwxLjQtOC4zIDcuNi0zLjZjMC41LTAuMSAxLTAuOCAxLTEuNnpNODAwLjggNjU0LjNjLTAuMi0wLjctMC44LTEuMi0xLjYtMS40bC04LjItMS4yLTMuNy03LjZjLTAuMy0wLjctMS0xLjEtMS44LTEuMXMtMS40IDAuNC0xLjggMS4xbC0zLjcgNy42LTguMiAxLjJjLTAuNyAwLjEtMS40IDAuNi0xLjYgMS40LTAuMiAwLjcgMCAxLjUgMC41IDJsNiA1LjktMS40IDguM2MtMC4xIDAuOCAwLjIgMS41IDAuOCAxLjkgMC42IDAuNCAxLjQgMC41IDIuMSAwLjJsNy40LTMuOSA3LjQgMy45YzAuMyAwLjIgMC42IDAuMiAwLjkgMC4yIDAuNCAwIDAuOC0wLjEgMS4yLTAuNCAwLjYtMC40IDAuOS0xLjIgMC44LTEuOWwtMS40LTguMyA2LTUuOWMwLjMtMC41IDAuNS0xLjMgMC4zLTJ6IiBmaWxsPSIjRkZGRkZGIiBwLWlkPSI1NDY1Ij48L3BhdGg+PHBhdGggZD0iTTM2NC42IDYzNy42bDExNy4zLTEyNS41IDQ2LjQgNDMuNEw0MTEgNjgxbC00Ni40LTQzLjR6IiBmaWxsPSIjQURCOUNBIiBwLWlkPSI1NDY2Ij48L3BhdGg+PHBhdGggZD0iTTQ0MiA1NDMuNWMwLTI5LjUgMjUuMy01My41IDU2LjUtNTMuNXM1Ni41IDI0IDU2LjUgNTMuNS0yNS4zIDUzLjUtNTYuNSA1My41LTU2LjUtMjQtNTYuNS01My41eiIgZmlsbD0iIzhDRThFNCIgcC1pZD0iNTQ2NyI+PC9wYXRoPjxwYXRoIGQ9Ik03MTggMjEwLjRjNi02LjQgMTYuMS02LjggMjIuNS0wLjhsNzUuNyA3MC43YzYuNCA2IDYuOCAxNi4xIDAuOCAyMi41bC00LjcgNWMtNiA2LjQtMTYuMSA2LjgtMjIuNSAwLjhsLTc1LjctNzAuN2MtNi40LTYtNi44LTE2LjEtMC44LTIyLjVsNC43LTV6IiBmaWxsPSIjREZGNEZFIiBwLWlkPSI1NDY4Ij48L3BhdGg+PHBhdGggZD0iTTY4OS41IDI0MC44YzYtNi40IDE2LjEtNi44IDIyLjUtMC44bDc1LjcgNzAuN2M2LjQgNiA2LjggMTYuMSAwLjggMjIuNWwtNC43IDVjLTYgNi40LTE2LjEgNi44LTIyLjUgMC44bC03NS43LTcwLjdjLTYuNC02LTYuOC0xNi4xLTAuOC0yMi41bDQuNy01eiIgZmlsbD0iI0JGRTlGRCIgcC1pZD0iNTQ2OSI+PC9wYXRoPjxwYXRoIGQ9Ik03ODUuOCA1OTMuN2MtMy4zIDAtNi42LTEuMi05LjEtMy42bC0zNDItMzE5LjdjLTMuNy0zLjUtNS4xLTguOC0zLjYtMTMuNyAxLjUtNC45IDUuNy04LjUgMTAuOC05LjJsMjU5LjUtMzguMWM0LTAuNiA4LjEgMC43IDExIDMuNWwxMDMuMSA5Ni40YzMgMi44IDQuNSA2LjcgNC4yIDEwLjhsLTIwLjYgMjYxLjVjLTAuNCA1LjEtMy43IDkuNS04LjUgMTEuNC0xLjUgMC40LTMuMSAwLjctNC44IDAuN3pNNDczLjEgMjY5LjhsMzAxLjYgMjgxLjkgMTcuOS0yMjcuNS05My43LTg3LjYtMjI1LjggMzMuMnoiIGZpbGw9IiM1RUM4RkEiIHAtaWQ9IjU0NzAiPjwvcGF0aD48cGF0aCBkPSJNNjQ2LjUgMzk5LjljLTMuMyAwLTYuNS0xLjItOS4xLTMuNi01LjQtNS01LjctMTMuNS0wLjYtMTguOGwxNDcuMS0xNTcuNGM1LTUuNCAxMy41LTUuNyAxOC44LTAuNiA1LjQgNSA1LjcgMTMuNSAwLjYgMTguOGwtMTQ3IDE1Ny40Yy0yLjYgMi44LTYuMiA0LjItOS44IDQuMnoiIGZpbGw9IiM1RUM4RkEiIHAtaWQ9IjU0NzEiPjwvcGF0aD48cGF0aCBkPSJNNDQ1LjcgMTk3LjFMODUxIDU3NmwtMjEuOCAxMy45Yy0xMDUuMSA1OS44LTI0MS4xIDQ3LjUtMzM0LjEtMzkuNHMtMTE0LjUtMjIxLjgtNjEuOC0zMzAuN2wxMi40LTIyLjd6IiBmaWxsPSIjRkZGRkZGIiBwLWlkPSI1NDcyIj48L3BhdGg+PHBhdGggZD0iTTM2NyA3NjhWNjMwbDE0MSAxMzhIMzY3eiIgZmlsbD0iI0Q2RENFNSIgcC1pZD0iNTQ3MyI+PC9wYXRoPjxwYXRoIGQ9Ik0zNTEgNjQ1YzAtMjIuMSAxNy45LTQwIDQwLTQwczQwIDE3LjkgNDAgNDAtMTcuOSA0MC00MCA0MC00MC0xNy45LTQwLTQweiIgZmlsbD0iIzQ0NTQ2QSIgcC1pZD0iNTQ3NCI+PC9wYXRoPjxwYXRoIGQ9Ik0zMjYgNjUwYzAtMzYuNSAyOS41LTY2IDY2LTY2czY2IDI5LjUgNjYgNjYtMjkuNSA2Ni02NiA2Ni02Ni0yOS41LTY2LTY2eiBtMzMgMGMwIDE4LjIgMTQuOCAzMyAzMyAzM3MzMy0xNC44IDMzLTMzLTE0LjgtMzMtMzMtMzMtMzMgMTQuOC0zMyAzM3pNMjM0IDc5MC4yYzAtOC45IDcuMi0xNi4yIDE2LjItMTYuMmgzNDYuNmM4LjkgMCAxNi4yIDcuMiAxNi4yIDE2LjJ2MTU3LjZjMCA4LjktNy4yIDE2LjItMTYuMiAxNi4ySDI1MC4yYy04LjkgMC0xNi4yLTcuMi0xNi4yLTE2LjJWNzkwLjJ6IiBmaWxsPSIjRjk3QjZFIiBwLWlkPSI1NDc1Ij48L3BhdGg+PHBhdGggZD0iTTIxNSA3NzEuNWMwLTggNi41LTE0LjUgMTQuNS0xNC41aDM5NWM4IDAgMTQuNSA2LjUgMTQuNSAxNC41cy02LjUgMTQuNS0xNC41IDE0LjVoLTM5NWMtOCAwLTE0LjUtNi41LTE0LjUtMTQuNXoiIGZpbGw9IiNGQUNDN0UiIHAtaWQ9IjU0NzYiPjwvcGF0aD48cGF0aCBkPSJNMjY1IDgzMi45YzAtMy4yIDIuNi01LjkgNS45LTUuOWg2MS4yYzMuMiAwIDUuOSAyLjYgNS45IDUuOXY1Ny4yYzAgMy4yLTIuNiA1LjktNS45IDUuOWgtNjEuMmMtMy4yIDAtNS45LTIuNi01LjktNS45di01Ny4yek0zODcgODMyLjljMC0zLjIgMi42LTUuOSA1LjktNS45aDYxLjJjMy4yIDAgNS45IDIuNiA1LjkgNS45djU3LjJjMCAzLjItMi42IDUuOS01LjkgNS45aC02MS4yYy0zLjIgMC01LjktMi42LTUuOS01Ljl2LTU3LjJ6TTUwOSA4MzIuOWMwLTMuMiAyLjYtNS45IDUuOS01LjloNjEuMmMzLjIgMCA1LjkgMi42IDUuOSA1Ljl2NTcuMmMwIDMuMi0yLjYgNS45LTUuOSA1LjloLTYxLjJjLTMuMiAwLTUuOS0yLjYtNS45LTUuOXYtNTcuMnoiIGZpbGw9IiNGRkZGRkYiIHAtaWQ9IjU0NzciPjwvcGF0aD48L3N2Zz4=');\n// }`}\n              />\n              <br />\n            </li>\n            <li>\n              <Anchor href=\"#use_control\" id=\"use_control\"><code>use control option</code></Anchor>\n              <br />\n              <p><Anchor href=\"#options_control\">Control</Anchor> option provides flexible way to control shown state. If exists, instance won't start show-hidden-destory lifecycle automaticlly. Instead, you have to manage state manually. For example, call goto('in') first, call goto('out') later, and call goto('exit') finally.</p>\n              <CodeField sandboxId=\"p-3\" runBtn={true} code={\n`Toast({\n  type: 'loading',\n  message: 'loading...',\n  attachment: '#p-3',\n  async control({goto, set, delay}) {\n    await goto('in')\n\n    // After some time\n    await delay(3000)\n    await goto('out')\n    set({\n      type: 'error',\n      message: 'loading failed!',\n    })\n\n    await goto('in')\n    await delay(1000)\n    await goto('out')\n\n    await goto('exit')\n  },\n})`}\n              />\n              <p>When used in Toast.create, this option will be ignored:</p>\n              <CodeField sandboxId=\"p-4\" runBtn={true} code={\n`const toast = Toast.create({\n  type: 'loading',\n  message: 'loading start',\n  attachment: '#p-4',\n  async control({goto, set, delay}) { // won't execute\n    await goto('in')\n    await delay(1000)\n    await goto('out')\n\n    await goto('exit')\n  },\n})\n// This works ↓\ntoast.goto('in')`}\n              />\n              <br />\n            </li>\n            <li>\n              <Anchor href=\"#extend_a_new_progress\" id=\"extend_a_new_progress\"><code>extend a new progress</code></Anchor>\n              <br />\n              <p>Custom a progress is similar to <Anchor href=\"#customized_a_type\">customized a type</Anchor>. Follow three steps:\n                <br />\n                1. set <Anchor href=\"#options_cssClass\">cssClass option</Anchor>\n                <br />\n                2. pass a progress string to <Anchor href=\"#context_goto\">goto()</Anchor> method\n                <br />\n                3. define css animation keyframes\n                <br />\n                That's all. For example, this customs a 'shake' progress:\n              </p>\n              <CodeField sandboxId=\"p-5\" runBtn={true} code={\n`// .js\nconst toast = Toast.create({\n  type: 'loading',\n  message: 'loading',\n  attachment: '#p-5',\n  cssClass: 'custom-progress-toast', // set custom css classname\n})\ntoast.goto('in')\ntoast.delay(1000)\ntoast.goto('shake') // activate shake progress\n\n// .css\n// .custom-progress-toast {\n//  &.shake .main-content { // activate shake animation when calling goto('shake')\n//      animation-duration: inherit;\n//      animation-name: animeShake;\n//  }\n// }\n// @keyframes animeShake {\n//     25% {\n//         transform: rotate(20deg);\n//     }\n//     45% {\n//         transform: rotate(-20deg);\n//     }\n//     60% {\n//         transform: rotate(12deg);\n//     }\n//     70% {\n//         transform: rotate(-12deg);\n//     }\n//     80% {\n//         transform: rotate(6deg);\n//     }\n//     88% {\n//         transform: rotate(-6deg);\n//     }\n//     93% {\n//         transform: rotate(3deg);\n//     }\n//     97% {\n//         transform: rotate(-3deg);\n//     }\n//     98% {\n//         transform: rotate(2deg);\n//     }\n//     99% {\n//         transform: rotate(-2deg);\n//     }\n//     99.5% {\n//         transform: rotate(1deg);\n//     }\n//     to {\n//         transform: rotate(0);\n//     }\n// }`}\n               />\n               <br />\n            </li>\n            <li>\n              <Anchor href=\"#goto_and_delay_written_sync\" id=\"goto_and_delay_written_sync\"><code>goto() and delay() written in synchronous</code></Anchor>\n              <br />\n              <p>As the document describes above, <Anchor href=\"#context_goto\">goto()</Anchor> and <Anchor href=\"#context_delay\">delay()</Anchor> both return Promise, means they work asynchronously. So it maybe confusing that these codes work correctly:\n              </p>\n              <CodeField readonly={true} sandboxId=\"p-6\" runBtn={true} code={\n`const toast = Toast.create({\n  type: 'success',\n  message: 'Show a success message',\n  attachment: '#p-6',\n})\n// Should't only goto('out') works?\n// But in facct, it runs by in-delay-out order as expected.\ntoast.goto('in')\ntoast.delay(2000)\ntoast.goto('out')`}\n              />\n              <p>That's because in fact, we use a Promise ref to keep the calling order. Every <Anchor href=\"#context_goto\">goto()</Anchor> and <Anchor href=\"#context_delay\">delay()</Anchor> call will be added to the Promise then() chain immediately. Mean code like these:</p>\n              <CodeField readonly={true} code={\n`// define a Promise ref\nconst chainRef = useRef(Promise.resolve())\nfunction goto(progress) {\n  chainRef.current = chainRef.current.then(() => dealGoto(progress)) // add to the Promise then chain\n  return chainRef.current\n}\nfunction delay(millisecond) {\n  chainRef.current = chainRef.current.then(() => new Promise(resolve => { // add to the Promise then chain\n    setTimeout(() => {\n      resolve()\n    }, millisecond)\n  }))\n  return chainRef.current\n}`}\n              />\n              <p>By the way, we must be careful when using <Anchor href=\"#goto_delay_mixin_set\" id=\"goto_delay_mixin_set\">goto() and delay() mixin with set()</Anchor>:</p>\n              <CodeField readonly={true} sandboxId=\"p-7\" runBtn={true} code={\n`const toast = Toast.create({\n  type: 'success',\n  message: 'msg1',\n  attachment: '#p-7',\n})\ntoast.goto('in')\ntoast.delay(2000)\ntoast.goto('out')\ntoast.set({\n  message: 'msg2',\n})`}\n               />\n               <p>Because <Anchor href=\"#context_set\">set()</Anchor> is a synchronous method, and doesn't work like <Anchor href=\"#context_goto\">goto()</Anchor> and <Anchor href=\"#context_delay\">delay()</Anchor>, it won't been added to the promise chain. So run the above code, only shows `msg2`, and `msg1` is overrided. To make it works properly, we can wrap them in promise.then style or async style:</p>\n              <CodeField readonly={true} sandboxId=\"p-8\" runBtn={true} code={\n`const toast = Toast.create({\n  type: 'success',\n  message: 'msg1',\n  attachment: '#p-8',\n})\n;(async function() {\n  // First show 'msg1',\n  // 2000ms later, show 'msg2',\n  // another 2000ms later, hidden.\n  await toast.goto('in')\n  await toast.delay(2000)\n  toast.set({\n    message: 'msg2',\n  })\n  await toast.delay(2000)\n  await toast.goto('out')\n})()`}\n               />\n            </li>\n          </ul>\n        </div>\n      </section>\n    </div>\n  )\n}\n\nReactDOM.render(\n  <App />,\n  document.getElementById('app') as HTMLElement,\n)\n"],"sourceRoot":""}